function bi_intToBigInt(int_value,int_base){var auxBigInt=null;if(typeof bigInt!=="undefined"&&int_base==16)auxBigInt=bigInt(int_value,int_base).value;else if(typeof bigInt!=="undefined")auxBigInt=bigInt(parseInt(int_value)>>>0,int_base).value;else auxBigInt=BigInt(parseInt(int_value)>>>0,int_base);return auxBigInt}function register_value_deserialize(object){var auxObject=object;for(var i=0;i<auxObject.components.length;i++){var aux=null;var auxBigInt=null;for(var j=0;j<auxObject.components[i].elements.length;j++){aux=auxObject.components[i].elements[j].value;if(auxObject.components[i].type!="floating point")auxObject.components[i].elements[j].value=bi_intToBigInt(aux,10);else auxObject.components[i].elements[j].value=parseFloat(aux);if(auxObject.components[i].double_precision!=true){aux=auxObject.components[i].elements[j].default_value;if(auxObject.components[i].type!="floating point")auxObject.components[i].elements[j].default_value=bi_intToBigInt(aux,10);else auxObject.components[i].elements[j].value=parseFloat(aux)}}}return auxObject}function register_value_serialize(object){var auxObject=jQuery.extend(true,{},object);for(var i=0;i<architecture.components.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){var aux=architecture.components[i].elements[j].value;auxObject.components[i].elements[j].value=aux.toString();if(architecture.components[i].double_precision!=true){var aux2=architecture.components[i].elements[j].default_value;auxObject.components[i].elements[j].default_value=aux2.toString()}}}return auxObject}var is_ga_initialize=false;function creator_ga(category,action,label){if(typeof ga==="undefined"){return}if(is_ga_initialize==false){ga("create","UA-186823627-2","auto");ga("set","transport","beacon");is_ga_initialize=true}ga("send","event",category,action,label)}function preload_load_example(data,url){code_assembly=data;app.assembly_compiler(code_assembly);show_notification(" The selected example has been loaded.","success");creator_ga("example","example.loading","example.loading."+url)}var creator_preload_tasks=[{name:"architecture",action:function(app,hash){var arch_name=hash.architecture.trim();if(arch_name===""){return new Promise((function(resolve,reject){resolve("Empty architecture.")}))}return $.getJSON("architecture/available_arch.json",(function(arch_availables){for(var i=0;i<arch_availables.length;i++){if(arch_availables[i].name==arch_name){app.load_arch_select(arch_availables[i]);return"Architecture loaded."}}return"Unavailable architecture."}))}},{name:"example_set",action:function(app,hash){var exa_set=hash.example_set.trim();if(exa_set===""){return new Promise((function(resolve,reject){resolve("Empty example set.")}))}app.load_examples_available(hash.example_set);return app._data.example_loaded}},{name:"example",action:function(app,hash){return new Promise((function(resolve,reject){for(var i=0;i<example_available.length;i++){if(example_available[i].id===hash.example){var url=example_available[i].url;$.get(url,(function(data){preload_load_example(data,url)}));resolve("Example loaded.")}}reject("Example not found.")}))}}];function creator_preload_get2hash(window_location){var hash={};var hash_field="";var uri_obj=null;if(typeof window_location==="undefined"){return hash}var parameters=new URL(window_location).searchParams;for(i=0;i<creator_preload_tasks.length;i++){hash_field=creator_preload_tasks[i].name;hash[hash_field]=parameters.get(hash_field);if(hash[hash_field]===null){hash[hash_field]=""}}return hash}async function creator_preload_fromHash(app,hash){var key="";var act=function(){};var o="";for(var i=0;i<creator_preload_tasks.length;i++){key=creator_preload_tasks[i].name;act=creator_preload_tasks[i].action;if(hash[key]!==""){try{var v=await act(app,hash);o=o+v+"<br>"}catch(e){o=o+e+"<br>"}}}return o}function checkTypeIEEE(s,e,m){let rd=0;if(!m&&!e)rd=s?1<<3:1<<4;else if(!e)rd=s?1<<2:1<<5;else if(!(e^255))if(m)rd=s?1<<8:1<<9;else rd=s?1<<0:1<<7;else rd=s?1<<1:1<<6;return rd}function hex2char8(hexvalue){var num_char=hexvalue.toString().length/2;var exponent=0;var pos=0;var valuec=[];for(var i=0;i<num_char;i++){var auxHex=hexvalue.substring(pos,pos+2);valuec[i]=String.fromCharCode(parseInt(auxHex,16));pos=pos+2}var characters="";for(var i=0;i<valuec.length;i++){characters=characters+valuec[i]+" "}return characters}function hex2float(hexvalue){var value=hexvalue.split("x");var value_bit="";for(var i=0;i<value[1].length;i++){var aux=value[1].charAt(i);aux=parseInt(aux,16).toString(2).padStart(4,"0");value_bit=value_bit+aux}var buffer=new ArrayBuffer(4);new Uint8Array(buffer).set(value_bit.match(/.{8}/g).map(binaryStringToInt));return new DataView(buffer).getFloat32(0,false)}function uint_to_float32(value){var buf=new ArrayBuffer(4);new Uint32Array(buf)[0]=value;return new Float32Array(buf)[0]}function float32_to_uint(value){var buf=new ArrayBuffer(4);new Float32Array(buf)[0]=value;return new Uint32Array(buf)[0]}function uint_to_float64(value0,value1){var buf=new ArrayBuffer(8);var arr=new Uint32Array(buf);arr[0]=value0;arr[1]=value1;return new Float64Array(buf)[0]}function float64_to_uint(value){var buf=new ArrayBuffer(8);new Float64Array(buf)[0]=value;return new Uint32Array(buf)}function float2bin(number){var i,result="";var dv=new DataView(new ArrayBuffer(4));dv.setFloat32(0,number,false);for(i=0;i<4;i++){var bits=dv.getUint8(i).toString(2);if(bits.length<8){bits=new Array(8-bits.length).fill("0").join("")+bits}result+=bits}return result}function double2bin(number){var i,result="";var dv=new DataView(new ArrayBuffer(8));dv.setFloat64(0,number,false);for(i=0;i<8;i++){var bits=dv.getUint8(i).toString(2);if(bits.length<8){bits=new Array(8-bits.length).fill("0").join("")+bits}result+=bits}return result}function bin2hex(s){var i,k,part,accum,ret="";for(i=s.length-1;i>=3;i-=4){part=s.substr(i+1-4,4);accum=0;for(k=0;k<4;k+=1){if(part[k]!=="0"&&part[k]!=="1"){return{valid:false}}accum=accum*2+parseInt(part[k],10)}if(accum>=10){ret=String.fromCharCode(accum-10+"A".charCodeAt(0))+ret}else{ret=String(accum)+ret}}if(i>=0){accum=0;for(k=0;k<=i;k+=1){if(s[k]!=="0"&&s[k]!=="1"){return{valid:false}}accum=accum*2+parseInt(s[k],10)}ret=String(accum)+ret}return ret}function hex2double(hexvalue){var value=hexvalue.split("x");var value_bit="";for(var i=0;i<value[1].length;i++){var aux=value[1].charAt(i);aux=parseInt(aux,16).toString(2).padStart(4,"0");value_bit=value_bit+aux}var buffer=new ArrayBuffer(8);new Uint8Array(buffer).set(value_bit.match(/.{8}/g).map(binaryStringToInt));return new DataView(buffer).getFloat64(0,false)}function clean_string(value,prefix){var value2=value.replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,"_");re=new RegExp("^[0-9]+$");if(value2.search(re)!=-1&&prefix!="undefined"){value2=prefix+value2}return value2}var track_stack_names=[];var track_stack_limits=[];function track_stack_create(){var ret={ok:true,msg:""};track_stack_names=[];track_stack_limits=[];track_stack_enter("main");return ret}function track_stack_enter(function_name){var ret={ok:true,msg:""};track_stack_names.push(function_name);var new_elto={function_name:function_name,begin_caller:track_stack_getTop().val.begin_callee,end_caller:track_stack_getTop().val.end_callee,begin_callee:architecture.memory_layout[4].value,end_callee:architecture.memory_layout[4].value};track_stack_limits.push(new_elto);if(typeof window!=="undefined"){app._data.callee_subrutine=track_stack_names[track_stack_names.length-1];app._data.caller_subrutine=track_stack_names[track_stack_names.length-2];app._data.begin_caller=new_elto.begin_caller;app._data.end_caller=new_elto.end_caller;app._data.begin_callee=new_elto.begin_callee;app._data.end_callee=new_elto.end_callee}return ret}function track_stack_leave(){var ret={ok:true,msg:""};if(0==track_stack_limits.length){ret.msg="track_stack_Leave: empty track_stack_limits !!.\n";return ret}track_stack_limits.pop();if(track_stack_names.length>0){track_stack_names.pop()}var elto_top=track_stack_getTop();if(typeof window!=="undefined"&&elto_top.val!=null){app._data.callee_subrutine=track_stack_names[track_stack_names.length-1];app._data.caller_subrutine=track_stack_names[track_stack_names.length-2];app._data.begin_caller=elto_top.val.begin_caller;app._data.end_caller=elto_top.val.end_caller;app._data.begin_callee=elto_top.val.begin_callee;app._data.end_callee=elto_top.val.end_callee}return ret}function track_stack_getTop(){var ret={ok:true,val:{begin_caller:architecture.memory_layout[4].value,end_caller:architecture.memory_layout[4].value,begin_callee:architecture.memory_layout[4].value,end_callee:architecture.memory_layout[4].value},msg:""};if(0==track_stack_limits.length){ret.ok=false;ret.msg="track_stack_getTop: empty track_stack_limits !!.\n";return ret}ret.val=track_stack_limits[track_stack_limits.length-1];if(typeof ret.val.begin_caller==="undefined"){ret.val.begin_caller=architecture.memory_layout[4].value}return ret}function track_stack_setTop(field,indexComponent,indexElement,value){var ret={ok:true,msg:""};if(0==track_stack_limits.length){ret.ok=false;ret.msg="track_stack_getTop: empty track_stack_limits !!.\n";return ret}var elto=track_stack_limits[track_stack_limits.length-1];if(typeof elto.length!=="undefined"){elto[field][indexComponent][indexElement]=value;return ret}elto[field]=value;return ret}function track_stack_setsp(value){if(typeof window!=="undefined"){app._data.end_callee=value}if(0==track_stack_limits.length){return}var elto=track_stack_limits[track_stack_limits.length-1];elto.end_callee=value}function track_stack_reset(){var ret={ok:true,msg:""};track_stack_names=[];track_stack_limits=[];track_stack_enter("main");if(typeof window!=="undefined"){app._data.track_stack_names=track_stack_names;app._data.callee_subrutine=track_stack_names[track_stack_names.length-1];app._data.caller_subrutine="";app._data.begin_caller=architecture.memory_layout[4].value;app._data.end_caller=architecture.memory_layout[4].value;app._data.begin_callee=architecture.memory_layout[4].value;app._data.end_callee=architecture.memory_layout[4].value}return ret}var stack_call_names=[];var stack_state_transition=[{"wm==":1,"wm!=":1,rm:2,wr:40,rr:0,end:3},{"wm==":1,"wm!=":7,rm:6,wr:5,rr:1,end:40},{"wm==":1,"wm!=":1,rm:2,wr:45,rr:2,end:3},{"wm==":-1,"wm!=":-1,rm:-1,wr:-1,rr:-1,end:-1},{"wm==":-1,"wm!=":-1,rm:-1,wr:-1,rr:-1,end:-1},{"wm==":44,"wm!=":5,rm:6,wr:5,rr:5,end:43},{"wm==":44,"wm!=":6,rm:6,wr:0,rr:6,end:43},{"wm==":7,"wm!=":7,rm:6,wr:5,rr:7,end:42}];var stack_call_register=[];function creator_callstack_create(){var ret={ok:true,msg:""};stack_call_names=[];stack_call_register=[];creator_callstack_enter("main");return ret}function creator_callstack_enter(function_name){var ret={ok:true,msg:""};stack_call_names.push(function_name);var arr_sm=[];var arr_write=[];var arr_read=[];var arr_value=[];var arr_size_write=[];var arr_size_read=[];for(var i=0;i<architecture.components.length;i++){arr_sm.push([]);arr_write.push([]);arr_read.push([]);arr_value.push([]);arr_size_write.push([]);arr_size_read.push([]);for(var j=0;j<architecture.components[i].elements.length;j++){arr_sm[i].push(0);arr_write[i].push([]);arr_read[i].push([]);arr_size_write[i].push([]);arr_size_read[i].push([]);arr_value[i].push(architecture.components[i].elements[j].value)}}var new_elto={function_name:function_name,enter_stack_pointer:architecture.memory_layout[4].value,register_sm:arr_sm,register_value:arr_value,register_size_write:arr_size_write,register_size_read:arr_size_read,register_address_write:arr_write,register_address_read:arr_read};stack_call_register.push(new_elto);return ret}function creator_callstack_leave(){var ret={ok:true,msg:""};if(0==stack_call_register.length){ret.msg="creator_callstack_Leave: empty stack_call_register !!.\n";return ret}var last_elto=stack_call_register[stack_call_register.length-1];if(ret.ok){if(architecture.memory_layout[4].value!=last_elto.enter_stack_pointer){ret.ok=false;ret.msg="Stack memory has not been released successfully"}}if(ret.ok){for(var i=0;i<architecture.components.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){if(last_elto.register_value[i][j]!=architecture.components[i].elements[j].value&&architecture.components[i].elements[j].properties.includes("saved")){ret.ok=false;ret.msg="Possible failure in the parameter passing convention";break}}}}if(ret.ok){for(var i=0;i<architecture.components.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){creator_callstack_do_transition("end",i,j,null);last_elto=stack_call_register[stack_call_register.length-1];if(last_elto.register_sm[i][j]!=3&&architecture.components[i].elements[j].properties.includes("saved")){ret.ok=false;ret.msg="Possible failure in the parameter passing convention";break}}}}if(ret.ok){for(var i=0;i<architecture.components.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){last_index_read=last_elto.register_address_read[i][j].length-1;if(last_elto.register_address_write[i][j][0]!=last_elto.register_address_read[i][j][last_index_read]&&architecture.components[i].elements[j].properties.includes("saved")){ret.ok=false;ret.msg="Possible failure in the parameter passing convention";break}}}}if(ret.ok){for(var i=0;i<architecture.components.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){last_index_read=last_elto.register_size_read[i][j].length-1;if(last_elto.register_size_write[i][j][0]!=last_elto.register_size_read[i][j][last_index_read]&&architecture.components[i].elements[j].properties.includes("saved")){ret.ok=false;ret.msg="Possible failure in the parameter passing convention";break}}}}stack_call_register.pop();if(stack_call_names.length>0){stack_call_names.pop()}return ret}function creator_callstack_getTop(){var ret={ok:true,val:null,msg:""};if(0==stack_call_register.length){ret.ok=false;ret.msg="creator_callstack_getTop: empty stack_call_register !!.\n";return ret}ret.val=stack_call_register[stack_call_register.length-1];return ret}function creator_callstack_setTop(field,indexComponent,indexElement,value){var ret={ok:true,msg:""};if(0==stack_call_register.length){ret.ok=false;ret.msg="creator_callstack_getTop: empty stack_call_register !!.\n";return ret}var elto=stack_call_register[stack_call_register.length-1];if(typeof elto.length!=="undefined"){elto[field][indexComponent][indexElement]=value;return ret}elto[field]=value;return ret}function creator_callstack_setState(indexComponent,indexElement,newState){var elto=creator_callstack_getTop();if(elto.ok==false){console_log("creator_callstack_setState: "+elto.msg);return""}elto.val.register_sm[indexComponent][indexElement]=newState}function creator_callstack_getState(indexComponent,indexElement){var elto=creator_callstack_getTop();if(elto.ok==false){console_log("creator_callstack_getState: "+elto.msg);return""}return elto.val.register_sm[indexComponent][indexElement]}function creator_callstack_newWrite(indexComponent,indexElement,address,length){creator_callstack_do_transition("wm",indexComponent,indexElement,address);var elto=creator_callstack_getTop();if(elto.ok==false){console_log("creator_callstack_newWrite: "+elto.msg);return""}elto.val.register_address_write[indexComponent][indexElement].push(address);elto.val.register_size_write[indexComponent][indexElement].push(length)}function creator_callstack_newRead(indexComponent,indexElement,address,length){var elto=creator_callstack_getTop();if(elto.ok==false){console_log("creator_callstack_newRead: "+elto.msg);return""}elto.val.register_address_read[indexComponent][indexElement].push(address);elto.val.register_size_read[indexComponent][indexElement].push(length);creator_callstack_do_transition("rm",indexComponent,indexElement,address)}function creator_callstack_writeRegister(indexComponent,indexElement){creator_callstack_do_transition("wr",indexComponent,indexElement,address)}function creator_callstack_reset(){var ret={ok:true,msg:""};stack_call_names=[];stack_call_register=[];creator_callstack_enter("main");return ret}function creator_callstack_do_transition(doAction,indexComponent,indexElement,address){var state=creator_callstack_getState(indexComponent,indexElement);var action=doAction;if(doAction=="wm"){var elto=creator_callstack_getTop();if(elto.ok==false){console_log("creator_callstack_do_transition: "+elto.msg);return""}var equal=elto.val.register_address_write[indexComponent][indexElement].includes(address);action=equal?"wm==":"wm!="}if(typeof stack_state_transition[state]==="undefined"||typeof stack_state_transition[state][action]==="undefined"){if(state<40||state<0){console_log("creator_callstack_do_transition: undefined action")}return}var new_state=stack_state_transition[state][action];creator_callstack_setState(indexComponent,indexElement,new_state);if(action!="end"){console_log("creator_callstack_do_transition ["+architecture.components[indexComponent].elements[indexElement].name+"]: transition from "+"state '"+state+"'' to state '"+new_state+"' and action '"+action+"' is empty (warning).")}}function capi_raise(msg){if(typeof app!=="undefined")app.exception(msg);else console.log(msg)}function capi_arithmetic_overflow(op1,op2,res_u){op1_u=capi_uint2int(op1);op2_u=capi_uint2int(op2);res_u=capi_uint2int(res_u);return op1_u>0&&op2_u>0&&res_u<0||op1_u<0&&op2_u<0&&res_u>0}function capi_bad_align(addr,type){size=creator_memory_type2size(type);return addr%size!=0}function capi_mem_write(addr,value,type){var size=1;if(capi_bad_align(addr,type)){capi_raise("The memory must be align");return}try{writeMemory(value,addr,type)}catch(e){capi_raise("Invalid memory access to address '0x"+addr.toString(16)+"'")}}function capi_mem_read(addr,type){var size=1;var val=0;if(capi_bad_align(addr,type)){capi_raise("The memory must be align");return val}var addr_16=parseInt(addr,16);if(addr_16>=architecture.memory_layout[0].value&&addr_16<=architecture.memory_layout[1].value){creator_executor_exit();capi_raise("Segmentation fault. You tried to read in the text segment")}try{val=readMemory(addr,type)}catch(e){capi_raise("Invalid memory access to address '0x"+addr.toString(16)+"'");creator_executor_exit();return val}return creator_memory_value_by_type(val,type)}function capi_exit(){creator_ga("execute","execute.syscall","execute.syscall.exit");return creator_executor_exit()}function capi_print_int(value1){creator_ga("execute","execute.syscall","execute.syscall.print_int");var ret1=crex_findReg(value1);if(ret1.match==0){throw packExecute(true,"capi_syscall: register "+value1+" not found","danger",null)}var value=architecture.components[ret1.indexComp].elements[ret1.indexElem].value;var val_int=parseInt(value.toString())>>0;display_print(val_int)}function capi_print_float(value1){creator_ga("execute","execute.syscall","execute.syscall.print_float");var ret1=crex_findReg(value1);if(ret1.match==0){throw packExecute(true,"capi_syscall: register "+value1+" not found","danger",null)}var value=architecture.components[ret1.indexComp].elements[ret1.indexElem].value;display_print(value)}function capi_print_double(value1){creator_ga("execute","execute.syscall","execute.syscall.print_double");var ret1=crex_findReg(value1);if(ret1.match==0){throw packExecute(true,"capi_syscall: register "+value1+" not found","danger",null)}var value=architecture.components[ret1.indexComp].elements[ret1.indexElem].value;display_print(value)}function capi_print_char(value1){creator_ga("execute","execute.syscall","execute.syscall.print_char");var ret1=crex_findReg(value1);if(ret1.match==0){throw packExecute(true,"capi_syscall: register "+value1+" not found","danger",null)}var aux=architecture.components[ret1.indexComp].elements[ret1.indexElem].value;var aux2=aux.toString(16);var length=aux2.length;var value=aux2.substring(length-2,length);value=String.fromCharCode(parseInt(value,16));display_print(value)}function capi_print_string(value1){creator_ga("execute","execute.syscall","execute.syscall.print_string");var ret1=crex_findReg(value1);if(ret1.match==0){throw packExecute(true,"capi_syscall: register "+value1+" not found","danger",null)}var addr=architecture.components[ret1.indexComp].elements[ret1.indexElem].value;var ret=crex_get_string_from_memory(addr);if(ret.error==true){throw packExecute(true,ret.msg,ret.type,ret.draw)}display_print(ret.draw)}function capi_read_int(value1){creator_ga("execute","execute.syscall","execute.syscall.read_int");var ret1=crex_findReg(value1);if(ret1.match==0){throw packExecute(true,"capi_syscall: register "+value1+" not found","danger",null)}document.getElementById("enter_keyboard").scrollIntoView();return keyboard_read(kbd_read_int,ret1)}function capi_read_float(value1){creator_ga("execute","execute.syscall","execute.syscall.read_float");var ret1=crex_findReg(value1);if(ret1.match==0){throw packExecute(true,"capi_syscall: register "+value1+" not found","danger",null)}document.getElementById("enter_keyboard").scrollIntoView();return keyboard_read(kbd_read_float,ret1)}function capi_read_double(value1){creator_ga("execute","execute.syscall","execute.syscall.read_double");var ret1=crex_findReg(value1);if(ret1.match==0){throw packExecute(true,"capi_syscall: register "+value1+" not found","danger",null)}document.getElementById("enter_keyboard").scrollIntoView();return keyboard_read(kbd_read_double,ret1)}function capi_read_char(value1){creator_ga("execute","execute.syscall","execute.syscall.read_char");var ret1=crex_findReg(value1);if(ret1.match==0){throw packExecute(true,"capi_syscall: register "+value1+" not found","danger",null)}document.getElementById("enter_keyboard").scrollIntoView();return keyboard_read(kbd_read_char,ret1)}function capi_read_string(value1,value2){creator_ga("execute","execute.syscall","execute.syscall.read_string");var ret1=crex_findReg(value1);if(ret1.match==0){throw packExecute(true,"capi_syscall: register "+value1+" not found","danger",null)}var ret2=crex_findReg(value2);if(ret2.match==0){throw packExecute(true,"capi_syscall: register "+value2+" not found","danger",null)}document.getElementById("enter_keyboard").scrollIntoView();ret1.indexComp2=ret2.indexComp;ret1.indexElem2=ret2.indexElem;return keyboard_read(kbd_read_string,ret1)}function capi_sbrk(value1,value2){creator_ga("execute","execute.syscall","execute.syscall.sbrk");var ret1=crex_findReg(value1);if(ret1.match==0){throw packExecute(true,"capi_syscall: register "+value1+" not found","danger",null)}var ret2=crex_findReg(value2);if(ret2.match==0){throw packExecute(true,"capi_syscall: register "+value2+" not found","danger",null)}var new_size=parseInt(architecture.components[ret1.indexComp].elements[ret1.indexElem].value);var ret=crex_sbrk(new_size);if(ret.error==true){throw packExecute(true,ret.msg,ret.type,ret.draw)}architecture.components[ret2.indexComp].elements[ret2.indexElem].value=ret.draw}function capi_callconv_begin(addr){var function_name="";if(typeof architecture.components[0]!=="undefined"){if(typeof tag_instructions[addr]=="undefined")function_name="0x"+parseInt(addr).toString(16);else function_name=tag_instructions[addr]}creator_callstack_enter(function_name)}function capi_callconv_end(){var ret=creator_callstack_leave();if(ret.ok){return}creator_ga("execute","execute.exception","execute.exception.protection_jrra"+ret.msg);crex_show_notification(ret.msg,"danger")}function capi_callconv_memAction(action,addr,reg_name,type){var ret=crex_findReg(reg_name);if(ret.match==0){return}var i=ret.indexComp;var j=ret.indexElem;switch(action){case"write":creator_callstack_newWrite(i,j,addr,type);break;case"read":creator_callstack_newRead(i,j,addr,type);break;default:crex_show_notification(" Unknown action '"+action+"' at ...sing_convention_memory.\n","danger");break}}function capi_drawstack_begin(addr){var function_name="";if(typeof architecture.components[0]!=="undefined"){if(typeof tag_instructions[addr]=="undefined")function_name="0x"+parseInt(addr).toString(16);else function_name=tag_instructions[addr]}track_stack_enter(function_name)}function capi_drawstack_end(){var ret=track_stack_leave();if(ret.ok){return}crex_show_notification(ret.msg,"warning")}function capi_split_double(reg,index){var value=bin2hex(double2bin(reg));console_log(value);if(index==0){return value.substring(0,8)}if(index==1){return value.substring(8,16)}}function capi_uint2float32(value){return uint_to_float32(value)}function capi_float322uint(value){return float32_to_uint(value)}function capi_int2uint(value){return value>>>0}function capi_uint2int(value){return value>>0}function capi_uint2float64(value0,value1){return uint_to_float64(value0,value1)}function capi_float642uint(value){return float64_to_uint(value)}function capi_check_ieee(s,e,m){return checkTypeIEEE(s,e,m)}function capi_float2bin(f){return float2bin(f)}function capi_eval(expr){eval(crex_replace_magic(expr))}function crex_findReg(value1){var ret={};ret.match=0;ret.indexComp=null;ret.indexElem=null;if(value1==""){return ret}for(var i=0;i<architecture.components.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){if(architecture.components[i].elements[j].name.includes(value1)!=false){ret.match=1;ret.indexComp=i;ret.indexElem=j;break}}}return ret}function updateDouble(comp,elem){for(var j=0;j<architecture.components.length;j++){for(var z=0;z<architecture.components[j].elements.length&&architecture.components[j].double_precision==true;z++){if(architecture.components[comp].elements[elem].name.includes(architecture.components[j].elements[z].simple_reg[0])!=false){var simple=bin2hex(float2bin(architecture.components[comp].elements[elem].value));var double=bin2hex(double2bin(architecture.components[j].elements[z].value)).substr(8,15);var newDouble=simple+double;architecture.components[j].elements[z].value=hex2double("0x"+newDouble)}if(architecture.components[comp].elements[elem].name.includes(architecture.components[j].elements[z].simple_reg[1])!=false){var simple=bin2hex(float2bin(architecture.components[comp].elements[elem].value));var double=bin2hex(double2bin(architecture.components[j].elements[z].value)).substr(0,8);var newDouble=double+simple;architecture.components[j].elements[z].value=hex2double("0x"+newDouble)}}}}function updateSimple(comp,elem){var part1=bin2hex(double2bin(architecture.components[comp].elements[elem].value)).substr(0,8);var part2=bin2hex(double2bin(architecture.components[comp].elements[elem].value)).substr(8,15);for(var j=0;j<architecture.components.length;j++){for(var z=0;z<architecture.components[j].elements.length;z++){if(architecture.components[j].elements[z].name.includes(architecture.components[comp].elements[elem].simple_reg[0])!=false){architecture.components[j].elements[z].value=hex2float("0x"+part1)}if(architecture.components[j].elements[z].name.includes(architecture.components[comp].elements[elem].simple_reg[1])!=false){architecture.components[j].elements[z].value=hex2float("0x"+part2)}}}}function readRegister(indexComp,indexElem){var draw={space:[],info:[],success:[],danger:[],flash:[]};if(architecture.components[indexComp].elements[indexElem].properties.includes("read")!=true){for(var i=0;i<instructions.length;i++){draw.space.push(i)}draw.danger.push(executionIndex);executionIndex=-1;throw packExecute(true,"The register "+architecture.components[indexComp].elements[indexElem].name.join(" | ")+" cannot be read","danger",draw)}if(architecture.components[indexComp].type=="control"||architecture.components[indexComp].type=="integer"){console_log(parseInt(architecture.components[indexComp].elements[indexElem].value.toString()));return parseInt(architecture.components[indexComp].elements[indexElem].value.toString())}if(architecture.components[indexComp].type=="floating point"){return parseFloat(architecture.components[indexComp].elements[indexElem].value.toString())}}function writeRegister(value,indexComp,indexElem){var draw={space:[],info:[],success:[],danger:[],flash:[]};if(value==null){return}if(architecture.components[indexComp].type=="integer"||architecture.components[indexComp].type=="control"){if(architecture.components[indexComp].elements[indexElem].properties.includes("write")!=true){if(architecture.components[indexComp].elements[indexElem].properties.includes("ignore_write")!=false){return}for(var i=0;i<instructions.length;i++){draw.space.push(i)}draw.danger.push(executionIndex);executionIndex=-1;throw packExecute(true,"The register "+architecture.components[indexComp].elements[indexElem].name.join(" | ")+" cannot be written","danger",draw)}architecture.components[indexComp].elements[indexElem].value=bi_intToBigInt(value,10);creator_callstack_writeRegister(indexComp,indexElem);if(architecture.components[indexComp].elements[indexElem].properties.includes("pointer")!=false&&architecture.components[indexComp].elements[indexElem].properties.includes("stack")!=false&&value!=architecture.memory_layout[4].value){writeStackLimit(value)}if(typeof window!=="undefined"){btn_glow(architecture.components[indexComp].elements[indexElem].name,"Int")}}else if(architecture.components[indexComp].type=="floating point"){if(architecture.components[indexComp].double_precision==false){if(architecture.components[indexComp].elements[indexElem].properties.includes("write")!=true){if(architecture.components[indexComp].elements[indexElem].properties.includes("ignore_write")!=false){return}throw packExecute(true,"The register "+architecture.components[indexComp].elements[indexElem].name.join(" | ")+" cannot be written","danger",null)}architecture.components[indexComp].elements[indexElem].value=parseFloat(value);creator_callstack_writeRegister(indexComp,indexElem);if(architecture.components[indexComp].elements[indexElem].properties.includes("pointer")!=false&&architecture.components[indexComp].elements[indexElem].properties.includes("stack")!=false&&value!=architecture.memory_layout[4].value){writeStackLimit(value)}updateDouble(indexComp,indexElem);if(typeof window!=="undefined"){btn_glow(architecture.components[indexComp].elements[indexElem].name,"FP")}}else if(architecture.components[indexComp].double_precision==true){if(architecture.components[indexComp].elements[indexElem].properties.includes("write")!=true){if(architecture.components[indexComp].elements[indexElem].properties.includes("ignore_write")!=false){return}throw packExecute(true,"The register "+architecture.components[indexComp].elements[indexElem].name.join(" | ")+" cannot be written","danger",null)}architecture.components[indexComp].elements[indexElem].value=parseFloat(value);updateSimple(indexComp,indexElem);creator_callstack_writeRegister(indexComp,indexElem);if(typeof window!=="undefined"){btn_glow(architecture.components[indexComp].elements[indexElem].name,"DFP")}}}}var word_size_bits=32;var word_size_bytes=word_size_bits/8;var main_memory=[];var main_memory_datatypes={};function main_memory_get_addresses(){return Object.keys(main_memory)}function main_memory_datatype_get_addresses(){return Object.keys(main_memory_datatypes)}function main_memory_packs_forav(addr,value){return{addr:addr,bin:value,def_bin:"00",reset:true,break:false,tag:null}}function main_memory_datatypes_packs_foravt(addr,value,type){return{type:type,address:addr,value:value,default:"00"}}function main_memory_reset(){var i=0;var addrs=main_memory_get_addresses();for(i=0;i<addrs.length;i++){main_memory[addrs[i]].bin=main_memory[addrs[i]].def_bin}addrs=main_memory_datatype_get_addresses();for(i=0;i<addrs.length;i++){main_memory_datatypes[addrs[i]].value=main_memory_datatypes[addrs[i]].default}}function main_memory_clear(){main_memory=[];main_memory_datatypes={}}function main_memory_read(addr){if(typeof main_memory[addr]!=="undefined"){return main_memory[addr]}return main_memory_packs_forav(addr,"00")}function main_memory_write(addr,value){main_memory[addr]=value}function main_memory_read_value(addr){return main_memory_read(addr).bin}function main_memory_write_value(addr,value){var value_obj=main_memory_read(addr);value_obj.bin=value;main_memory_write(addr,value_obj)}function main_memory_write_tag(addr,tag){var value_obj=main_memory_read(addr);value_obj.tag=tag;main_memory_write(addr,value_obj)}function main_memory_read_nbytes(addr,n){var value="";for(var i=0;i<n;i++){value=value+main_memory_read_value(addr+i)}return value}function main_memory_write_nbytes(addr,value,n){var value_str=value.toString(16).padStart(2*n,"0");var chunks=value_str.match(/.{1,2}/g);for(var i=0;i<chunks.length;i++){main_memory_write_value(addr+i,chunks[i])}}var string_length_limit=4*1024;function create_memory_read_string(addr){var ch="";var ret_msg="";for(var i=0;i<string_length_limit;i++){ch=main_memory_read_value(addr+i);if(ch=="00"){return ret_msg}ret_msg+=String.fromCharCode(parseInt(ch,16))}return ret_msg+"... (string length greater than "+string_length_limit+" chars)"}function main_memory_read_bydatatype(addr,type){var ret=0;switch(type){case"b":case"byte":ret=main_memory_read_value(addr);break;case"h":case"half_word":ret=main_memory_read_nbytes(addr,word_size_bytes/2);break;case"w":case"integer":case"float":case"word":ret=main_memory_read_nbytes(addr,word_size_bytes);break;case"d":case"double":case"double_word":ret=main_memory_read_nbytes(addr,word_size_bytes*2);break;case"asciiz":case"string":case"ascii_null_end":ret=create_memory_read_string(addr);break;case"ascii":case"ascii_not_null_end":break;case"space":break;case"instruction":break}return ret}function main_memory_write_bydatatype(addr,value,type,value_human){var ret=0;switch(type){case"b":case"byte":var value2=creator_memory_value_by_type(value,type);ret=main_memory_write_nbytes(addr,value2,1);break;case"h":case"half":case"half_word":var value2=creator_memory_value_by_type(value,type);ret=main_memory_write_nbytes(addr,value2,word_size_bytes/2);break;case"w":case"integer":case"float":case"word":ret=main_memory_write_nbytes(addr,value,word_size_bytes);break;case"d":case"double":case"double_word":ret=main_memory_write_nbytes(addr,value,word_size_bytes*2);break;case"string":case"ascii_null_end":case"asciiz":case"ascii_not_null_end":case"ascii":var ch=0;for(var i=0;i<value.length;i++){ch=value.charCodeAt(i);main_memory_write_value(addr+i,ch.toString(16))}if(type!="ascii"&&type!="ascii_not_null_end"){main_memory_write_value(addr+value.length,"00")}break;case"space":for(var i=0;i<parseInt(value);i++){main_memory_write_value(addr+i,"00")}break;case"instruction":var nb=Math.ceil(value.toString().length/2);ret=main_memory_write_nbytes(addr,value,nb);break}main_memory_datatypes[addr]=main_memory_datatypes_packs_foravt(addr,value_human,type);return ret}function creator_memory_type2size(type){var size=4;switch(type){case"b":case"bu":case"byte":size=1;break;case"h":case"hu":case"half":case"half_word":size=word_size_bytes/2;break;case"w":case"wu":case"word":case"float":case"integer":case"instruction":size=word_size_bytes;break;case"d":case"du":case"double":case"double_word":size=word_size_bytes*2;break}return size}function creator_memory_value_by_type(val,type){switch(type){case"b":val=val&255;if(val&128)val=4294967040|val;break;case"bu":val=val<<24>>24;break;case"h":val=val&65535;if(val&32768)val=4294901760|val;break;case"hu":val=val<<16>>16;break;default:break}return val}function creator_memory_alignelto(new_addr,new_size){var ret={new_addr:new_addr,new_size:new_size};for(var i=0;i<word_size_bytes;i++){if((new_addr+i)%word_size_bytes==0){ret.new_addr=new_addr+i}if((new_size+i)%word_size_bytes==0){ret.new_size=new_size+i}}return ret}function creator_memory_prereset(){var i=0;var addrs=main_memory_get_addresses();for(i=0;i<addrs.length;i++){main_memory[addrs[i]].def_bin=main_memory[addrs[i]].bin}addrs=main_memory_datatype_get_addresses();for(i=0;i<addrs.length;i++){main_memory_datatypes[addrs[i]].default=main_memory_datatypes[addrs[i]].value}}function creator_memory_findaddress_bytag(tag){var ret={exit:0,value:0};var addrs=main_memory_get_addresses();for(var i=0;i<addrs.length;i++){if(main_memory[addrs[i]].tag==tag){ret.exit=1;ret.value=parseInt(addrs[i])}}return ret}function creator_memory_consolelog(){var i=0;console.log(" ~~~ main memory ~~~~~~~~~~~~~~");var addrs=main_memory_get_addresses();for(i=0;i<addrs.length;i++){console.log(JSON.stringify(main_memory[addrs[i]]))}console.log(" ~~~ datatypes ~~~~~~~~~~~~~~");addrs=main_memory_datatype_get_addresses();for(i=0;i<addrs.length;i++){console.log(JSON.stringify(main_memory_datatypes[addrs[i]]))}}function creator_memory_zerofill(new_addr,new_size){for(var i=0;i<new_size;i++){var value=main_memory_packs_forav(new_addr+i,"00");main_memory_write(new_addr+i,value)}return new_addr}function creator_memory_alloc(new_size){var new_addr=architecture.memory_layout[3].value+1;var algn=creator_memory_alignelto(new_addr,new_size);creator_memory_zerofill(algn.new_addr,algn.new_size);architecture.memory_layout[3].value=algn.new_addr+algn.new_size;if(typeof app!=="undefined"){app.architecture.memory_layout[3].value=algn.new_addr+algn.new_size}return algn.new_addr}function main_memory_storedata(data_address,value,size,dataLabel,value_human,DefValue,type){var algn=creator_memory_alignelto(data_address,size);main_memory_write_bydatatype(algn.new_addr,value,type,value_human);creator_memory_zerofill(algn.new_addr+size,algn.new_size-size);if(dataLabel!=""){main_memory_write_tag(algn.new_addr,dataLabel)}return data_address=data_address+algn.new_size}function creator_memory_updaterow(addr){if(typeof app=="undefined"||typeof app._data.main_memory=="undefined"){return}var addr_base=parseInt(addr);addr_base=addr_base-addr_base%word_size_bytes;var elto={};if(typeof app._data.main_memory[addr_base]!="undefined"){elto=app._data.main_memory[addr_base]}else{Vue.set(app._data.main_memory,addr_base,elto);elto.hex=[];for(var i=0;i<word_size_bytes;i++){elto.hex[i]={byte:"00",tag:null}}}elto.addr_begin="0x"+addr_base.toString(16).padStart(word_size_bytes*2,"0").toUpperCase();var addr_end=addr_base+word_size_bytes-1;elto.addr_end="0x"+addr_end.toString(16).padStart(word_size_bytes*2,"0").toUpperCase();elto.addr=addr_end;var v1={};for(var i=0;i<word_size_bytes;i++){v1=main_memory_read(addr_base+i);elto.hex[i].byte=v1.bin;elto.hex[i].tag=v1.tag;if(v1.tag==""){elto.hex[i].tag=null}}elto.value="";if(typeof main_memory_datatypes[addr_base]!="undefined"){elto.value=main_memory_datatypes[addr_base].value}elto.eye=false;if(typeof main_memory_datatypes[addr_base]!="undefined"){if(main_memory_datatypes[addr_base].type=="space"){elto.eye=true}}}function creator_memory_updateall(){if(typeof app=="undefined"||typeof app._data.main_memory=="undefined"){return}var addrs=main_memory_get_addresses();var last_addr=-1;var curr_addr=-1;for(var i=0;i<addrs.length;i++){curr_addr=parseInt(addrs[i]);if(Math.abs(curr_addr-last_addr)>3){creator_memory_updaterow(addrs[i]);last_addr=curr_addr}}}function creator_memory_clearall(){if(typeof app=="undefined"||typeof app._data.main_memory=="undefined"){return}app._data.main_memory={}}var memory_hash=["data_memory","instructions_memory","stack_memory"];var memory={data_memory:[],instructions_memory:[],stack_memory:[]};function writeMemory(value,addr,type){main_memory_write_bydatatype(addr,value,type,value);creator_memory_updaterow(addr);var draw={space:[],info:[],success:[],danger:[],flash:[]};if(value==null){return}var memValue=value.toString(16).padStart(8,"0");var index;if(type=="w"){if(addr>architecture.memory_layout[0].value&&addr<architecture.memory_layout[1].value||addr==architecture.memory_layout[0].value||addr==architecture.memory_layout[1].value){draw.danger.push(executionIndex);executionIndex=-1;throw packExecute(true,"Segmentation fault. You tried to read in the text segment","danger",null)}if(addr>architecture.memory_layout[2].value&&addr<architecture.memory_layout[3].value||addr==architecture.memory_layout[2].value||addr==architecture.memory_layout[3].value){index=memory_hash[0]}if(addr>architecture.memory_layout[4].value&&addr<architecture.memory_layout[5].value||addr==architecture.memory_layout[4].value||addr==architecture.memory_layout[5].value){index=memory_hash[2]}for(var i=0;i<memory[index].length;i++){for(var j=0;j<memory[index][i].Binary.length;j++){var aux="0x"+memory[index][i].Binary[j].Addr.toString(16);if(aux==addr||memory[index][i].Binary[j].Tag==addr){if(memory[index][i].type=="float"){memory[index][i].Value=hex2float("0x"+memValue)}else{memory[index][i].Value=parseInt(memValue,16)>>0}var charIndex=memValue.length-1;for(var z=0;z<memory[index][i].Binary.length;z++){memory[index][i].Binary[z].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();charIndex=charIndex-2}if(memory[index][i].type=="float"){memory[index][i].Value=hex2float("0x"+memValue)}else{memory[index][i].Value=parseInt(memValue,16)>>0}if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}}}for(var i=0;i<memory[index].length;i++){if(memory[index][i].Address>addr){var aux_addr=addr-addr%4;memory[index].splice(i,0,{Address:aux_addr,Binary:[],Value:parseInt(memValue,16)>>0,DefValue:null,reset:false});var charIndex=memValue.length-1;for(var z=0;z<4;z++){memory[index][i].Binary.push({Addr:aux_addr+z,DefBin:"00",Bin:memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase(),Tag:null});charIndex=charIndex-2}if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}else if(i==memory[index].length-1){var aux_addr=addr-addr%4;memory[index].push({Address:aux_addr,Binary:[],Value:parseInt(memValue,16)>>0,DefValue:null,reset:false});var charIndex=memValue.length-1;for(var z=0;z<4;z++){memory[index][i+1].Binary.push({Addr:aux_addr+z,DefBin:"00",Bin:memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase(),Tag:null});charIndex=charIndex-2}if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}}if(memory[index].length==0){var aux_addr=addr-addr%4;memory[index].push({Address:aux_addr,Binary:[],Value:parseInt(memValue,16)>>0,DefValue:null,reset:false});var charIndex=memValue.length-1;for(var z=0;z<4;z++){memory[index][memory[index].length-1].Binary.push({Addr:aux_addr+z,DefBin:"00",Bin:memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase(),Tag:null});charIndex=charIndex-2}if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}}if(type=="h"){if(addr>architecture.memory_layout[0].value&&addr<architecture.memory_layout[1].value||addr==architecture.memory_layout[0].value||addr==architecture.memory_layout[1].value){draw.danger.push(executionIndex);executionIndex=-1;throw packExecute(true,"Segmentation fault. You tried to read in the text segment","danger",null)}if(addr>architecture.memory_layout[2].value&&addr<architecture.memory_layout[3].value||addr==architecture.memory_layout[2].value||addr==architecture.memory_layout[3].value){index=memory_hash[0]}if(addr>architecture.memory_layout[4].value&&addr<architecture.memory_layout[5].value||addr==architecture.memory_layout[4].value||addr==architecture.memory_layout[5].value){index=memory_hash[2]}for(var i=0;i<memory[index].length;i++){for(var j=0;j<memory[index][i].Binary.length;j++){var aux="0x"+memory[index][i].Binary[j].Addr.toString(16);if(aux==addr||memory[index][i].Binary[j].Tag==addr){if(j<2){var charIndex=memValue.length-1;for(var z=0;z<memory[index][i].Binary.length-2;z++){memory[index][i].Binary[z].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();charIndex=charIndex-2}memory[index][i].Value=null;for(var z=3;z<4&&z>=0;z=z-2){memory[index][i].Value=memory[index][i].Value+(parseInt(memory[index][i].Binary[z].Bin+memory[index][i].Binary[z-1].Bin,16)>>0)+" "}if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}else{var charIndex=memValue.length-1;for(var z=2;z<memory[index][i].Binary.length;z++){memory[index][i].Binary[z].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();charIndex=charIndex-2}if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}}}}for(var i=0;i<memory[index].length;i++){if(memory[index][i].Address>addr){var aux_addr=addr-addr%4;memory[index].splice(i,0,{Address:aux_addr,Binary:[],Value:null,DefValue:null,reset:false});var charIndex=memValue.length-1;for(var z=0;z<4;z++){memory[index][i].Binary.push({Addr:aux_addr+z,DefBin:"00",Bin:"00",Tag:null})}for(var j=0;j<memory[index][i].Binary.length;j++){var aux="0x"+memory[index][i].Binary[j].Addr.toString(16);if(aux==addr||memory[index][i].Binary[j].Tag==addr){if(j<2){var charIndex=memValue.length-1;for(var z=0;z<memory[index][i].Binary.length-2;z++){memory[index][i].Binary[z].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();charIndex=charIndex-2}memory[index][i].Value="0 "+(parseInt(memValue,16)>>0);if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}else{var charIndex=memValue.length-1;for(var z=2;z<memory[index][i].Binary.length;z++){memory[index][i].Binary[z].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();charIndex=charIndex-2}memory[index][i].Value=(parseInt(memValue,16)>>0)+" 0";if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}}}return}else if(i==memory[index].length-1){var aux_addr=addr-addr%4;memory[index].push({Address:aux_addr,Binary:[],Value:null,DefValue:null,reset:false});var charIndex=memValue.length-1;for(var z=0;z<4;z++){memory[index][i+1].Binary.push({Addr:aux_addr+z,DefBin:"00",Bin:"00",Tag:null})}for(var j=0;j<memory[index][i+1].Binary.length;j++){var aux="0x"+memory[index][i+1].Binary[j].Addr.toString(16);if(aux==addr||memory[index][i+1].Binary[j].Tag==addr){if(j<2){var charIndex=memValue.length-1;for(var z=0;z<memory[index][i+1].Binary.length-2;z++){memory[index][i+1].Binary[z].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();charIndex=charIndex-2}memory[index][i+1].Value="0 "+(parseInt(memValue,16)>>0);if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}else{var charIndex=memValue.length-1;for(var z=2;z<memory[index][i].Binary.length;z++){memory[index][i+1].Binary[z].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();charIndex=charIndex-2}memory[index][i+1].Value=parseInt(memValue,16)+" 0";if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}}}return}}if(memory[index].length==0){var aux_addr=addr-addr%4;memory[index].push({Address:aux_addr,Binary:[],Value:null,DefValue:null,reset:false});var charIndex=memValue.length-1;for(var z=0;z<4;z++){memory[index][memory[index].length-1].Binary.push({Addr:aux_addr+z,DefBin:"00",Bin:"00",Tag:null})}for(var j=0;j<memory[index][memory[index].length-1].Binary.length;j++){var aux="0x"+memory[index][memory[index].length-1].Binary[j].Addr.toString(16);if(aux==addr||memory[index][memory[index].length-1].Binary[j].Tag==addr){if(j<2){var charIndex=memValue.length-1;for(var z=0;z<memory[index][memory[index].length-1].Binary.length-2;z++){memory[index][memory[index].length-1].Binary[z].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();charIndex=charIndex-2}memory[index][memory[index].length-1].Value="0 "+(parseInt(memValue,16)>>0);if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}else{var charIndex=memValue.length-1;for(var z=2;z<memory[index][i].Binary.length;z++){memory[index][memory[index].length-1].Binary[z].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();charIndex=charIndex-2}memory[index][memory[index].length-1].Value=(parseInt(memValue,16)>>0)+" 0";if(typeof app!=="undefined")app._data.memory[index]=memory[index];return}}}return}}if(type=="b"){if(addr>architecture.memory_layout[0].value&&addr<architecture.memory_layout[1].value||addr==architecture.memory_layout[0].value||addr==architecture.memory_layout[1].value){draw.danger.push(executionIndex);executionIndex=-1;throw packExecute(true,"Segmentation fault. You tried to read in the text segment","danger",null)}if(addr>architecture.memory_layout[2].value&&addr<architecture.memory_layout[3].value||addr==architecture.memory_layout[2].value||addr==architecture.memory_layout[3].value){index=memory_hash[0]}if(addr>architecture.memory_layout[4].value&&addr<architecture.memory_layout[5].value||addr==architecture.memory_layout[4].value||addr==architecture.memory_layout[5].value){index=memory_hash[2]}for(var i=0;i<memory[index].length;i++){for(var j=0;j<memory[index][i].Binary.length;j++){var aux="0x"+memory[index][i].Binary[j].Addr.toString(16);if(aux==addr||memory[index][i].Binary[j].Tag==addr){var charIndex=memValue.length-1;memory[index][i].Binary[j].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();memory[index][i].Value=null;for(var z=3;z<4&&z>=0;z--){memory[index][i].Value=memory[index][i].Value+parseInt(memory[index][i].Binary[z].Bin,16)+" "}return}}}for(var i=0;i<memory[index].length;i++){if(memory[index][i].Address>addr){var aux_addr=addr-addr%4;memory[index].splice(i,0,{Address:aux_addr,Binary:[],Value:null,DefValue:null,reset:false});var charIndex=memValue.length-1;for(var z=0;z<4;z++){memory[index][i].Binary.push({Addr:aux_addr+z,DefBin:"00",Bin:"00",Tag:null})}for(var j=0;j<memory[index][i].Binary.length;j++){var aux="0x"+memory[index][i].Binary[j].Addr.toString(16);if(aux==addr||memory[index][i].Binary[j].Tag==addr){var charIndex=memValue.length-1;memory[index][i].Binary[j].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();for(var z=3;z<4;z--){memory[index][i+1].Value=memory[index][i+1].Value+parseInt(memory[index][i+1].Binary[z].Bin,16)+" "}return}}return}else if(i==memory[index].length-1){var aux_addr=addr-addr%4;memory[index].push({Address:aux_addr,Binary:[],Value:null,DefValue:null,reset:false});var charIndex=memValue.length-1;for(var z=0;z<4;z++){memory[index][i+1].Binary.push({Addr:aux_addr+z,DefBin:"00",Bin:"00",Tag:null})}for(var j=0;j<memory[index][i+1].Binary.length;j++){var aux="0x"+memory[index][i+1].Binary[j].Addr.toString(16);if(aux==addr||memory[index][i+1].Binary[j].Tag==addr){var charIndex=memValue.length-1;memory[index][i+1].Binary[j].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();for(var z=3;z<4;z--){memory[index][i+1].Value=memory[index][i+1].Value+parseInt(memory[index][i+1].Binary[z].Bin,16)+" "}return}}return}}if(memory[index].length==0){var aux_addr=addr-addr%4;memory[index].push({Address:aux_addr,Binary:[],Value:null,DefValue:null,reset:false});var charIndex=memValue.length-1;for(var z=0;z<4;z++){memory[index][memory[index].length-1].Binary.push({Addr:aux_addr+z,DefBin:"00",Bin:"00",Tag:null})}for(var j=0;j<memory[index][memory[index].length-1].Binary.length;j++){var aux="0x"+memory[index][memory[index].length-1].Binary[j].Addr.toString(16);if(aux==addr||memory[index][memory[index].length-1].Binary[j].Tag==addr){var charIndex=memValue.length-1;memory[index][memory[index].length-1].Binary[j].Bin=memValue.charAt(charIndex-1).toUpperCase()+memValue.charAt(charIndex).toUpperCase();for(var z=3;z<4;z--){memory[index][memory[index].length-1].Value=memory[index][memory[index].length-1].Value+parseInt(memory[index][memory[index].length-1].Binary[z].Bin,16)+" "}return}}return}}}function readMemory(addr,type){main_memory_read_bydatatype(addr,type);var memValue="";var index;var draw={space:[],info:[],success:[],danger:[],flash:[]};if(type=="d"){if(parseInt(addr,16)>architecture.memory_layout[0].value&&parseInt(addr)<architecture.memory_layout[1].value||parseInt(addr,16)==architecture.memory_layout[0].value||parseInt(addr,16)==architecture.memory_layout[1].value){draw.danger.push(executionIndex);executionIndex=-1;throw packExecute(true,"Segmentation fault. You tried to read in the text segment","danger",null)}if(parseInt(addr,16)>architecture.memory_layout[2].value&&parseInt(addr)<architecture.memory_layout[3].value||parseInt(addr,16)==architecture.memory_layout[2].value||parseInt(addr,16)==architecture.memory_layout[3].value)index=memory_hash[0];if(parseInt(addr,16)>architecture.memory_layout[4].value&&parseInt(addr)<architecture.memory_layout[5].value||parseInt(addr,16)==architecture.memory_layout[4].value||parseInt(addr,16)==architecture.memory_layout[5].value)index=memory_hash[2];for(var i=0;i<memory[index].length;i++){for(var j=0;j<memory[index][i].Binary.length;j++){var aux="0x"+memory[index][i].Binary[j].Addr.toString(16);if(aux==addr||memory[index][i].Binary[j].Tag==addr){for(let k=0;k<2;k++)for(var z=0;z<memory[index][i].Binary.length;z++)memValue=memory[index][k].Binary[z].Bin+memValue;return parseInt(memValue,16)}}}return 0}if(type=="w"){if(parseInt(addr,16)>architecture.memory_layout[0].value&&parseInt(addr)<architecture.memory_layout[1].value||parseInt(addr,16)==architecture.memory_layout[0].value||parseInt(addr,16)==architecture.memory_layout[1].value){draw.danger.push(executionIndex);executionIndex=-1;throw packExecute(true,"Segmentation fault. You tried to read in the text segment","danger",null)}if(parseInt(addr,16)>architecture.memory_layout[2].value&&parseInt(addr)<architecture.memory_layout[3].value||parseInt(addr,16)==architecture.memory_layout[2].value||parseInt(addr,16)==architecture.memory_layout[3].value){index=memory_hash[0]}if(parseInt(addr,16)>architecture.memory_layout[4].value&&parseInt(addr)<architecture.memory_layout[5].value||parseInt(addr,16)==architecture.memory_layout[4].value||parseInt(addr,16)==architecture.memory_layout[5].value){index=memory_hash[2]}for(var i=0;i<memory[index].length;i++){for(var j=0;j<memory[index][i].Binary.length;j++){var aux="0x"+memory[index][i].Binary[j].Addr.toString(16);if(aux==addr||memory[index][i].Binary[j].Tag==addr){for(var z=0;z<memory[index][i].Binary.length;z++){memValue=memory[index][i].Binary[z].Bin+memValue}return parseInt(memValue,16)}}}return 0}if(type=="h"){if(parseInt(addr,16)>architecture.memory_layout[0].value&&parseInt(addr)<architecture.memory_layout[1].value||parseInt(addr,16)==architecture.memory_layout[0].value||parseInt(addr,16)==architecture.memory_layout[1].value){draw.danger.push(executionIndex);executionIndex=-1;throw packExecute(true,"Segmentation fault. You tried to read in the text segment","danger",null)}if(parseInt(addr,16)>architecture.memory_layout[2].value&&parseInt(addr)<architecture.memory_layout[3].value||parseInt(addr,16)==architecture.memory_layout[2].value||parseInt(addr,16)==architecture.memory_layout[3].value){index=memory_hash[0]}if(parseInt(addr,16)>architecture.memory_layout[4].value&&parseInt(addr)<architecture.memory_layout[5].value||parseInt(addr,16)==architecture.memory_layout[4].value||parseInt(addr,16)==architecture.memory_layout[5].value){index=memory_hash[2]}for(var i=0;i<memory[index].length;i++){for(var j=0;j<memory[index][i].Binary.length;j++){var aux="0x"+memory[index][i].Binary[j].Addr.toString(16);if(aux==addr||memory[index][i].Binary[j].Tag==addr){if(j<2){for(var z=0;z<memory[index][i].Binary.length-2;z++){memValue=memory[index][i].Binary[z].Bin+memValue}return parseInt(memValue,16)}else{for(var z=2;z<memory[index][i].Binary.length;z++){memValue=memory[index][i].Binary[z].Bin+memValue}return parseInt(memValue,16)}}}}return 0}if(type=="b"){if(parseInt(addr,16)>architecture.memory_layout[0].value&&parseInt(addr)<architecture.memory_layout[1].value||parseInt(addr,16)==architecture.memory_layout[0].value||parseInt(addr,16)==architecture.memory_layout[1].value){draw.danger.push(executionIndex);executionIndex=-1;throw packExecute(true,"Segmentation fault. You tried to read in the text segment","danger",null)}if(parseInt(addr,16)>architecture.memory_layout[2].value&&parseInt(addr)<architecture.memory_layout[3].value||parseInt(addr,16)==architecture.memory_layout[2].value||parseInt(addr,16)==architecture.memory_layout[3].value){index=memory_hash[0]}if(parseInt(addr,16)>architecture.memory_layout[4].value&&parseInt(addr)<architecture.memory_layout[5].value||parseInt(addr,16)==architecture.memory_layout[4].value||parseInt(addr,16)==architecture.memory_layout[5].value){index=memory_hash[2]}for(var i=0;i<memory[index].length;i++){for(var j=0;j<memory[index][i].Binary.length;j++){var aux="0x"+memory[index][i].Binary[j].Addr.toString(16);if(aux==addr||memory[index][i].Binary[j].Tag==addr){memValue=memory[index][i].Binary[j].Bin+memValue;return parseInt(memValue,16)}}}return 0}}function memory_reset(){main_memory_reset();creator_memory_updateall();for(var i=0;i<memory[memory_hash[0]].length;i++){if(memory[memory_hash[0]][i].reset==true){memory[memory_hash[0]].splice(i,1);i--}else{memory[memory_hash[0]][i].Value=memory[memory_hash[0]][i].DefValue;for(var j=0;j<memory[memory_hash[0]][i].Binary.length;j++){memory[memory_hash[0]][i].Binary[j].Bin=memory[memory_hash[0]][i].Binary[j].DefBin}}}for(var i=0;i<memory[memory_hash[2]].length;i++){if(memory[memory_hash[2]][i].reset==true){memory[memory_hash[2]].splice(i,1);i--}else{memory[memory_hash[2]][i].Value=memory[memory_hash[2]][i].DefValue;for(var j=0;j<memory[memory_hash[2]][i].Binary.length;j++){memory[memory_hash[2]][i].Binary[j].Bin=memory[memory_hash[2]][i].Binary[j].DefBin}}}}function crex_sbrk(new_size){creator_memory_alloc(new_size);var new_addr=0;var aux_addr=architecture.memory_layout[3].value+word_size_bytes;if(architecture.memory_layout[3].value+new_size>=architecture.memory_layout[4].value){executionIndex=-1;return packExecute(true,"Not enough memory for data segment","danger",null)}for(var i=0;i<new_size/4;i++){memory[memory_hash[0]].push({Address:aux_addr,Binary:[],Value:null,DefValue:null,reset:true});if(i==0){new_addr=aux_addr}for(var z=0;z<4;z++){memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:aux_addr,DefBin:"00",Bin:"00",Tag:null});aux_addr++}}if(typeof app!=="undefined"){app._data.memory[memory_hash[0]]=memory[memory_hash[0]]}architecture.memory_layout[3].value=aux_addr-1;if(typeof app!=="undefined"){app.architecture.memory_layout[3].value=aux_addr-1}for(var i=0;i<word_size_bytes;i++){new_addr=new_addr+i;if(new_addr%word_size_bytes==0){break}}return packExecute(false,"","danger",new_addr)}function crex_get_string_from_memory(addr){main_memory_read_bydatatype(parseInt(addr),"string");var index=0;var ret_msg="";if(parseInt(addr)>architecture.memory_layout[0].value&&parseInt(addr)<architecture.memory_layout[1].value||parseInt(addr)==architecture.memory_layout[0].value||parseInt(addr)==architecture.memory_layout[1].value){executionIndex=-1;if(typeof app!=="undefined"){app._data.keyboard=""}return packExecute(true,"Segmentation fault. You tried to write in the text segment","danger",null)}if(parseInt(addr)>architecture.memory_layout[2].value&&parseInt(addr)<architecture.memory_layout[3].value||parseInt(addr)==architecture.memory_layout[2].value||parseInt(addr)==architecture.memory_layout[3].value){index=memory_hash[0]}if(parseInt(addr)>architecture.memory_layout[4].value&&parseInt(addr)<architecture.memory_layout[5].value||parseInt(addr)==architecture.memory_layout[4].value||parseInt(addr)==architecture.memory_layout[5].value){index=memory_hash[2]}for(var i=0;i<memory[index].length;i++){for(var j=0;j<memory[index][i].Binary.length;j++){var aux="0x"+memory[index][i].Binary[j].Addr.toString(16);if(aux==addr){for(var i;i<memory[index].length;i++){for(var k=j;k<memory[index][i].Binary.length;k++){console_log(parseInt(memory[index][i].Binary[k].Bin,16));console_log(String.fromCharCode(parseInt(memory[index][i].Binary[k].Bin,16)));if(memory[index][i].Binary[k].Bin=="00"){return packExecute(false,"printed","info",ret_msg)}ret_msg+=String.fromCharCode(parseInt(memory[index][i].Binary[k].Bin,16));if(i==memory[index].length-1&&k==memory[index][i].Binary.length-1){return packExecute(false,"printed","info",ret_msg)}j=0}}}}}}function crex_read_string_into_memory(keystroke,value,addr,valueIndex,auxAddr){main_memory_write_bydatatype(parseInt(addr),keystroke,"string",keystroke);var ret={errorcode:"",token:"",type:"",update:"",status:"ok"};var index;if(parseInt(addr)>architecture.memory_layout[0].value&&parseInt(addr)<architecture.memory_layout[1].value||parseInt(addr)==architecture.memory_layout[0].value||parseInt(addr)==architecture.memory_layout[1].value){executionIndex=-1;if(typeof app!=="undefined")app.keyboard="";return packExecute(true,"Segmentation fault. You tried to read in the text segment","danger",null)}if(parseInt(addr)>architecture.memory_layout[2].value&&parseInt(addr)<architecture.memory_layout[3].value||parseInt(addr)==architecture.memory_layout[2].value||parseInt(addr)==architecture.memory_layout[3].value){index=memory_hash[0]}if(parseInt(addr)>architecture.memory_layout[4].value&&parseInt(addr)<architecture.memory_layout[5].value||parseInt(addr)==architecture.memory_layout[4].value||parseInt(addr)==architecture.memory_layout[5].value){index=memory_hash[2]}for(var i=0;i<memory[index].length&&keystroke.length>0;i++){for(var j=0;j<memory[index][i].Binary.length;j++){var aux="0x"+memory[index][i].Binary[j].Addr.toString(16);if(aux==addr){for(var j=j;j<memory[index][i].Binary.length&&valueIndex<value.length;j++){memory[index][i].Binary[j].Bin=value.charCodeAt(valueIndex).toString(16);auxAddr=memory[index][i].Binary[j].Addr;valueIndex++;addr++}memory[index][i].Value="";for(var j=0;j<memory[index][i].Binary.length;j++){memory[index][i].Value=String.fromCharCode(parseInt(memory[index][i].Binary[j].Bin,16))+" "+memory[index][i].Value}if(i+1<memory[index].length&&valueIndex<value.length){i++;for(var j=0;j<memory[index][i].Binary.length&&valueIndex<value.length;j++){memory[index][i].Binary[j].Bin=value.charCodeAt(valueIndex).toString(16);auxAddr=memory[index][i].Binary[j].Addr;valueIndex++;addr++}memory[index][i].Value="";for(var j=0;j<memory[index][i].Binary.length;j++){memory[index][i].Value=String.fromCharCode(parseInt(memory[index][i].Binary[j].Bin,16))+" "+memory[index][i].Value}}else if(valueIndex<value.length){data_address=auxAddr;memory[index].push({Address:data_address,Binary:[],Value:null,DefValue:null,reset:false});i++;for(var z=0;z<4;z++){if(valueIndex<value.length){memory[index][i].Binary.push({Addr:data_address,DefBin:value.charCodeAt(valueIndex).toString(16),Bin:value.charCodeAt(valueIndex).toString(16),Tag:null});valueIndex++;data_address++}else{memory[index][i].Binary.push({Addr:data_address,DefBin:"00",Bin:"00",Tag:null});data_address++}}memory[index][i].Value="";for(var j=0;j<memory[index][i].Binary.length;j++){memory[index][i].Value=String.fromCharCode(parseInt(memory[index][i].Binary[j].Bin,16))+" "+memory[index][i].Value}}}}}if(valueIndex==value.length){if(typeof app!=="undefined")app.keyboard="";consoleMutex=false;mutexRead=false;if(typeof app!=="undefined")app._data.enter=null;if(window.document)show_notification("The data has been uploaded","info");if(executionIndex>=instructions.length){for(var i=0;i<instructions.length;i++){draw.space.push(i)}executionIndex=-2;return packExecute(true,"The execution of the program has finished","success",null)}else if(runProgram==false){if(typeof app!=="undefined")app.executeProgram()}return ret}var auxAddr=parseInt(addr);while(valueIndex<value.length){memory[index].push({Address:auxAddr,Binary:[],Value:"",DefValue:"",reset:false});for(var z=0;z<4;z++){if(valueIndex>value.length-1){memory[index][i].Binary.push({Addr:auxAddr,DefBin:"00",Bin:"00",Tag:null})}else{memory[index][i].Binary.push({Addr:auxAddr,DefBin:"00",Bin:value.charCodeAt(valueIndex).toString(16),Tag:null});memory[index][i].Value=value.charAt(valueIndex)+" "+memory[index][i].Value}auxAddr++;valueIndex++}i++}return ret}function crex_memory_clear(){main_memory_clear();creator_memory_clearall();memory[memory_hash[0]]=[];memory[memory_hash[1]]=[];memory[memory_hash[2]]=[]}function crex_memory_data_compiler(value,size,dataLabel,DefValue,type){main_memory_storedata(data_address,value,size,dataLabel,DefValue,DefValue,type);for(var i=0;i<value.length/2;i++){if(data_address%align!=0&&i==0&&align!=0){while(data_address%align!=0){if(data_address%4==0){memory[memory_hash[0]].push({Address:data_address,Binary:[],Value:null,DefValue:null,reset:false,type:type});memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:data_address,DefBin:"00",Bin:"00",Tag:null});data_address++}else if(memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.length==4){data_address++}else{memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:data_address,DefBin:"00",Bin:"00",Tag:null});data_address++}}}if(data_address%size!=0&&i==0){return"m21"}if(data_address%4==0){console_log(DefValue);memory[memory_hash[0]].push({Address:data_address,Binary:[],Value:DefValue,DefValue:DefValue,reset:false,type:type});if(i==0){memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:data_address,DefBin:value.substring(value.length-(2+2*i),value.length-2*i),Bin:value.substring(value.length-(2+2*i),value.length-2*i),Tag:dataLabel});if(dataLabel!=null){data_tag.push({tag:dataLabel,addr:data_address})}dataLabel=null}else{memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:data_address,DefBin:value.substring(value.length-(2+2*i),value.length-2*i),Bin:value.substring(value.length-(2+2*i),value.length-2*i),Tag:null})}data_address++}else{if(value.length<=4&&i==0){console_log(DefValue);memory[memory_hash[0]][memory[memory_hash[0]].length-1].Value=DefValue+" "+memory[memory_hash[0]][memory[memory_hash[0]].length-1].Value;memory[memory_hash[0]][memory[memory_hash[0]].length-1].DefValue=DefValue+" "+memory[memory_hash[0]][memory[memory_hash[0]].length-1].DefValue}if(i==0){memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.splice(data_address%4,1,{Addr:data_address,DefBin:value.substring(value.length-(2+2*i),value.length-2*i),Bin:value.substring(value.length-(2+2*i),value.length-2*i),Tag:dataLabel});if(dataLabel!=null){data_tag.push({tag:dataLabel,addr:data_address})}dataLabel=null}else{memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.splice(data_address%4,1,{Addr:data_address,DefBin:value.substring(value.length-(2+2*i),value.length-2*i),Bin:value.substring(value.length-(2+2*i),value.length-2*i),Tag:null});console_log(memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary[data_address%4])}data_address++}}if(memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.length<4){var num_iter=4-memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.length;for(var i=0;i<num_iter;i++){memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:data_address+i,DefBin:"00",Bin:"00",Tag:null})}}return""}function creator_memory_findbytag(tag){creator_memory_findaddress_bytag(tag);var ret={exit:0,value:0};for(var z=0;z<memory[memory_hash[0]].length&&ret.exit==0;z++){for(var p=0;p<memory[memory_hash[0]][z].Binary.length&&ret.exit==0;p++){if(tag==memory[memory_hash[0]][z].Binary[p].Tag){ret.exit=1;ret.value=parseInt(memory[memory_hash[0]][z].Address,10);return ret}}}for(var z=0;z<memory[memory_hash[1]].length&&ret.exit==0;z++){for(var p=0;p<memory[memory_hash[1]][z].Binary.length&&ret.exit==0;p++){if(tag==memory[memory_hash[1]][z].Binary[p].Tag){ret.exit=1;ret.value=parseInt(memory[memory_hash[1]][z].Address,10);return ret}}}return ret}function creator_memory_copytoapp(hash_index){if(typeof app!=="undefined"){}if(typeof app!=="undefined"){app._data.memory[memory_hash[hash_index]]=memory[memory_hash[hash_index]]}}function creator_insert_instruction(auxAddr,value,def_value,hide,hex,fill_hex,label){var size=Math.ceil(hex.toString().length/2);main_memory_storedata(auxAddr,hex,size,label,def_value,def_value,"instruction");for(var a=0;a<hex.length/2;a++){var sub_hex=hex.substring(hex.length-(2+2*a),hex.length-2*a);if(auxAddr%4==0){memory[memory_hash[1]].push({Address:auxAddr,Binary:[],Value:value,DefValue:def_value,hide:hide});if(label==""){label=null}if(a==0){memory[memory_hash[1]][memory[memory_hash[1]].length-1].Binary.push({Addr:auxAddr,DefBin:sub_hex,Bin:sub_hex,Tag:label})}else{memory[memory_hash[1]][memory[memory_hash[1]].length-1].Binary.push({Addr:auxAddr,DefBin:sub_hex,Bin:sub_hex,Tag:null})}auxAddr++}else{if(a==0){console_log(label);memory[memory_hash[1]][memory[memory_hash[1]].length-1].Binary.splice(auxAddr%4,1,{Addr:auxAddr,DefBin:sub_hex,Bin:sub_hex,Tag:label})}else{memory[memory_hash[1]][memory[memory_hash[1]].length-1].Binary.splice(auxAddr%4,1,{Addr:auxAddr,DefBin:sub_hex,Bin:sub_hex,Tag:null})}auxAddr++}}if(memory[memory_hash[1]][memory[memory_hash[1]].length-1].Binary.length<4){var num_iter=4-memory[memory_hash[1]][memory[memory_hash[1]].length-1].Binary.length;for(var b=0;b<num_iter;b++){memory[memory_hash[1]][memory[memory_hash[1]].length-1].Binary.push({Addr:auxAddr+(b+1),DefBin:fill_hex,Bin:fill_hex,Tag:null})}}return auxAddr}function creator_memory_stackinit(stack_address){main_memory_write_bydatatype(parseInt(stack_address),"00","word","00");memory[memory_hash[2]].push({Address:stack_address,Binary:[],Value:null,DefValue:null,reset:false});for(var i=0;i<4;i++){memory[memory_hash[2]][memory[memory_hash[2]].length-1].Binary.push({Addr:stack_address+i,DefBin:"00",Bin:"00",Tag:null})}}function creator_memory_storestring(string,string_length,data_address,label,type,align){main_memory_storedata(data_address,string,string_length,label,string,string,type);var ascii;var character;for(var i=0;i<string_length;i++){ascii="0";character="";if(type!="space"){ascii=string.charCodeAt(i);character=string.charAt(i)}if(data_address%align!=0&&i==0&&align!=0){while(data_address%align!=0){if(data_address%4==0){memory[memory_hash[0]].push({Address:data_address,Binary:[],Value:null,DefValue:null,reset:false,type:type});memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:data_address,DefBin:"00",Bin:"00",Tag:null});data_address++}else if(memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.length==4){data_address++}else{memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:data_address,DefBin:"00",Bin:"00",Tag:null});data_address++}}}if(data_address%4==0){memory[memory_hash[0]].push({Address:data_address,Binary:[],Value:character,DefValue:character,reset:false,type:type});if(i==0){memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:data_address,DefBin:ascii.toString(16).padStart(2,"0"),Bin:ascii.toString(16).padStart(2,"0"),Tag:label});if(label!=null){data_tag.push({tag:label,addr:data_address})}label=null}else{memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:data_address,DefBin:ascii.toString(16).padStart(2,"0"),Bin:ascii.toString(16).padStart(2,"0"),Tag:null})}data_address++}else{if(i==0){memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.splice(data_address%4,1,{Addr:data_address,DefBin:ascii.toString(16).padStart(2,"0"),Bin:ascii.toString(16).padStart(2,"0"),Tag:label});memory[memory_hash[0]][memory[memory_hash[0]].length-1].Value=character+" "+memory[memory_hash[0]][memory[memory_hash[0]].length-1].Value;memory[memory_hash[0]][memory[memory_hash[0]].length-1].DefValue=character+" "+memory[memory_hash[0]][memory[memory_hash[0]].length-1].DefValue;if(label!=null){data_tag.push({tag:label,addr:data_address})}label=null}else{memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.splice(data_address%4,1,{Addr:data_address,DefBin:ascii.toString(16).padStart(2,"0"),Bin:ascii.toString(16).padStart(2,"0"),Tag:null});memory[memory_hash[0]][memory[memory_hash[0]].length-1].Value=character+" "+memory[memory_hash[0]][memory[memory_hash[0]].length-1].Value;memory[memory_hash[0]][memory[memory_hash[0]].length-1].DefValue=character+" "+memory[memory_hash[0]][memory[memory_hash[0]].length-1].DefValue}data_address++}}if(type=="asciiz"){if(data_address%4==0){memory[memory_hash[0]].push({Address:data_address,Binary:[],Value:"",DefValue:"",reset:false,type:type});memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:data_address,DefBin:"00",Bin:"00",Tag:null})}else{memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.splice(data_address%4,1,{Addr:data_address,DefBin:"00",Bin:"00",Tag:null})}data_address++}if(memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.length<4){var num_iter=4-memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.length;for(var i=0;i<num_iter;i++){memory[memory_hash[0]][memory[memory_hash[0]].length-1].Binary.push({Addr:data_address+i,DefBin:"00",Bin:"00",Tag:null})}}return data_address}var architecture_available=[];var load_architectures_available=[];var load_architectures=[];var back_card=[];var architecture={components:[],instructions:[],directives:[],memory_layout:[]};var architecture_hash=[];var componentsTypes=[{text:"Integer",value:"integer"},{text:"Floating point",value:"floating point"},{text:"Control",value:"control"}];var instructionsTypes=[{text:"Arithmetic integer",value:"Arithmetic integer"},{text:"Arithmetic floating point",value:"Arithmetic floating point"},{text:"Logic",value:"Logic"},{text:"Transfer between registers",value:"Transfer between registers"},{text:"Memory access",value:"Memory access"},{text:"Comparison",value:"Comparison"},{text:"I/O",value:"I/O"},{text:"Syscall",value:"Syscall"},{text:"Control",value:"Control"},{text:"Function call",value:"Function call"},{text:"Conditional bifurcation",value:"Conditional bifurcation"},{text:"Unconditional bifurcation",value:"Unconditional bifurcation"},{text:"Other",value:"Other"}];var actionTypes=[{text:"Data Segment",value:"data_segment"},{text:"Code Segment",value:"code_segment"},{text:"Global Symbol",value:"global_symbol"},{text:"Byte",value:"byte"},{text:"Half Word",value:"half_word"},{text:"Word",value:"word"},{text:"Double Word",value:"double_word"},{text:"Float",value:"float"},{text:"Double",value:"double"},{text:"Space",value:"space"},{text:"ASCII not finished in null",value:"ascii_not_null_end"},{text:"ASCII finished in null",value:"ascii_null_end"},{text:"Align",value:"align"},{text:"Balign",value:"balign"}];var textarea_assembly_editor;var codemirrorHistory=null;var code_assembly="";var tokenIndex=0;var nEnters=0;var pc=4;var address;var data_address;var stack_address;var backup_stack_address;var backup_data_address;var pending_instructions=[];var pending_tags=[];var extern=[];var compileError={m0:function(ret){return""+ret.token+""},m1:function(ret){return"Repeated tag: "+ret.token+""},m2:function(ret){return"Instruction '"+ret.token+"' not found"},m3:function(ret){return"Incorrect instruction syntax for '"+ret.token+"'"},m4:function(ret){return"Register '"+ret.token+"' not found"},m5:function(ret){return"Immediate number '"+ret.token+"' is too big"},m6:function(ret){return"Immediate number '"+ret.token+"' is not valid"},m7:function(ret){return"Tag '"+ret.token+"' is not valid"},m8:function(ret){return"Address '"+ret.token+"' is too big"},m9:function(ret){return"Address '"+ret.token+"' is not valid"},m10:function(ret){return".space value out of range ("+ret.token+" is greater than 50MiB)"},m12:function(ret){return"This field is too small to encode in binary '"+ret.token+""},m13:function(ret){return"Incorrect pseudoinstruction definition "+ret.token+""},m14:function(ret){return"Invalid directive: "+ret.token+""},m15:function(ret){return"Invalid value '"+ret.token+"' as number."},m16:function(ret){return'The string of characters must start with "'+ret.token+""},m17:function(ret){return'The string of characters must end with "'+ret.token+""},m18:function(ret){return"Number '"+ret.token+"' is too big"},m19:function(ret){return"Number '"+ret.token+"' is empty"},m21:function(ret){return"The data must be aligned"+ret.token+""},m22:function(ret){return"The number should be positive '"+ret.token+"'"},m23:function(ret){return"Empty directive"+ret.token+""},m24:function(ret){return"After the comma you should go a blank --\x3e "+ret.token+""},m26:function(ret){return"Syntax error near line: "+ret.token+""}};let promise;var notifications=[];var example_available=[];var executionIndex=0;var runExecution=false;var runProgram=false;var iter1=1;var executionInit=1;var consoleMutex=false;var mutexRead=false;var newExecution=true;var instructions=[];var instructions_tag=[];var tag_instructions={};var instructions_binary=[];var data=[];var data_tag=[];var code_binary="";var update_binary="";var totalStats=0;var stats_value=[0,0,0,0,0,0,0,0,0,0,0,0,0];var stats=[{type:"Arithmetic integer",number_instructions:0,percentage:0},{type:"Arithmetic floating point",number_instructions:0,percentage:0},{type:"Logic",number_instructions:0,percentage:0,abbreviation:"Log"},{type:"Transfer between registers",number_instructions:0,percentage:0},{type:"Memory access",number_instructions:0,percentage:0},{type:"Comparison",number_instructions:0,percentage:0},{type:"I/O",number_instructions:0,percentage:0},{type:"Syscall",number_instructions:0,percentage:0},{type:"Control",number_instructions:0,percentage:0},{type:"Function call",number_instructions:0,percentage:0},{type:"Conditional bifurcation",number_instructions:0,percentage:0},{type:"Unconditional bifurcation",number_instructions:0,percentage:0},{type:"Other",number_instructions:0,percentage:0}];var keyboard="";var display="";function load_arch_select(cfg){var ret={errorcode:"",token:"",type:"",update:"",status:"ok"};var auxArchitecture=cfg;architecture=register_value_deserialize(auxArchitecture);architecture_hash=[];for(var i=0;i<architecture.components.length;i++){architecture_hash.push({name:architecture.components[i].name,index:i})}backup_stack_address=architecture.memory_layout[4].value;backup_data_address=architecture.memory_layout[3].value;ret.token="The selected architecture has been loaded correctly";ret.type="success";return ret}var creator_debug=false;function console_log(msg){if(creator_debug){console.log(msg)}}function packCompileError(err_code,err_token,err_ti,err_bgcolor){var ret={};ret.status="error";ret.errorcode=err_code;ret.token=err_token;ret.type=err_ti;ret.bgcolor=err_bgcolor;ret.tokenIndex=tokenIndex;ret.line=nEnters;ret.msg=compileError[err_code](ret);creator_ga("compile","compile.error","compile.error."+ret.msg);creator_ga("compile","compile.type_error","compile.type_error."+err_code);return ret}function first_token(){var assembly=code_assembly;var index=tokenIndex;if(index>=assembly.length){return null}while(":\t\n \r#".includes(assembly.charAt(index))&&index<assembly.length){while(":\t\n \r".includes(assembly.charAt(index))&&index<assembly.length){if(assembly.charAt(index)=="\n")nEnters++;index++}if(assembly.charAt(index)=="#"){while(assembly.charAt(index)!="\n"&&index<assembly.length){index++}while(":\t\n \r".includes(assembly.charAt(index))&&index<assembly.length){if(assembly.charAt(index)=="\n")nEnters++;index++}}}tokenIndex=index}function get_token(){var assembly=code_assembly;var index=tokenIndex;if(index>=assembly.length){return null}if(assembly.charAt(index)=="'"){index++;while(assembly.charAt(index)!="'"&&index<assembly.length){index++}index++;return assembly.substring(tokenIndex,index)}if(assembly.charAt(index)=='"'){index++;while(assembly.charAt(index)!='"'&&index<assembly.length){index++}index++;return assembly.substring(tokenIndex,index)}if("([{".includes(assembly.charAt(index))){index++}while(",()[]{}:#\t\n \r".includes(assembly.charAt(index))==false&&index<assembly.length){index++}var res=assembly.substring(tokenIndex,index);if(":)]}".includes(assembly.charAt(index))){res=res+assembly.charAt(index)}return res}function next_token(){var assembly=code_assembly;var index=tokenIndex;if(assembly.charAt(index)=="'"){index++;while(assembly.charAt(index)!="'"&&index<assembly.length){if(assembly.charAt(index)=="\n")nEnters++;index++}index++}if(assembly.charAt(index)=='"'){index++;while(assembly.charAt(index)!='"'&&index<assembly.length){if(assembly.charAt(index)=="\n")nEnters++;index++}index++}if("([{".includes(assembly.charAt(index))){index++}while(",()[]{}:#\t\n \r".includes(assembly.charAt(index))==false&&index<assembly.length){index++}while(",()[]{}:#\t\n \r".includes(assembly.charAt(index))&&index<assembly.length){while(",)]}:\t\n \r".includes(assembly.charAt(index))&&index<assembly.length){if(assembly.charAt(index)=="\n")nEnters++;index++}if("([{".includes(assembly.charAt(index))){break}if(assembly.charAt(index)=="#"){while(assembly.charAt(index)!="\n"&&index<assembly.length){index++}while("()[]{}:\t\n \r".includes(assembly.charAt(index))&&index<assembly.length){if(assembly.charAt(index)=="\n")nEnters++;index++}}}tokenIndex=index}function assembly_compiler(){var ret={errorcode:"",token:"",type:"",update:"",status:"ok"};creator_ga("compile","compile.assembly");instructions=[];instructions_tag=[];tag_instructions={};pending_instructions=[];pending_tags=[];data_tag=[];instructions_binary=[];crex_memory_clear();extern=[];data=[];executionInit=1;mutexRead=false;pc=4;nEnters=0;if(update_binary.instructions_binary!=null){for(var i=0;i<update_binary.instructions_binary.length;i++){instructions.push(update_binary.instructions_binary[i]);if(i==0){instructions[instructions.length-1].hide=false;if(update_binary.instructions_binary[i].globl==false){instructions[instructions.length-1].Label=""}}else if(update_binary.instructions_binary[i].globl==false){instructions[instructions.length-1].Label="";instructions[instructions.length-1].hide=true}else if(update_binary.instructions_binary[i].globl==null){instructions[instructions.length-1].hide=true}else{instructions[instructions.length-1].hide=false}address=parseInt(instructions[instructions.length-1].Address,16)+4}}else{address=parseInt(architecture.memory_layout[0].value)}var numBinaries=instructions.length;architecture.memory_layout[4].value=backup_stack_address;architecture.memory_layout[3].value=backup_data_address;data_address=parseInt(architecture.memory_layout[2].value);stack_address=parseInt(architecture.memory_layout[4].value);architecture.components[1].elements[29].value=bi_intToBigInt(stack_address,10);architecture.components[0].elements[0].value=bi_intToBigInt(address,10);architecture.components[1].elements[29].default_value=bi_intToBigInt(stack_address,10);architecture.components[0].elements[0].default_value=bi_intToBigInt(address,10);totalStats=0;for(var i=0;i<stats.length;i++){stats[i].percentage=0;stats[i].number_instructions=0;stats_value[i]=0}align=0;var empty=false;first_token();if(get_token()==null){hide_loading();return packCompileError("m0","Please enter the assembly code before compiling","warning","danger")}token=get_token();console_log(token);while(!empty){token=get_token();console_log(token);if(token==null){empty=true;break}var change=false;for(var i=0;i<architecture.directives.length;i++){if(token==architecture.directives[i].name){switch(architecture.directives[i].action){case"data_segment":console_log("data_segment");ret=data_segment_compiler();if(ret.status=="ok"){change=true}if(ret.status!="ok"){instructions=[];pending_instructions=[];pending_tags=[];data_tag=[];instructions_binary=[];data=[];extern=[];crex_memory_clear();return ret}break;case"code_segment":console_log("code_segment");ret=code_segment_compiler();if(ret.status=="ok"){change=true}if(ret.status!="ok"){instructions=[];pending_instructions=[];pending_tags=[];data_tag=[];instructions_binary=[];extern=[];data=[];crex_memory_clear();return ret}break;case"global_symbol":var isGlobl=true;next_token();while(isGlobl){token=get_token();re=new RegExp(",","g");token=token.replace(re,"");console_log("token: "+token);extern.push(token);change=true;next_token();token=get_token();console_log("token: "+token);for(var z=0;z<architecture.directives.length;z++){if(token==architecture.directives[z].name||token==null||token.search(/\:$/)!=-1){isGlobl=false}}}break;default:console_log("default");empty=true;break}}else if(i==architecture.directives.length-1&&token!=architecture.directives[i].name&&change==false&&token!=null){empty=true;return packCompileError("m14",token,"error","danger")}}}var found=false;if(update_binary.instructions_binary!=null){for(var j=0;j<instructions.length;j++){if(instructions[j].Label!=""){for(var i=0;i<update_binary.instructions_tag.length;i++){if(instructions[j].Label==update_binary.instructions_tag[i].tag){update_binary.instructions_tag[i].addr=instructions[j].Address}}}}}for(var i=0;i<pending_instructions.length;i++){var exit=0;var signatureParts=pending_instructions[i].signature;var signatureRawParts=pending_instructions[i].signatureRaw;var instructionParts=pending_instructions[i].instruction.split(" ");console_log(instructionParts);for(var j=0;j<signatureParts.length&&exit==0;j++){if(signatureParts[j]=="inm-signed"||signatureParts[j]=="inm-unsigned"||signatureParts[j]=="address"){for(var z=0;z<instructions.length&&exit==0;z++){if(instructions[z].Label==instructionParts[j]){var addr=instructions[z].Address;var bin=parseInt(addr,16).toString(2);var startbit=pending_instructions[i].startBit;var stopbit=pending_instructions[i].stopBit;instructionParts[j]=addr;var newInstruction="";for(var w=0;w<instructionParts.length;w++){newInstruction=newInstruction+instructionParts[w];if(w!=instructionParts.length-1){newInstruction=newInstruction+" "}}for(var w=0;w<instructions.length&&exit==0;w++){var aux="0x"+pending_instructions[i].address.toString(16);if(aux==instructions[w].Address){instructions[w].loaded=newInstruction}}for(var w=0;w<instructions.length&&exit==0;w++){var aux="0x"+pending_instructions[i].address.toString(16);if(aux==instructions[w].Address){instructions[w].loaded=newInstruction;var fieldsLength=startbit-stopbit+1;console_log(w);console_log(numBinaries);console_log(w-numBinaries);var iload=instructions_binary[w-numBinaries].loaded;instructions_binary[w-numBinaries].loaded=iload.substring(0,iload.length-(startbit+1))+bin.padStart(fieldsLength,"0")+iload.substring(iload.length-stopbit,iload.length);exit=1}}}}var ret1=creator_memory_findbytag(instructionParts[j]);if(ret1.exit==1){var addr=ret1.value;var bin=parseInt(addr,16).toString(2);var startbit=pending_instructions[i].startBit;var stopbit=pending_instructions[i].stopBit;instructionParts[j]="0x"+addr.toString(16);var newInstruction="";for(var w=0;w<instructionParts.length;w++){newInstruction=newInstruction+instructionParts[w];if(w!=instructionParts.length-1){newInstruction=newInstruction+" "}}for(var w=0;w<instructions.length;w++){var aux="0x"+pending_instructions[i].address.toString(16);if(aux==instructions[w].Address){instructions[w].loaded=newInstruction}}for(var w=0;w<instructions.length&&exit==0;w++){var aux="0x"+pending_instructions[i].address.toString(16);if(aux==instructions[w].Address){instructions[w].loaded=newInstruction;var fieldsLength=startbit-stopbit+1;var iload=instructions_binary[w-numBinaries].loaded;instructions_binary[w-numBinaries].loaded=iload.substring(0,iload.length-(startbit+1))+bin.padStart(fieldsLength,"0")+iload.substring(iload.length-stopbit,iload.length);exit=1}}}if(exit==0&&isNaN(instructionParts[j])==true){nEnters=pending_instructions[i].line;instructions=[];pending_instructions=[];pending_tags=[];data_tag=[];instructions_binary=[];crex_memory_clear();data=[];extern=[];return packCompileError("m7",instructionParts[j],"error","danger")}}if(signatureParts[j]=="offset_words"){for(var z=0;z<instructions.length&&exit==0;z++){if(instructions[z].Label==instructionParts[j]){var addr=instructions[z].Address;var startbit=pending_instructions[i].startBit;var stopbit=pending_instructions[i].stopBit;addr=(addr-pending_instructions[i].address)/4-1;console_log(instructionParts);console_log(addr);var bin=bi_intToBigInt(addr,10).toString(2);bin=bin.substring(startbit-stopbit+1,bin.length);instructionParts[j]=addr;var newInstruction="";for(var w=0;w<instructionParts.length;w++){if(w==instructionParts.length-1){newInstruction=newInstruction+instructionParts[w]}else{newInstruction=newInstruction+instructionParts[w]+" "}}for(var w=0;w<instructions.length&&exit==0;w++){var aux="0x"+pending_instructions[i].address.toString(16);if(aux==instructions[w].Address){instructions[w].loaded=newInstruction}}for(var w=0;w<instructions.length&&exit==0;w++){var aux="0x"+pending_instructions[i].address.toString(16);if(aux==instructions[w].Address){instructions[w].loaded=newInstruction;var fieldsLength=startbit-stopbit+1;console_log(w);console_log(numBinaries);console_log(w-numBinaries);console_log(bin.padStart(fieldsLength,"0"));instructions_binary[w-numBinaries].loaded=instructions_binary[w-numBinaries].loaded.substring(0,instructions_binary[w-numBinaries].loaded.length-(startbit+1))+bin.padStart(fieldsLength,"0")+instructions_binary[w-numBinaries].loaded.substring(instructions_binary[w-numBinaries].loaded.length-stopbit,instructions_binary[w-numBinaries].loaded.length);exit=1}}}}if(exit==0){nEnters=pending_instructions[i].line;instructions=[];pending_instructions=[];pending_tags=[];data_tag=[];instructions_binary=[];crex_memory_clear();data=[];extern=[];return packCompileError("m7",instructionParts[j],"error","danger")}}if(signatureParts[j]=="offset_bytes"){for(var z=0;z<instructions.length&&exit==0;z++){if(instructions[z].Label==instructionParts[j]){var addr=instructions[z].Address;var startbit=pending_instructions[i].startBit;var stopbit=pending_instructions[i].stopBit;addr=addr-pending_instructions[i].address-1;var bin=bi_intToBigInt(addr,10).toString(2);bin=bin.substring(startbit-stopbit+1,bin.length);instructionParts[j]=addr;var newInstruction="";for(var w=0;w<instructionParts.length;w++){if(w==instructionParts.length-1){newInstruction=newInstruction+instructionParts[w]}else{newInstruction=newInstruction+instructionParts[w]+" "}}for(var w=0;w<instructions.length&&exit==0;w++){var aux="0x"+pending_instructions[i].address.toString(16);if(aux==instructions[w].Address){instructions[w].loaded=newInstruction}}for(var w=0;w<instructions.length&&exit==0;w++){var aux="0x"+pending_instructions[i].address.toString(16);if(aux==instructions[w].Address){instructions[w].loaded=newInstruction;var fieldsLength=startbit-stopbit+1;console_log(w);console_log(numBinaries);console_log(w-numBinaries);instructions_binary[w-numBinaries].loaded=instructions_binary[w-numBinaries].loaded.substring(0,instructions_binary[w-numBinaries].loaded.length-(startbit+1))+bin.padStart(fieldsLength,"0")+instructions_binary[w-numBinaries].loaded.substring(instructions_binary[w-numBinaries].loaded.length-stopbit,instructions_binary[w-numBinaries].loaded.length);exit=1}}}}if(exit==0){nEnters=pending_instructions[i].line;instructions=[];pending_instructions=[];pending_tags=[];data_tag=[];instructions_binary=[];crex_memory_clear();data=[];extern=[];return packCompileError("m7",instructionParts[j],"error","danger")}}}}if(update_binary.instructions_binary!=null){for(var i=0;i<update_binary.instructions_binary.length;i++){var hex=bin2hex(update_binary.instructions_binary[i].loaded);var auxAddr=parseInt(update_binary.instructions_binary[i].Address,16);var label=update_binary.instructions_binary[i].Label;var hide=false;if(i==0){hide=false;if(update_binary.instructions_binary[i].globl==false){label=""}}else if(update_binary.instructions_binary[i].globl==false){hide=true;label=""}else if(update_binary.instructions_binary[i].globl==null){hide=true}else{hide=false}auxAddr=creator_insert_instruction(auxAddr,"********","********",hide,hex,"**",label)}creator_memory_copytoapp(1)}for(var i=0;i<instructions_binary.length;i++){var hex=bin2hex(instructions_binary[i].loaded);var auxAddr=parseInt(instructions_binary[i].Address,16);var label=instructions_binary[i].Label;var binNum=0;if(update_binary.instructions_binary!=null){binNum=update_binary.instructions_binary.length}auxAddr=creator_insert_instruction(auxAddr,instructions[i+binNum].loaded,instructions[i+binNum].loaded,false,hex,"00",label)}creator_memory_copytoapp(1);for(var i=0;i<instructions_binary.length;i++){if(extern.length==0&&instructions_binary[i].Label!=""){instructions_binary[i].Label=instructions_binary[i].Label+"_symbol";instructions_binary[i].globl=false}else{for(var j=0;j<extern.length;j++){if(instructions_binary[i].Label!=extern[j]&&j==extern.length-1&&instructions_binary[i].Label!=""){instructions_binary[i].Label=instructions_binary[i].Label+"_symbol";instructions_binary[i].globl=false;break}else if(instructions_binary[i].Label==extern[j]){instructions_binary[i].globl=true;break}}}}for(var i=0;i<instructions_tag.length;i++){if(extern.length==0&&instructions_tag[i].tag!=""){instructions_tag[i].tag=instructions_tag[i].tag+"_symbol";instructions_tag[i].globl=false;break}else{for(var j=0;j<extern.length;j++){if(instructions_tag[i].tag!=extern[j]&&j==extern.length-1&&instructions_tag[i].tag!=""){instructions_tag[i].tag=instructions_tag[i].tag+"_symbol";instructions_tag[i].globl=false;break}else if(instructions_tag[i].tag==extern[j]){instructions_tag[i].globl=true;break}}}}if(typeof app!="undefined")app._data.instructions=instructions;creator_memory_stackinit(stack_address);creator_memory_copytoapp(2);address=architecture.memory_layout[0].value;data_address=architecture.memory_layout[2].value;stack_address=architecture.memory_layout[4].value;creator_memory_prereset();return ret}function data_segment_compiler(){var ret={errorcode:"",token:"",type:"",update:"",status:"ok"};var existsData=true;next_token();while(existsData){token=get_token();console_log("token: "+token);var label="";if(token==null){break}var found=false;if(token.search(/\:$/)!=-1){if(token.length==1){return packCompileError("m0","Empty label","error","danger")}for(var i=0;i<data_tag.length;i++){console_log(data_tag[i].tag);console_log(token.substring(0,token.length-1));if(data_tag[i].tag==token.substring(0,token.length-1)){return packCompileError("m1",token.substring(0,token.length-1),"error","danger")}}for(var i=0;i<instructions.length;i++){if(instructions[i].Label==token.substring(0,token.length-1)){return packCompileError("m1",token.substring(0,token.length-1),"error","danger")}}label=token.substring(0,token.length-1);next_token();token=get_token()}for(var j=0;j<architecture.directives.length;j++){if(token==architecture.directives[j].name){switch(architecture.directives[j].action){case"byte":var isByte=true;next_token();while(isByte){token=get_token();if(token==null){return packCompileError("m23","","error","danger")}re=new RegExp("([0-9A-Fa-f-]),([0-9A-Fa-f-])");if(token.search(re)!=-1){return packCompileError("m24",token,"error","danger")}re=new RegExp(",","g");token=token.replace(re,"");console_log("byte, "+token);var auxToken;var auxTokenString;if(token.match(/^\'(.*?)\'$/)){var re=/^\'(.*?)\'$/;console_log(re);var match=re.exec(token);console_log(match);var asciiCode;console_log(match[1]);if(token.search(/^\'\\n\'$/)!=-1){asciiCode=10}else if(token.search(/^\'\\t\'$/)!=-1){asciiCode=9}else{asciiCode=match[1].charCodeAt(0)}console_log(asciiCode);auxTokenString=asciiCode.toString(16)}else if(token.match(/^0x/)){var value=token.split("x");re=new RegExp("[0-9A-Fa-f]{"+value[1].length+"}","g");if(value[1].search(re)==-1){return packCompileError("m15",token,"error","danger")}auxTokenString=value[1].padStart(2*architecture.directives[j].size,"0");if(value[1].length==0){return packCompileError("m19",token,"error","danger")}if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length)}else{var re=new RegExp("[0-9-]{"+token.length+"}","g");if(token.search(re)==-1){return packCompileError("m15",token,"error","danger")}auxToken=parseInt(token)>>>0;auxTokenString=auxToken.toString(16).substring(auxToken.toString(16).length-2*architecture.directives[j].size,auxToken.toString(16).length).padStart(2*architecture.directives[j].size,"0");if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length)}console_log(auxTokenString);ret=data_compiler(auxTokenString,architecture.directives[j].size,label,parseInt(auxTokenString,16)>>0,"byte");if(ret.status!="ok"){return ret}label=null;console_log("byte Terminado");next_token();token=get_token();console_log("token: "+token);for(var z=0;z<architecture.directives.length;z++){if(token==architecture.directives[z].name||token==null||token.search(/\:$/)!=-1){isByte=false}}}j=0;break;case"half_word":console_log("half_word");var ishalf=true;next_token();while(ishalf){token=get_token();if(token==null){return packCompileError("m23","","error","danger")}re=new RegExp("([0-9A-Fa-f-]),([0-9A-Fa-f-])");if(token.search(re)!=-1){return packCompileError("m24",token,"error","danger")}re=new RegExp(",","g");token=token.replace(re,"");console_log("half_word, "+token);var auxToken;var auxTokenString;if(token.match(/^0x/)){var value=token.split("x");re=new RegExp("[0-9A-Fa-f]{"+value[1].length+"}","g");if(value[1].search(re)==-1){return packCompileError("m15",token,"error","danger")}auxTokenString=value[1].padStart(2*architecture.directives[j].size,"0");if(value[1].length==0){return packCompileError("m19",token,"error","danger")}if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length)}else{var re=new RegExp("[0-9-]{"+token.length+"}","g");if(token.search(re)==-1){return packCompileError("m15",token,"error","danger")}auxToken=parseInt(token)>>>0;auxTokenString=auxToken.toString(16).substring(auxToken.toString(16).length-2*architecture.directives[j].size,auxToken.toString(16).length).padStart(2*architecture.directives[j].size,"0");if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length)}console_log(auxTokenString);ret=data_compiler(auxTokenString,architecture.directives[j].size,label,parseInt(auxTokenString,16)>>0,"half");if(ret.status!="ok"){return ret}label=null;console_log("half Terminado");next_token();token=get_token();console_log("token: "+token);for(var z=0;z<architecture.directives.length;z++){if(token==architecture.directives[z].name||token==null||token.search(/\:$/)!=-1){ishalf=false}}}j=0;break;case"word":var isWord=true;next_token();while(isWord){console_log("word");token=get_token();if(token==null){return packCompileError("m23","","error","danger")}re=new RegExp("([0-9A-Fa-f-]),([0-9A-Fa-f-])");if(token.search(re)!=-1){return packCompileError("m24",token,"error","danger")}re=new RegExp(",","g");token=token.replace(re,"");console_log("token: "+token);var auxToken;var auxTokenString;if(token.match(/^0x/)){var value=token.split("x");re=new RegExp("[0-9A-Fa-f]{"+value[1].length+"}","g");if(value[1].search(re)==-1){return packCompileError("m15",token,"error","danger")}auxTokenString=value[1].padStart(2*architecture.directives[j].size,"0");if(value[1].length==0){return packCompileError("m19",token,"error","danger")}if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length)}else{var re=new RegExp("[0-9-]{"+token.length+"}","g");if(token.search(re)==-1){return packCompileError("m15",token,"error","danger")}auxToken=parseInt(token)>>>0;auxTokenString=auxToken.toString(16).substring(auxToken.toString(16).length-2*architecture.directives[j].size,auxToken.toString(16).length).padStart(2*architecture.directives[j].size,"0");if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length)}console_log(auxTokenString);ret=data_compiler(auxTokenString,architecture.directives[j].size,label,parseInt(auxTokenString,16)>>0,"word");if(ret.status!="ok"){return ret}label=null;console_log("word Terminado");next_token();token=get_token();console_log("token: "+token);for(var z=0;z<architecture.directives.length;z++){if(token==architecture.directives[z].name||token==null||token.search(/\:$/)!=-1){isWord=false}}}j=0;break;case"double_word":var isDoubleWord=true;next_token();while(isDoubleWord){console_log("word");token=get_token();if(token==null){return packCompileError("m23","","error","danger")}re=new RegExp("([0-9A-Fa-f-]),([0-9A-Fa-f-])");if(token.search(re)!=-1){return packCompileError("m24",token,"error","danger")}re=new RegExp(",","g");token=token.replace(re,"");console_log("token: "+token);var auxToken;var auxTokenString;if(token.match(/^0x/)){var value=token.split("x");re=new RegExp("[0-9A-Fa-f]{"+value[1].length+"}","g");if(value[1].search(re)==-1){return packCompileError("m15",token,"error","danger")}auxTokenString=value[1].padStart(2*architecture.directives[j].size,"0");if(value[1].length==0){return packCompileError("m19",token,"error","danger")}if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length)}else{var re=new RegExp("[0-9-]{"+token.length+"}","g");if(token.search(re)==-1){return packCompileError("m15",token,"error","danger")}auxToken=parseInt(token)>>>0;auxTokenString=auxToken.toString(16).substring(auxToken.toString(16).length-2*architecture.directives[j].size,auxToken.toString(16).length).padStart(2*architecture.directives[j].size,"0");if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length)}ret=data_compiler(auxTokenString,architecture.directives[j].size,label,parseInt(auxTokenString,16)>>0,"double_word");if(ret.status!="ok"){return ret}label=null;console_log("double word Terminado");next_token();token=get_token();console_log("token: "+token);for(var z=0;z<architecture.directives.length;z++){if(token==architecture.directives[z].name||token==null||token.search(/\:$/)!=-1){isDoubleWord=false}}}j=0;break;case"float":var isFloat=true;next_token();while(isFloat){console_log("float");token=get_token();if(token==null){return packCompileError("m23","","error","danger")}re=new RegExp("([0-9A-Fa-f-]),([0-9A-Fa-f-])");if(token.search(re)!=-1){return packCompileError("m24",token,"error","danger")}re=new RegExp(",","g");token=token.replace(re,"");console_log("token: "+token);var auxToken;var auxTokenString;if(token=="-Inf"||token=="-inf"||token=="-Infinity"||token=="-infinity"){token="-Infinity";auxTokenString="FF800000"}else if(token=="Inf"||token=="+Inf"||token=="inf"||token=="+inf"||token=="Infinity"||token=="+Infinity"||token=="infinity"||token=="+infinity"){token="+Infinity";auxTokenString="7F800000"}else if(token=="NaN"||token=="nan"){token="NaN";auxTokenString="7FC00000"}else if(token.match(/^0x/)){var value=token.split("x");re=new RegExp("[0-9A-Fa-f]{"+value[1].length+"}","g");if(value[1].search(re)==-1){return packCompileError("m15",token,"error","danger")}auxTokenString=value[1].padStart(2*architecture.directives[j].size,"0");if(value[1].length==0){return packCompileError("m19",token,"error","danger")}if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length);token=hex2float(token)}else{var re=new RegExp("[+e0-9.-]{"+token.length+"}","g");if(token.search(re)==-1){return packCompileError("m15",token,"error","danger")}auxToken=parseFloat(token,10);auxTokenString=bin2hex(float2bin(auxToken)).padStart(2*architecture.directives[j].size,"0");if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length)}console_log(auxTokenString);data_compiler(auxTokenString,architecture.directives[j].size,label,token,"float");if(ret.status!="ok"){return ret}label=null;console_log("float Terminado");next_token();token=get_token();console_log("token: "+token);for(var z=0;z<architecture.directives.length;z++){if(token==architecture.directives[z].name||token==null||token.search(/\:$/)!=-1){isFloat=false}}}j=0;break;case"double":var isDouble=true;next_token();while(isDouble){console_log("double");token=get_token();if(token==null){return packCompileError("m23","","error","danger")}re=new RegExp("([0-9A-Fa-f-]),([0-9A-Fa-f-])");if(token.search(re)!=-1){return packCompileError("m24",token,"error","danger")}re=new RegExp(",","g");token=token.replace(re,"");console_log("token: "+token);var auxToken;var auxTokenString;if(token=="-Inf"||token=="-inf"||token=="-Infinity"||token=="-infinity"){token="-Infinity";auxTokenString="FFF0000000000000"}else if(token=="Inf"||token=="+Inf"||token=="inf"||token=="+inf"||token=="Infinity"||token=="+Infinity"||token=="infinity"||token=="+infinity"){token="+Infinity";auxTokenString="7FF0000000000000"}else if(token=="NaN"||token=="nan"){token="NaN";auxTokenString="7FF8000000000000"}else if(token.match(/^0x/)){var value=token.split("x");re=new RegExp("[0-9A-Fa-f]{"+value[1].length+"}","g");if(value[1].search(re)==-1){return packCompileError("m15",token,"error","danger")}auxTokenString=value[1].padStart(2*architecture.directives[j].size,"0");if(value[1].length==0){return packCompileError("m19",token,"error","danger")}if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length);token=hex2double(token)}else{var re=new RegExp("[+e0-9.-]{"+token.length+"}","g");if(token.search(re)==-1){return packCompileError("m15",token,"error","danger")}auxToken=parseFloat(token,10);console_log(auxTokenString);auxTokenString=bin2hex(double2bin(auxToken)).padStart(2*architecture.directives[j].size,"0");if(auxTokenString.length>2*architecture.directives[j].size){return packCompileError("m18",token,"error","danger")}auxTokenString=auxTokenString.substring(auxTokenString.length-2*architecture.directives[j].size,auxTokenString.length)}console_log(auxTokenString);data_compiler(auxTokenString,architecture.directives[j].size,label,token,"double");if(ret.status!="ok"){return ret}label=null;console_log("double Terminado");next_token();token=get_token();console_log("token: "+token);for(var z=0;z<architecture.directives.length;z++){if(token==architecture.directives[z].name||token==null||token.search(/\:$/)!=-1){isDouble=false}}}j=0;break;case"ascii_not_null_end":console_log("ascii_not_null_end");var isAscii=true;var nextToken=1;next_token();while(isAscii){token=get_token();console_log("token: "+token);string=token;re=new RegExp('^"');if(string.search(re)!=-1){string=string.replace(re,"");console_log(string)}else{return packCompileError("m16","","error","danger")}re=new RegExp('"$');if(string.search(re)!=-1){string=string.replace(re,"");console_log(string)}else{return packCompileError("m17","","error","danger")}if(token==null){break}data_address=creator_memory_storestring(string,string.length,data_address,label,"ascii",align);console_log("ascii_not_null_end Terminado");if(nextToken==1){next_token();token=get_token();console_log("token: "+token)}nextToken=1;for(var z=0;z<architecture.directives.length;z++){if(token==architecture.directives[z].name||token==null||token.search(/\:$/)!=-1){isAscii=false}}}j=0;break;case"ascii_null_end":console_log("ascii_null_end");var isAscii=true;var nextToken=1;next_token();while(isAscii){console_log("ascii_null_end");token=get_token();console_log("token: "+token);if(token==null){break}string=token;re=new RegExp('^"');if(string.search(re)!=-1){string=string.replace(re,"");console_log(string)}else{return packCompileError("m16","","error","danger")}re=new RegExp('"$');if(string.search(re)!=-1){string=string.replace(re,"");console_log(string)}else{return packCompileError("m17","","error","danger")}data_address=creator_memory_storestring(string,string.length,data_address,label,"asciiz",align);console_log("ascii_null_end Terminado");if(nextToken==1){next_token();token=get_token();console_log("token: "+token)}nextToken=1;for(var z=0;z<architecture.directives.length;z++){if(token==architecture.directives[z].name||token==null||token.search(/\:$/)!=-1){isAscii=false}}}j=0;break;case"space":console_log("space");var string="";next_token();token=get_token();console_log("token: "+token);if(token==null){return packCompileError("m23","","error","danger")}var re=new RegExp("[0-9-]{"+token.length+"}","g");if(token.search(re)==-1){return packCompileError("m15",token,"error","danger")}if(parseInt(token)<0){return packCompileError("m22",token,"error","danger")}if(parseInt(token)>50*1024*1024){return packCompileError("m10",token,"error","danger")}var size=parseInt(token)*architecture.directives[j].size;data_address=creator_memory_storestring(size,size,data_address,label,"space",align);next_token();token=get_token();console_log("token: "+token);console_log("space Terminado");break;case"align":case"balign":console_log("[b]align");let pow_mode=token==".align";next_token();token=get_token();console_log("token: "+token);if(token==null){return packCompileError("m23","","error","danger")}var re=new RegExp("[0-9-]{"+token.length+"}","g");if(token.search(re)==-1){return packCompileError("m15",token,"error","danger")}if(parseInt(token)<0){return packCompileError("m22",token,"error","danger")}align=pow_mode?Math.pow(2,parseInt(token)):token;console_log(align);next_token();token=get_token();console_log("token: "+token);console_log("align Terminado");break;default:console_log("Default");existsData=false;break}}else if(j==architecture.directives.length-1&&token!=architecture.directives[j].name&&token!=null&&token.search(/\:$/)==-1){creator_memory_prereset();creator_memory_copytoapp(0);return ret}}}creator_memory_prereset();creator_memory_copytoapp(0);return ret}function data_compiler(value,size,dataLabel,DefValue,type){var ret={errorcode:"",token:"",type:"",update:"",status:"ok"};var r=crex_memory_data_compiler(value,size,dataLabel,DefValue,type);if(r!=""){return packCompileError(r,"","error","danger")}return ret}function code_segment_compiler(){var ret={errorcode:"",token:"",type:"",update:"",status:"ok"};var existsInstruction=true;next_token();var instInit=tokenIndex;while(existsInstruction){token=get_token();for(var i=0;i<architecture.directives.length;i++){if(token==architecture.directives[i].name&&architecture.directives[i].action=="global_symbol"){next_token();next_token();token=get_token()}else if(token==architecture.directives[i].name){if(typeof app!=="undefined")app._data.instructions=instructions;console_log("token: "+token);for(var i=0;i<instructions.length;i++){if(instructions[i].Label!=""){instructions_tag.push({tag:instructions[i].Label,addr:parseInt(instructions[i].Address,16)});tag_instructions[parseInt(instructions[i].Address,16)]=instructions[i].Label}}return ret}}var label="";var validTagPC=true;if(token==null){break}console_log("token: "+token);var found=false;var end=false;if(token.search(/\:$/)!=-1){if(token.length==1){return packCompileError("m0","Empty label","error","danger")}var ret1=creator_memory_findbytag(token.substring(0,token.length-1));if(ret1.exit==1){return packCompileError("m1",token.substring(0,token.length-1),"error","danger")}for(var i=0;i<instructions.length;i++){if(instructions[i].Label==token.substring(0,token.length-1)){return packCompileError("m1",token.substring(0,token.length-1),"error","danger")}}label=token.substring(0,token.length-1);next_token();instInit=tokenIndex;token=get_token();if(token!=null){var re=new RegExp(",+$");token=token.replace(re,"")}else{var instIndex;for(var i=0;i<architecture.instructions.length;i++){if(architecture.instructions[i].name=="nop"){instIndex=i}}instruction_compiler("nop","nop",label,tokenIndex,false,0,instInit,instIndex,false);end=true;found=true}}var re=new RegExp(",+$");if(token!=null){token=token.replace(re,"");console_log("token: "+token);var stopFor=false}for(var i=0;i<architecture.instructions.length&&stopFor==false&&end==false;i++){if(architecture.instructions[i].name!=token){continue}else{var instruction="";var userInstruction="";var numFields=0;found=true;for(var j=0;j<architecture.instructions[i].fields.length;j++){if(architecture.instructions[i].fields[j].type!="cop"){numFields++}}console_log(numFields);instruction=instruction+token;userInstruction=userInstruction+token;for(var j=0;j<numFields-1;j++){next_token();token=get_token();console_log("token: "+token);if(token!=null){var re=new RegExp(",+$");token=token.replace(re,"");instruction=instruction+" "+token;userInstruction=userInstruction+" "+token}}console_log(instruction);console_log(label);ret=instruction_compiler(instruction,userInstruction,label,tokenIndex,false,0,instInit,i,false);if(ret.status!="ok"){return ret}next_token();instInit=tokenIndex;stopFor=true}}if(!found){var resultPseudo=-3;var instruction="";var numToken=0;var exists=false;var inst=token;console_log("token: "+token);for(var i=0;i<architecture.pseudoinstructions.length&&exists==false;i++){if(architecture.pseudoinstructions[i].name==token){numToken=architecture.pseudoinstructions[i].fields.length;console_log(numToken);exists=true;instruction=instruction+token;for(var i=0;i<numToken;i++){next_token();token=get_token();if(token!=null){var re=new RegExp(",+$");token=token.replace(re,"")}instruction=instruction+" "+token}resultPseudo=pseudoinstruction_compiler(instruction,label,tokenIndex);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}}if(resultPseudo==-3){for(var i=0;i<architecture.components.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){var re=new RegExp(architecture.components[i].elements[j].name.join("|"));if(token.search(re)!=-1){existsInstruction=false;instructions=[];pending_instructions=[];pending_tags=[];data_tag=[];instructions_binary=[];extern=[];crex_memory_clear();data=[];ret=packCompileError("m26",nEnters+1,"error","danger");return ret}}}existsInstruction=false;instructions=[];pending_instructions=[];pending_tags=[];data_tag=[];instructions_binary=[];extern=[];crex_memory_clear();data=[];ret=packCompileError("m2",token,"error","danger");return ret}if(resultPseudo==-2){existsInstruction=false;instructions=[];pending_instructions=[];pending_tags=[];data_tag=[];instructions_binary=[];extern=[];data=[];crex_memory_clear();ret=packCompileError("m2",token,"error","danger");return ret}if(resultPseudo==-1){existsInstruction=false;instructions=[];pending_instructions=[];pending_tags=[];data_tag=[];instructions_binary=[];extern=[];data=[];crex_memory_clear();ret=packCompileError("m24","","error","danger");return ret}next_token();instInit=tokenIndex}}token=get_token();console_log("token: "+token);if(typeof app!=="undefined")app._data.instructions=instructions;for(var i=0;i<instructions.length;i++){if(instructions[i].Label!=""){instructions_tag.push({tag:instructions[i].Label,addr:parseInt(instructions[i].Address,16)});tag_instructions[parseInt(instructions[i].Address,16)]=instructions[i].Label}}return ret}function instruction_compiler(instruction,userInstruction,label,line,pending,pendingAddress,instInit,instIndex,isPseudo){var ret={errorcode:"",token:"",type:"",update:"",status:"ok"};if(instIndex==null){instIndex=0}console_log(instruction);console_log(instIndex);var re=new RegExp("^ +");var oriInstruction=instruction.replace(re,"");re=new RegExp(" +","g");oriInstruction=oriInstruction.replace(re," ");var instructionParts=oriInstruction.split(" ");var validTagPC=true;var startBit;var stopBit;var resultPseudo=-3;console_log(label);console_log(line);var stopFor=false;for(var i=instIndex;i<architecture.instructions.length&&stopFor==false;i++){if(architecture.instructions[i].name!=instructionParts[0]){continue}else{var auxSignature=architecture.instructions[i].signatureRaw;var tag="";var binary="";binary=binary.padStart(architecture.instructions[i].nwords*32,"0");var instruction=architecture.instructions[i].signature_definition;var userInstruction=userInstruction;var signatureDef=architecture.instructions[i].signature_definition;signatureDef=signatureDef.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");re=new RegExp("[fF][0-9]+","g");signatureDef=signatureDef.replace(re,"(.*?)");re=new RegExp(",","g");var signature=architecture.instructions[i].signature.replace(re," ");re=new RegExp(signatureDef+"$");var match=re.exec(signature);var signatureParts=[];for(var j=1;j<match.length;j++){signatureParts.push(match[j])}match=re.exec(architecture.instructions[i].signatureRaw);var signatureRawParts=[];for(var j=1;j<match.length;j++){signatureRawParts.push(match[j])}console_log(signatureParts);console_log(signatureRawParts);re=new RegExp(signatureDef+"$");console_log(re);if(oriInstruction.search(re)==-1){if(isPseudo==false){console_log(get_token());tokenIndex=instInit;token=get_token();console_log("token: "+token)}else{token=instructionParts[0]}var resultPseudo=null;var instruction="";var numToken=0;console_log("token: "+token);for(var i=i+1;i<architecture.instructions.length;i++){if(architecture.instructions[i].name==token){var index=i;numToken=architecture.instructions[i].fields.length;instruction=instruction+token;for(var a=1;a<numToken;a++){if(architecture.instructions[i].fields[a].type!="cop"){if(isPseudo==false){next_token();token=get_token();if(token!=null){var re=new RegExp(",+$");token=token.replace(re,"")}}else{token=instructionParts[a]}instruction=instruction+" "+token;console_log(instruction)}}if(isPseudo==false){ret=instruction_compiler(instruction,instruction,label,line,pending,pendingAddress,instInit,index,false)}else{ret=instruction_compiler(instruction,userInstruction,label,line,pending,pendingAddress,instInit,index,false)}return ret}}for(var i=0;i<architecture.pseudoinstructions.length;i++){if(architecture.pseudoinstructions[i].name==token){numToken=architecture.pseudoinstructions[i].fields.length;instruction=instruction+token;for(var i=0;i<numToken;i++){next_token();token=get_token();if(token!=null){var re=new RegExp(",+$");token=token.replace(re,"")}instruction=instruction+" "+token}console_log(instruction);resultPseudo=pseudoinstruction_compiler(instruction,label,tokenIndex);console_log(resultPseudo);if(resultPseudo.status=="ok"){return resultPseudo}if(resultPseudo.errorcode==3){return resultPseudo}}}}if(resultPseudo==null){return packCompileError("m3",auxSignature,"error","danger")}console_log(oriInstruction);console_log(re);match=re.exec(oriInstruction);instructionParts=[];if(match!=null){for(var j=1;j<match.length;j++){instructionParts.push(match[j])}}else{return packCompileError("m3",auxSignature,"error","danger")}console_log(instructionParts);re=new RegExp("[fF][0-9]+");while(instruction.search(re)!=-1){re=new RegExp("[fF]([0-9]+)");var match=re.exec(instruction);re=new RegExp("[fF][0-9]+");instruction=instruction.replace(re,"Field"+match[1])}for(var j=0;j<signatureParts.length;j++){console_log(signatureParts[j]);switch(signatureParts[j]){case"INT-Reg":token=instructionParts[j];console_log("token: "+token);var validReg=false;var regNum=0;for(var a=0;a<architecture.instructions[i].fields.length;a++){if(architecture.instructions[i].fields[a].name==signatureRawParts[j]){for(var z=0;z<architecture_hash.length;z++){for(var w=0;w<architecture.components[z].elements.length;w++){if(architecture.components[z].elements[w].name.includes(token)!=false&&architecture.components[z].type=="integer"){validReg=true;regNum++;fieldsLength=architecture.instructions[i].fields[a].startbit-architecture.instructions[i].fields[a].stopbit+1;var reg=w;if(reg.toString(2).length>fieldsLength){return packCompileError("m12",token,"error","danger")}console_log(reg);console_log(reg.toString(2).padStart(fieldsLength,"0"));console_log(binary);console_log(binary.length);console_log(architecture.instructions[i].fields[a].startbit+1);console_log(binary.length-(architecture.instructions[i].fields[a].startbit+1));binary=binary.substring(0,binary.length-(architecture.instructions[i].fields[a].startbit+1))+reg.toString(2).padStart(fieldsLength,"0")+binary.substring(binary.length-architecture.instructions[i].fields[a].stopbit,binary.length);console_log(binary);re=RegExp("Field[0-9]+");instruction=instruction.replace(re,token)}else if(z==architecture_hash.length-1&&w==architecture.components[z].elements.length-1&&validReg==false){return packCompileError("m4",token,"error","danger")}regNum++}}}}break;case"SFP-Reg":token=instructionParts[j];console_log("token: "+token);var validReg=false;var regNum=0;for(var a=0;a<architecture.instructions[i].fields.length;a++){if(architecture.instructions[i].fields[a].name==signatureRawParts[j]){for(var z=0;z<architecture_hash.length;z++){for(var w=0;w<architecture.components[z].elements.length;w++){if(architecture.components[z].elements[w].name.includes(token)!=false&&architecture.components[z].type=="floating point"&&architecture.components[z].double_precision==false){validReg=true;regNum++;fieldsLength=architecture.instructions[i].fields[a].startbit-architecture.instructions[i].fields[a].stopbit+1;var reg=regNum;if(reg.toString(2).length>fieldsLength){return packCompileError("m12",token,"error","danger")}binary=binary.substring(0,binary.length-(architecture.instructions[i].fields[a].startbit+1))+reg.toString(2).padStart(fieldsLength,"0")+binary.substring(binary.length-architecture.instructions[i].fields[a].stopbit,binary.length);re=RegExp("Field[0-9]+");console_log(instruction);instruction=instruction.replace(re,token);console_log(instruction)}else if(z==architecture_hash.length-1&&w==architecture.components[z].elements.length-1&&validReg==false){return packCompileError("m4",token,"error","danger")}if(architecture.components[z].type=="floating point"&&architecture.components[z].double_precision==false){regNum++}}}}}break;case"DFP-Reg":token=instructionParts[j];console_log("token: "+token);var validReg=false;var regNum=0;for(var a=0;a<architecture.instructions[i].fields.length;a++){if(architecture.instructions[i].fields[a].name==signatureRawParts[j]){for(var z=0;z<architecture_hash.length;z++){for(var w=0;w<architecture.components[z].elements.length;w++){if(architecture.components[z].elements[w].name.includes(token)!=false&&architecture.components[z].type=="floating point"&&architecture.components[z].double_precision==true){validReg=true;regNum++;fieldsLength=architecture.instructions[i].fields[a].startbit-architecture.instructions[i].fields[a].stopbit+1;var reg=regNum;if(reg.toString(2).length>fieldsLength){return packCompileError("m12",token,"error","danger")}binary=binary.substring(0,binary.length-(architecture.instructions[i].fields[a].startbit+1))+reg.toString(2).padStart(fieldsLength,"0")+binary.substring(binary.length-architecture.instructions[i].fields[a].stopbit,binary.length);re=RegExp("Field[0-9]+");instruction=instruction.replace(re,token)}else if(z==architecture_hash.length-1&&w==architecture.components[z].elements.length-1&&validReg==false){return packCompileError("m4",token,"error","danger")}if(architecture.components[z].type=="floating point"&&architecture.components[z].double_precision==true){regNum++}}}}}break;case"Ctrl-Reg":token=instructionParts[j];console_log("token: "+token);var validReg=false;var regNum=0;for(var a=0;a<architecture.instructions[i].fields.length;a++){if(architecture.instructions[i].fields[a].name==signatureRawParts[j]){for(var z=0;z<architecture_hash.length;z++){for(var w=0;w<architecture.components[z].elements.length;w++){if(architecture.components[z].elements[w].name.includes(token)!=false&&architecture.components[z].type=="control"){validReg=true;regNum++;fieldsLength=architecture.instructions[i].fields[a].startbit-architecture.instructions[i].fields[a].stopbit+1;var reg=regNum;if(reg.toString(2).length>fieldsLength){return packCompileError("m12",token,"error","danger")}binary=binary.substring(0,binary.length-(architecture.instructions[i].fields[a].startbit+1))+reg.toString(2).padStart(fieldsLength,"0")+binary.substring(binary.length-architecture.instructions[i].fields[a].stopbit,binary.length);re=RegExp("Field[0-9]+");instruction=instruction.replace(re,token)}else if(z==architecture_hash.length-1&&w==architecture.components[z].elements.length-1&&validReg==false){return packCompileError("m4",token,"error","danger")}if(architecture.components[z].type=="control"){regNum++}}}}}break;case"inm-signed":token=instructionParts[j];var token_user="";console_log("token: "+token);for(var a=0;a<architecture.instructions[i].fields.length;a++){if(architecture.instructions[i].fields[a].name==signatureRawParts[j]){fieldsLength=getFieldLength(architecture.instructions[i].separated,architecture.instructions[i].fields[a].startbit,architecture.instructions[i].fields[a].stopbit,a);var inm;if(token.match(/^0x/)){var value=token.split("x");if(value[1].length*4>fieldsLength){resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseInt(token,16))==true){return packCompileError("m6",token,"error","danger")}inm=parseInt(token,16).toString(2)}else if(token.match(/^(\d)+\.(\d)+/)){if(float2bin(parseFloat(token)).length>fieldsLength){resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseFloat(token))==true){return packCompileError("m6",token,"error","danger")}inm=float2bin(parseFloat(token,16))}else if(token.match(/^\'(.*?)\'$/)){var re=/^\'(.*?)\'$/;console_log(re);var match=re.exec(token);console_log(match);var asciiCode=match[1].charCodeAt(0);console_log(asciiCode);re=RegExp("Field[0-9]+");instruction=instruction.replace(re,asciiCode);inm=(asciiCode>>>0).toString(2)}else if(isNaN(parseInt(token))){validTagPC=false;startBit=architecture.instructions[i].fields[a].startbit;stopBit=architecture.instructions[i].fields[a].stopbit}else{var comNumPos=Math.pow(2,fieldsLength-1);var comNumNeg=comNumPos*-1;comNumPos=comNumPos-1;console_log(comNumPos);console_log(comNumNeg);if(parseInt(token,10)>comNumPos||parseInt(token,10)<comNumNeg){console_log(oriInstruction);console_log(label);console_log(line);resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseInt(token))==true&&resultPseudo==-3){return packCompileError("m6",token,"error","danger")}inm=(parseInt(token,10)>>>0).toString(2);inm=inm.substring(inm.length-fieldsLength,inm.length)}if(validTagPC==true){console_log(inm.length);if(inm.length>architecture.instructions[i].fields[a].startbit-architecture.instructions[i].fields[a].stopbit+1){return packCompileError("m12",token,"error","danger")}binary=generateBinary(architecture.instructions[i].separated,architecture.instructions[i].fields[a].startbit,architecture.instructions[i].fields[a].stopbit,binary,inm,fieldsLength,a)}re=RegExp("Field[0-9]+");instruction=instruction.replace(re,token)}}break;case"inm-unsigned":token=instructionParts[j];var token_user="";console_log("token: "+token);for(var a=0;a<architecture.instructions[i].fields.length;a++){if(architecture.instructions[i].fields[a].name==signatureRawParts[j]){if(!architecture.instructions[i].separated||!architecture.instructions[i].separated[a])fieldsLength=architecture.instructions[i].fields[a].startbit-architecture.instructions[i].fields[a].stopbit+1;else{fieldsLength=architecture.instructions[i].fields[a].startbit.map(((b,iii)=>b-architecture.instructions[i].fields[a].stopbit[iii]+1)).reduce(((old,newV)=>old+newV))}fieldsLength=getFieldLength(architecture.instructions[i].separated,architecture.instructions[i].fields[a].startbit,architecture.instructions[i].fields[a].stopbit,a);var inm;if(token.match(/^0x/)){var value=token.split("x");if(value[1].length*4>fieldsLength){resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseInt(token,16))==true){return packCompileError("m6",token,"error","danger")}inm=parseInt(token,16).toString(2)}else if(token.match(/^(\d)+\.(\d)+/)){if(float2bin(parseFloat(token)).length>fieldsLength){resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseFloat(token))==true){return packCompileError("m6",token,"error","danger")}inm=float2bin(parseFloat(token,16))}else if(token.match(/^\'(.*?)\'$/)){var re=/^\'(.*?)\'$/;console_log(re);var match=re.exec(token);console_log(match);var asciiCode=match[1].charCodeAt(0);console_log(asciiCode);re=RegExp("Field[0-9]+");instruction=instruction.replace(re,asciiCode);inm=(asciiCode>>>0).toString(2)}else if(isNaN(parseInt(token))){validTagPC=false;startBit=architecture.instructions[i].fields[a].startbit;stopBit=architecture.instructions[i].fields[a].stopbit}else{var comNumPos=Math.pow(2,fieldsLength);console_log(comNumPos);if(parseInt(token,10)>comNumPos){console_log(oriInstruction);console_log(label);console_log(line);resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseInt(token))==true&&resultPseudo==-3){return packCompileError("m6",token,"error","danger")}inm=(parseInt(token,10)>>>0).toString(2);inm=inm.substring(inm.length-fieldsLength,inm.length)}if(validTagPC==true){console_log(inm.length);if(inm.length>architecture.instructions[i].fields[a].startbit-architecture.instructions[i].fields[a].stopbit+1){return packCompileError("m12",token,"error","danger")}binary=generateBinary(architecture.instructions[i].separated,architecture.instructions[i].fields[a].startbit,architecture.instructions[i].fields[a].stopbit,binary,inm,fieldsLength,a)}re=RegExp("Field[0-9]+");instruction=instruction.replace(re,token)}}break;case"address":token=instructionParts[j];console_log("token: "+token);for(var a=0;a<architecture.instructions[i].fields.length;a++){if(architecture.instructions[i].fields[a].name==signatureRawParts[j]){fieldsLength=getFieldLength(architecture.instructions[i].separated,architecture.instructions[i].fields[a].startbit,architecture.instructions[i].fields[a].stopbit,a);if(token.match(/^0x/)){var value=token.split("x");if(value[1].length*4>fieldsLength){return packCompileError("m8",token,"error","danger")}if(isNaN(parseInt(token,16))==true){return packCompileError("m9",token,"error","danger")}addr=parseInt(token,16).toString(2);binary=generateBinary(architecture.instructions[i].separated,architecture.instructions[i].fields[a].startbit,architecture.instructions[i].fields[a].stopbit,binary,inm,fieldsLength,a);re=RegExp("Field[0-9]+");instruction=instruction.replace(re,token)}else{var validTag=false;startBit=architecture.instructions[i].fields[a].startbit;stopBit=architecture.instructions[i].fields[a].stopbit}}}break;case"offset_bytes":token=instructionParts[j];var token_user="";console_log("token: "+token);for(var a=0;a<architecture.instructions[i].fields.length;a++){if(architecture.instructions[i].fields[a].name==signatureRawParts[j]){fieldsLength=getFieldLength(architecture.instructions[i].separated,architecture.instructions[i].fields[a].startbit,architecture.instructions[i].fields[a].stopbit,a);var inm;if(token.match(/^0x/)){var value=token.split("x");if(value[1].length*4>fieldsLength){resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseInt(token,16))==true){return packCompileError("m6",token,"error","danger")}inm=parseInt(token,16).toString(2)}else if(token.match(/^(\d)+\.(\d)+/)){if(float2bin(parseFloat(token)).length>fieldsLength){resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseFloat(token))==true){return packCompileError("m6",token,"error","danger")}inm=float2bin(parseFloat(token,16))}else if(isNaN(parseInt(token))){validTagPC=false;startBit=architecture.instructions[i].fields[a].startbit;stopBit=architecture.instructions[i].fields[a].stopbit}else{var comNumPos=Math.pow(2,fieldsLength-1);var comNumNeg=comNumPos*-1;comNumPos=comNumPos-1;console_log(comNumPos);console_log(comNumNeg);if(parseInt(token,10)>comNumPos||parseInt(token,10)<comNumNeg){console_log(oriInstruction);console_log(label);console_log(line);resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseInt(token))==true&&resultPseudo==-3){return packCompileError("m6",token,"error","danger")}inm=(parseInt(token,10)>>>0).toString(2);inm=inm.substring(inm.length-fieldsLength,inm.length)}if(validTagPC==true){if(inm.length>architecture.instructions[i].fields[a].startbit-architecture.instructions[i].fields[a].stopbit+1){return packCompileError("m12",token,"error","danger")}binary=generateBinary(architecture.instructions[i].separated,architecture.instructions[i].fields[a].startbit,architecture.instructions[i].fields[a].stopbit,binary,inm,fieldsLength,a)}re=RegExp("Field[0-9]+");console_log(instruction);instruction=instruction.replace(re,token);console_log(instruction)}}break;case"offset_words":token=instructionParts[j];var token_user="";console_log("token: "+token);for(var a=0;a<architecture.instructions[i].fields.length;a++){if(architecture.instructions[i].fields[a].name==signatureRawParts[j]){fieldsLength=getFieldLength(architecture.instructions[i].separated,architecture.instructions[i].fields[a].startbit,architecture.instructions[i].fields[a].stopbit,a);var inm;if(token.match(/^0x/)){var value=token.split("x");if(value[1].length*4>fieldsLength){resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseInt(token,16))==true){return packCompileError("m6",token,"error","danger")}inm=parseInt(token,16).toString(2)}else if(token.match(/^(\d)+\.(\d)+/)){if(float2bin(parseFloat(token)).length>fieldsLength){resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseFloat(token))==true){return packCompileError("m6",token,"error","danger")}inm=float2bin(parseFloat(token,16))}else if(isNaN(parseInt(token))){validTagPC=false;startBit=architecture.instructions[i].fields[a].startbit;stopBit=architecture.instructions[i].fields[a].stopbit}else{var comNumPos=Math.pow(2,fieldsLength-1);var comNumNeg=comNumPos*-1;comNumPos=comNumPos-1;console_log(comNumPos);console_log(comNumNeg);if(parseInt(token,10)>comNumPos||parseInt(token,10)<comNumNeg){console_log(oriInstruction);console_log(label);console_log(line);resultPseudo=pseudoinstruction_compiler(oriInstruction,label,line);console_log(resultPseudo);if(resultPseudo.status!="ok"){return resultPseudo}}if(isNaN(parseInt(token))==true&&resultPseudo==-3){return packCompileError("m6",token,"error","danger")}inm=(parseInt(token,10)>>>0).toString(2);inm=inm.substring(inm.length-fieldsLength,inm.length)}if(validTagPC==true){if(inm.length>architecture.instructions[i].fields[a].startbit-architecture.instructions[i].fields[a].stopbit+1){return packCompileError("m12",token,"error","danger")}binary=generateBinary(architecture.instructions[i].separated,architecture.instructions[i].fields[a].startbit,architecture.instructions[i].fields[a].stopbit,binary,inm,fieldsLength,a)}re=RegExp("Field[0-9]+");console_log(instruction);instruction=instruction.replace(re,token);console_log(instruction)}}break;default:token=instructionParts[j];console_log("token: "+token);for(var a=0;a<architecture.instructions[i].fields.length;a++){console_log(architecture.instructions[i].fields[a].name);if(architecture.instructions[i].fields[a].name==signatureRawParts[j]){if(typeof architecture.instructions[i].fields[a].startbit=="object"){fieldsLength=architecture.instructions[i].fields[a].startbit.reduce(((t,cv,ind)=>{t=!ind?0:t;t+(cv-architecture.instructions[i].fields[a].stopbit[ind]+1)}));console_log(architecture.instructions[i].co.join("").padStart(fieldsLength,"0"))}else{fieldsLength=architecture.instructions[i].fields[a].startbit-architecture.instructions[i].fields[a].stopbit+1;console_log(architecture.instructions[i].co.padStart(fieldsLength,"0"));binary=binary.substring(0,binary.length-(architecture.instructions[i].fields[a].startbit+1))+architecture.instructions[i].co.padStart(fieldsLength,"0")+binary.substring(binary.length-architecture.instructions[i].fields[a].stopbit,binary.length)}console_log(binary);re=RegExp("Field[0-9]+");console_log(instruction);instruction=instruction.replace(re,token);console_log(instruction)}if(architecture.instructions[i].fields[a].type=="cop"){fieldsLength=architecture.instructions[i].fields[a].startbit-architecture.instructions[i].fields[a].stopbit+1;binary=binary.substring(0,binary.length-(architecture.instructions[i].fields[a].startbit+1))+architecture.instructions[i].fields[a].valueField.padStart(fieldsLength,"0")+binary.substring(binary.length-architecture.instructions[i].fields[a].stopbit,binary.length)}}break}}if(validTagPC==false&&resultPseudo==-3){console_log("pendiente");pc=pc+architecture.instructions[i].nwords*4;var padding="";padding=padding.padStart(architecture.instructions[i].nwords*32-binary.length,"0");binary=binary+padding;var hex=bin2hex(binary);var auxAddr=address;console_log(binary);console_log(bin2hex(binary));pending_instructions.push({address:address,instruction:instruction,signature:signatureParts,signatureRaw:signatureRawParts,Label:label,binary:binary,startBit:startBit,stopBit:stopBit,visible:true,line:nEnters});if(pending==false){instructions.push({Break:null,Address:"0x"+address.toString(16),Label:label,loaded:instruction,user:userInstruction,_rowVariant:"",visible:true,hide:false});instructions_binary.push({Break:null,Address:"0x"+address.toString(16),Label:label,loaded:binary,user:null,_rowVariant:"",visible:false});address=address+4*architecture.instructions[i].nwords}else{for(var pos=0;pos<instructions.length;pos++){if(parseInt(instructions[pos].Address,16)>pendingAddress){instructions.splice(pos,0,{Break:null,Address:"0x"+pendingAddress.toString(16),Label:label,loaded:instruction,user:userInstruction,_rowVariant:"",visible:true,hide:false});instructions_binary.splice(pos,0,{Break:null,Address:"0x"+pendingAddress.toString(16),Label:label,loaded:binary,user:null,_rowVariant:"",visible:false});auxAddr=pendingAddress;break}}}console_log(address.toString(16));console_log(instructions);stopFor=true;break}else{if(resultPseudo==-3){console_log("no pendiente");pc=pc+architecture.instructions[i].nwords*4;var padding="";padding=padding.padStart(architecture.instructions[i].nwords*32-binary.length,"0");binary=binary+padding;var hex=bin2hex(binary);var auxAddr=address;console_log(binary);console_log(bin2hex(binary));if(pending==false){instructions.push({Break:null,Address:"0x"+address.toString(16),Label:label,loaded:instruction,user:userInstruction,_rowVariant:"",visible:true,hide:false});instructions_binary.push({Break:null,Address:"0x"+address.toString(16),Label:label,loaded:binary,user:null,_rowVariant:"",visible:false});address=address+4*architecture.instructions[i].nwords}else{for(var pos=0;pos<instructions.length;pos++){if(parseInt(instructions[pos].Address,16)>pendingAddress){instructions.splice(pos,0,{Break:null,Address:"0x"+pendingAddress.toString(16),Label:label,loaded:instruction,user:userInstruction,_rowVariant:"",visible:true,hide:false});instructions_binary.splice(pos,0,{Break:null,Address:"0x"+pendingAddress.toString(16),Label:label,loaded:binary,user:null,_rowVariant:"",visible:false});auxAddr=pendingAddress;break}}}stopFor=true;console_log(address.toString(16));console_log(instructions)}}}}return ret}function pseudoinstruction_compiler(instruction,label,line){var ret={errorcode:"",token:"",type:"",update:"",status:"ok"};var re=/\' \'/;instruction=instruction.replace(re,"'\0'");var re=/\'\\n\'/;instruction=instruction.replace(re,"10");console_log(instruction);var re=/\'\\t\'/;instruction=instruction.replace(re,"9");console_log(instruction);var instructionParts=instruction.split(" ");var found=false;var re=/\'\0\'/;instruction=instruction.replace(re,"' '");console_log(instruction);for(var i=0;i<instructionParts.length;i++){instructionParts[i]=instructionParts[i].replace(re,"' '")}console_log(instructionParts);var auxSignature;for(var i=0;i<architecture.pseudoinstructions.length;i++){console_log(architecture.pseudoinstructions[i].name);if(architecture.pseudoinstructions[i].name!=instructionParts[0]){continue}else{found=true;var signatureDef=architecture.pseudoinstructions[i].signature_definition;signatureDef=signatureDef.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");re=new RegExp("[fF][0-9]+","g");signatureDef=signatureDef.replace(re,"(.*?)");var signatureParts=architecture.pseudoinstructions[i].signature.split(",");var signatureRawParts=architecture.pseudoinstructions[i].signatureRaw.split(" ");var definition=architecture.pseudoinstructions[i].definition;auxSignature=architecture.pseudoinstructions[i].signatureRaw;console_log(signatureDef);console_log(instruction);console_log(instructionParts);if(instructionParts.length<architecture.pseudoinstructions[i].fields.length+1){for(var j=0;j<architecture.pseudoinstructions[i].fields.length+1-instructionParts.length;j++){next_token();token=get_token();console_log("token: "+token);if(token!=null){var re=new RegExp(",+$");token=token.replace(re,"")}instruction=instruction+" "+token}instructionParts=instruction.split(" ")}console_log(instruction);re=new RegExp(signatureDef+"$");console_log(re);if(instruction.search(re)==-1&&i==architecture.pseudoinstructions.length-1){return packCompileError("m3",auxSignature,"error","danger")}if(instruction.search(re)==-1&&i<architecture.pseudoinstructions.length-1){found=false}if(found==true){re=/aliasDouble\((.*)\)/;for(var a=0;a<architecture.pseudoinstructions[i].fields.length&&definition.search(re)!=-1;a++){re=new RegExp(architecture.pseudoinstructions[i].fields[a].name,"g");console_log(instructionParts[a+1]);instructionParts[a+1]=instructionParts[a+1].replace("$","");definition=definition.replace(re,instructionParts[a+1])}re=/aliasDouble\((.*)\)/;console_log(re);while(definition.search(re)!=-1){var match=re.exec(definition);var args=match[1].split(";");var aux="";for(var b=0;b<architecture.components[3].elements.length;b++){console_log(architecture.components[3].elements[b].name);if(architecture.components[3].elements[b].name.includes(args[0])!=false){aux=architecture.components[3].elements[b].simple_reg[args[1]];console_log(aux);break}}console_log(aux);definition=definition.replace(re,aux);console_log(definition)}for(var j=1;j<signatureRawParts.length;j++){var aux=signatureRawParts[j].replace(/[.*+?^${}()|[\]\\]/g,"\\$&");re=new RegExp(aux,"g");definition=definition.replace(re,instructionParts[j])}re=new RegExp("\n","g");definition=definition.replace(re,"");console_log(definition);console_log(signatureParts);re=/Field.(\d).\((.*?)\).(.*?)[=<>;\s]/;while(definition.search(re)!=-1){var match=re.exec(definition);console_log(match);var code;if(instructionParts[match[1]].match(/^\'(.*?)\'$/)){var re=/^\'(.*?)\'$/;console_log(re);var match2=re.exec(instructionParts[match[1]]);console_log(match2);var asciiCode=match2[1].charCodeAt(0);console_log(asciiCode);console_log("value = field('"+asciiCode+"', '("+match[2]+")', '"+match[3]+"')");code="value = field('"+asciiCode+"', '("+match[2]+")', '"+match[3]+"')"}else{console_log("value = field('"+instructionParts[match[1]]+"', '("+match[2]+")', '"+match[3]+"')");code="value = field('"+instructionParts[match[1]]+"', '("+match[2]+")', '"+match[3]+"')"}var value;try{eval(code)}catch(e){if(e instanceof SyntaxError){return packCompileError("m5",token,"error","danger")}}if(value==-1){return packCompileError("m5",token,"error","danger")}definition=definition.replace("Field."+match[1]+".("+match[2]+")."+match[3],value);re=/Field.(\d).\((.*?)\).(.*?)[;\s]/}re=/Field.(\d).SIZE[=<>;\s]/g;if(definition.search(re)!=-1){var match=re.exec(definition);console_log(match);var code;if(instructionParts[match[1]].match(/^\'(.*?)\'$/)){var re=/^\'(.*?)\'$/;console_log(re);var match2=re.exec(instructionParts[match[1]]);console_log(match2);var asciiCode=match2[1].charCodeAt(0);console_log(asciiCode);console_log("value = field('"+asciiCode+"', 'SIZE', null)");code="value = field('"+asciiCode+"', 'SIZE', null)"}else{console_log("value = field('"+instructionParts[match[1]]+"', 'SIZE', null)");code="value = field('"+instructionParts[match[1]]+"', 'SIZE', null)"}var value;try{eval(code)}catch(e){if(e instanceof SyntaxError){return packCompileError("m5",token,"error","danger")}}if(value==-1){return packCompileError("m5",token,"error","danger")}console_log(value);console_log("Field."+match[1]+".SIZE");definition=definition.replace("Field."+match[1]+".SIZE",value)}console_log(definition);re=/reg\.pc/;console_log(re);while(definition.search(re)!=-1){definition=definition.replace(re,"pc");console_log(definition)}re=/no_ret_op\{([^}]*)\};/;console_log(re);while(definition.search(re)!=-1){var match=re.exec(definition);console_log(match[1]);eval(match[1]);definition=definition.replace(re,"");console_log(definition)}re=/op\{([^}]*)\}/;console_log(re);while(definition.search(re)!=-1){var match=re.exec(definition);var result;console_log(match[1]);eval("result="+match[1]);definition=definition.replace(re,result);console_log(definition)}while(definition.match(/\'(.*?)\'/)){var re=/\'(.*?)\'/;console_log(re);var match2=re.exec(instructionParts[match[1]]);console_log(match2);var asciiCode=match2[1].charCodeAt(0);console_log(asciiCode);definition=definition.replace(re,asciiCode)}console_log(definition);console_log(instruction);var re=new RegExp("'","g");instruction=instruction.replace(re,'"');console_log(instruction);var re=/{([^}]*)}/g;var code=re.exec(definition);if(code!=null){while(code!=null){var instructions=code[1].split(";");console_log(instructions);for(var j=0;j<instructions.length-1;j++){var aux;if(j==0){aux="ret=instruction_compiler('"+instructions[j]+"','"+instruction+"','"+label+"',"+line+", false, 0, null, null, true)\nif(ret.status != 'ok'){error = true}"}else{aux="ret=instruction_compiler('"+instructions[j]+"','', '',"+line+", false, 0, null, null, true)\nif(ret.status != 'ok'){error = true}"}definition=definition.replace(instructions[j]+";",aux+";\n")}code=re.exec(definition)}}else{var instructions=definition.split(";");for(var j=0;j<instructions.length-1;j++){var aux;if(j==0){aux="ret=instruction_compiler('"+instructions[j]+"','"+instruction+"','"+label+"',"+line+", false, 0, null, null, true)\nif(ret.status != 'ok'){error = true}"}else{aux="ret=instruction_compiler('"+instructions[j]+"','', '',"+line+", false, 0, null, null, true)\nif(ret.status != 'ok'){error = true}"}definition=definition.replace(instructions[j]+";",aux+";\n")}}try{var error=false;console_log(definition);eval(definition);if(error==true){console_log("Error pseudo");return ret}console_log("Fin pseudo");return ret}catch(e){if(e instanceof SyntaxError){return packCompileError("m13","","error","danger")}}}}}if(!found){return packCompileError("m3",auxSignature,"error","danger")}return ret}function field(field,action,type){console_log(field);console_log(action);console_log(type);if(action=="SIZE"){console_log("SIZE");if(field.match(/^0x/)){var value=field.split("x");return value[1].length*4}else if(field.match(/^([\-\d])+\.(\d)+/)){return float2bin(parseFloat(field)).length}else if(field.match(/^([\-\d])+/)){var numAux=parseInt(field,10);return bi_intToBigInt(numAux,10).toString(2).length}else{var ret=creator_memory_findbytag(field);if(ret.exit==1){var numAux=ret.value;return numAux.toString(2).length}}}re=/\((.*?)\)/;if(action.search(re)!=-1){var match=re.exec(action);var bits=match[1].split(",");var startBit=parseInt(bits[0]);var endBit=parseInt(bits[1]);if(field.match(/^0x/)&&(type=="int"||type=="float")){var binNum=parseInt(field,16).toString(2);binNum=binNum.padStart(32,"0");binNum=binNum.substring(31-startBit,32-endBit);var hexNum="0x"+bin2hex(binNum);return hexNum}else if(field.match(/^0x/)&&type=="double"){var binNum=double2bin(hex2double(field));binNum=binNum.padStart(64,"0");binNum=binNum.substring(63-startBit,64-endBit);var hexNum="0x"+bin2hex(binNum);return hexNum}if(Number.isInteger(field)==false){var ret=creator_memory_findbytag(field);if(ret.exit==1){field=ret.value}}if(type=="int"){var binNum=(parseInt(field,10)>>>0).toString(2);binNum=binNum.padStart(32,"0");binNum=binNum.substring(31-startBit,32-endBit);var hexNum="0x"+bin2hex(binNum);return hexNum}else if(type=="float"){var binNum=float2bin(parseFloat(field));console_log(binNum);binNum=binNum.padStart(32,"0");binNum=binNum.substring(31-startBit,32-endBit);var hexNum="0x"+bin2hex(binNum);return hexNum}else if(type=="double"){var binNum=double2bin(parseFloat(field));console_log(binNum);binNum=binNum.padStart(64,"0");binNum=binNum.substring(63-startBit,64-endBit);var hexNum="0x"+bin2hex(binNum);return hexNum}}return-1}function getFieldLength(separated,startbit,stopbit,a){if(startbit==stopbit)console_log("Warning: startbit equal to stopBit, please check the achitecture definitions");let fieldsLength;if(!separated||!separated[a])fieldsLength=startbit-stopbit+1;else fieldsLength=startbit.map(((b,i)=>b-stopbit[i]+1)).reduce(((old,newV)=>old+newV));return fieldsLength}function generateBinary(separated,startbit,stopbit,binary,inm,fieldsLenght,a){if(!separated||!separated[a])binary=binary.substring(0,binary.length-(startbit+1))+inm.padStart(fieldsLength,"0")+binary.substring(binary.length-stopbit,binary.length);else{let myInm=inm;for(let i=startbit.length-1;i>=0;i--){let sb=startbit[i],stb=stopbit[i],diff=sb-stb+1;if(myInm.length<=diff){binary=binary.substring(0,binary.length-(sb+1))+myInm.padStart(diff,"0")+binary.substring(binary.length-stb,binary.length);break}else{let tmpinm=inm.substring(myInm.length-diff,myInm.length);binary=binary.substring(0,binary.length-(sb+1))+tmpinm.padStart(diff,"0")+binary.substring(binary.length-stb,binary.length);myInm=myInm.substring(0,myInm.length-diff)}}}return binary}function binaryStringToInt(b){return parseInt(b,2)}function packExecute(error,err_msg,err_type,draw){var ret={};ret.error=error;ret.msg=err_msg;ret.type=err_type;ret.draw=draw;return ret}function executeInstruction(){var draw={space:[],info:[],success:[],danger:[],flash:[]};console_log(mutexRead);newExecution=false;do{console_log(executionIndex);console_log(architecture.components[0].elements[0].value);if(instructions.length==0){return packExecute(true,"No instructions in memory","danger",null)}if(executionIndex<-1){return packExecute(true,"The program has finished","danger",null)}if(executionIndex==-1){return packExecute(true,"The program has finished with errors","danger",null)}else if(mutexRead==true){return packExecute(false,"","info",null)}if(executionInit==1){for(var i=0;i<instructions.length;i++){if(instructions[i].Label=="main"){architecture.components[0].elements[0].value=bi_intToBigInt(instructions[i].Address,10);executionInit=0;break}else if(i==instructions.length-1){executionIndex=-1;return packExecute(true,'Label "main" not found',"danger",null)}}}var error=0;var index;for(var i=0;i<instructions.length;i++){if(parseInt(instructions[i].Address,16)==architecture.components[0].elements[0].value){executionIndex=i;console_log(instructions[executionIndex].hide);console_log(executionIndex);console_log(instructions[i].Address);if(instructions[executionIndex].hide==false){draw.info.push(executionIndex)}}else{if(instructions[executionIndex].hide==false){draw.space.push(i)}}}var instructionExec=instructions[executionIndex].loaded;var instructionExecParts=instructionExec.split(" ");var signatureDef;var signatureParts;var signatureRawParts;var binary;var auxIndex;var nwords;var auxDef;var type;for(var i=0;i<architecture.instructions.length;i++){var auxSig=architecture.instructions[i].signatureRaw.split(" ");var coStartbit;var coStopbit;var numCop=0;var numCopCorrect=0;for(var y=0;y<architecture.instructions[i].fields.length;y++){if(architecture.instructions[i].fields[y].type=="co"){coStartbit=31-parseInt(architecture.instructions[i].fields[y].startbit);coStopbit=32-parseInt(architecture.instructions[i].fields[y].stopbit)}}if(architecture.instructions[i].co==instructionExecParts[0].substring(coStartbit,coStopbit)){if(architecture.instructions[i].cop!=null&&architecture.instructions[i].cop!=""){for(var j=0;j<architecture.instructions[i].fields.length;j++){if(architecture.instructions[i].fields[j].type=="cop"){numCop++;if(architecture.instructions[i].fields[j].valueField==instructionExecParts[0].substring(architecture.instructions[i].nwords*31-architecture.instructions[i].fields[j].startbit,architecture.instructions[i].nwords*32-architecture.instructions[i].fields[j].stopbit)){numCopCorrect++}}}if(numCop==numCopCorrect){auxDef=architecture.instructions[i].definition;nwords=architecture.instructions[i].nwords;binary=true;auxIndex=i;break}}else{auxDef=architecture.instructions[i].definition;nwords=architecture.instructions[i].nwords;binary=true;type=architecture.instructions[i].type;auxIndex=i;break}}if(architecture.instructions[i].name==instructionExecParts[0]&&instructionExecParts.length==auxSig.length){type=architecture.instructions[i].type;signatureDef=architecture.instructions[i].signature_definition;signatureDef=signatureDef.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");re=new RegExp("[fF][0-9]+","g");signatureDef=signatureDef.replace(re,"(.*?)");re=new RegExp(",","g");var signature=architecture.instructions[i].signature.replace(re," ");re=new RegExp(signatureDef+"$");var match=re.exec(signature);var signatureParts=[];for(var j=1;j<match.length;j++){signatureParts.push(match[j])}match=re.exec(architecture.instructions[i].signatureRaw);var signatureRawParts=[];for(var j=1;j<match.length;j++){signatureRawParts.push(match[j])}console_log(signatureParts);console_log(signatureRawParts);auxDef=architecture.instructions[i].definition;nwords=architecture.instructions[i].nwords;binary=false;break}}architecture.components[0].elements[0].value=architecture.components[0].elements[0].value+bi_intToBigInt(nwords*4,10);console_log(auxDef);if(typeof instructions[executionIndex].preload==="undefined"){var readings_description="";var writings_description="";if(binary==true){auxDef=execute_binary(auxIndex,instructionExecParts,auxDef)}else{re=new RegExp(signatureDef+"$");var match=re.exec(instructionExec);instructionExecParts=[];for(var j=1;j<match.length;j++){instructionExecParts.push(match[j])}console_log(instructionExecParts);var var_readings_definitions={};var var_readings_definitions_prev={};var var_readings_definitions_name={};var var_writings_definitions={};for(var i=1;i<signatureRawParts.length;i++){if(signatureParts[i]=="INT-Reg"||signatureParts[i]=="SFP-Reg"||signatureParts[i]=="DFP-Reg"||signatureParts[i]=="Ctrl-Reg"){for(var j=0;j<architecture.components.length;j++){for(var z=architecture.components[j].elements.length-1;z>=0;z--){if(architecture.components[j].elements[z].name.includes(instructionExecParts[i])){var_readings_definitions[signatureRawParts[i]]="var "+signatureRawParts[i]+"      = readRegister ("+j+" ,"+z+");\n";var_readings_definitions_prev[signatureRawParts[i]]="var "+signatureRawParts[i]+"_prev = readRegister ("+j+" ,"+z+");\n";var_readings_definitions_name[signatureRawParts[i]]="var "+signatureRawParts[i]+"_name = '"+instructionExecParts[i]+"';\n";re=new RegExp("(?:\\W|^)((("+signatureRawParts[i]+") *=)[^=])","g");if(auxDef.search(re)!=-1){var_writings_definitions[signatureRawParts[i]]="writeRegister("+signatureRawParts[i]+", "+j+", "+z+");\n"}else{var_writings_definitions[signatureRawParts[i]]="if("+signatureRawParts[i]+" != "+signatureRawParts[i]+"_prev)"+" { writeRegister("+signatureRawParts[i]+" ,"+j+" ,"+z+"); }\n"}}}}}else{var_readings_definitions[signatureRawParts[i]]="var "+signatureRawParts[i]+" = "+instructionExecParts[i]+";\n"}}for(var elto in var_readings_definitions){readings_description=readings_description+var_readings_definitions[elto]}for(var elto in var_readings_definitions_prev){readings_description=readings_description+var_readings_definitions_prev[elto]}for(var elto in var_readings_definitions_name){readings_description=readings_description+var_readings_definitions_name[elto]}for(var elto in var_writings_definitions){writings_description=writings_description+var_writings_definitions[elto]}}for(var i=0;i<architecture.components.length;i++){for(var j=architecture.components[i].elements.length-1;j>=0;j--){var clean_name=clean_string(architecture.components[i].elements[j].name[0],"reg_");var clean_aliases=architecture.components[i].elements[j].name.map((x=>clean_string(x,"reg_"))).join("|");re=new RegExp("(?:\\W|^)((("+clean_aliases+") *=)[^=])","g");if(auxDef.search(re)!=-1){writings_description=writings_description+"\nwriteRegister("+clean_name+", "+i+", "+j+");"}re=new RegExp("([^a-zA-Z0-9])(?:"+clean_aliases+")");if(auxDef.search(re)!=-1){readings_description=readings_description+"var "+clean_name+"      = readRegister("+i+" ,"+j+");\n";readings_description=readings_description+"var "+clean_name+"_name = '"+clean_name+"';\n"}}}auxDef="\n/* Read all instruction fields */\n"+readings_description+"\n/* Original instruction definition */\n"+auxDef+"\n\n/* Modify values */\n"+writings_description;console_log(" ................................. "+"instructions["+executionIndex+"]:\n"+auxDef+"\n"+" ................................. ");eval("instructions["+executionIndex+"].preload = function(elto) { "+"   try {\n"+auxDef.replace(/this./g,"elto.")+"\n"+"   }\n"+"   catch(e){\n"+"     throw e;\n"+"   }\n"+"}; ")}try{var result=instructions[executionIndex].preload(this);if(typeof result!="undefined"&&result.error){return result}}catch(e){var msg="";if(e instanceof SyntaxError)msg="The definition of the instruction contains errors, please review it";else msg='Exception on executing instruction "'+executionIndex+'": '+e+"\n"+" Stack trace: "+e.stack+"\n";console_log("Error: "+e);error=1;draw.danger.push(executionIndex);executionIndex=-1;return packExecute(true,msg,"danger",null)}stats_update(type);if(executionIndex==-1){error=1;return packExecute(false,"","info",null)}if(error!=1&&executionIndex<instructions.length){for(var i=0;i<instructions.length;i++){if(parseInt(instructions[i].Address,16)==architecture.components[0].elements[0].value){executionIndex=i;draw.success.push(executionIndex);break}else if(i==instructions.length-1&&mutexRead==true){executionIndex=instructions.length+1}else if(i==instructions.length-1){draw.space.push(executionIndex);executionIndex=instructions.length+1}}}if(executionIndex>=instructions.length&&mutexRead==true){for(var i=0;i<instructions.length;i++){draw.space.push(i)}draw.info=[];return packExecute(false,"The execution of the program has finished","success",draw)}else if(executionIndex>=instructions.length&&mutexRead==false){for(var i=0;i<instructions.length;i++){draw.space.push(i)}draw.info=[];executionIndex=-2;return packExecute(false,"The execution of the program has finished","success",draw)}else{if(error!=1){draw.success.push(executionIndex)}}console_log(executionIndex)}while(instructions[executionIndex].hide==true);return packExecute(false,null,null,draw)}function executeProgramOneShot(limit_n_instructions){var ret=null;creator_ga("execute","execute.run");for(var i=0;i<limit_n_instructions;i++){ret=executeInstruction();if(ret.error==true){return ret}if(executionIndex<-1){return ret}}return packExecute(true,'"ERROR:" number of instruction limit reached :-(',null,null)}function creator_executor_exit(){creator_ga("execute","execute.exit");executionIndex=instructions.length+1}function reset(){creator_ga("execute","execute.reset");executionIndex=0;executionInit=1;stats_reset();mutexRead=false;newExecution=true;keyboard="";display="";for(var i=0;i<architecture_hash.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){if(architecture.components[i].double_precision==false){architecture.components[i].elements[j].value=architecture.components[i].elements[j].default_value}else{var aux_value;var aux_sim1;var aux_sim2;for(var a=0;a<architecture_hash.length;a++){for(var b=0;b<architecture.components[a].elements.length;b++){if(architecture.components[a].elements[b].name.includes(architecture.components[i].elements[j].simple_reg[0])!=false){aux_sim1=app.bin2hex(app.float2bin(architecture.components[a].elements[b].default_value))}if(architecture.components[a].elements[b].name.includes(architecture.components[i].elements[j].simple_reg[1])!=false){aux_sim2=app.bin2hex(app.float2bin(architecture.components[a].elements[b].default_value))}}}aux_value=aux_sim1+aux_sim2;architecture.components[i].elements[j].value=app.hex2double("0x"+aux_value)}}}architecture.memory_layout[4].value=backup_stack_address;architecture.memory_layout[3].value=backup_data_address;memory_reset();creator_callstack_reset();track_stack_reset();return true}function crex_show_notification(msg,level){if(typeof window!=="undefined")show_notification(msg,level);else console.log(level.toUpperCase()+": "+msg)}function crex_replace_magic(auxDef){console_log("Before replace: \n"+auxDef+"\n");var index=0;re=/MP.([whbd]).\[(.*?)\] *=/;while(auxDef.search(re)!=-1){index++;var match=re.exec(auxDef);var auxDir;re=/MP.[whbd].\[(.*?)\] *=/;auxDef=auxDef.replace(re,"dir"+index+"=");auxDef="var dir"+index+" = null;\n"+auxDef;auxDef=auxDef+"\n writeMemory(dir"+index+","+match[2]+",'"+match[1]+"');";re=/MP.([whb]).\[(.*?)\] *=/}re=new RegExp("MP.([whbd]).(.*?) *=");while(auxDef.search(re)!=-1){index++;var match=re.exec(auxDef);re=new RegExp("MP."+match[1]+"."+match[2]+" *=");auxDef=auxDef.replace(re,"dir"+index+" =");auxDef="var dir"+index+" = null;\n"+auxDef;auxDef=auxDef+"\n writeMemory(dir"+index+","+match[2]+",'"+match[1]+"');";re=new RegExp("MP.([whbd]).(.*?) *=")}re=/MP.([whbd]).\[(.*?)\]/;while(auxDef.search(re)!=-1){var match=re.exec(auxDef);var auxDir;re=/MP.[whbd].\[(.*?)\]/;auxDef=auxDef.replace(re,"readMemory("+match[2]+", '"+match[1]+"')");re=/MP.([whbd]).\[(.*?)\]/}re=new RegExp("MP.([whbd]).([0-9]*[a-z]*[0-9]*)");while(auxDef.search(re)!=-1){var match=re.exec(auxDef);re=new RegExp("MP."+match[1]+"."+match[2]);auxDef=auxDef.replace(re,"readMemory("+match[2]+",'"+match[1]+"')");re=new RegExp("MP.([whb]).([0-9]*[a-z]*[0-9]*)")}console_log("After replace: \n"+auxDef+"\n");return auxDef}function writeStackLimit(stackLimit){var draw={space:[],info:[],success:[],danger:[],flash:[]};if(stackLimit!=null){if(stackLimit<=architecture.memory_layout[3].value&&stackLimit>=architecture.memory_layout[2].value){draw.danger.push(executionIndex);executionIndex=-1;throw packExecute(true,"Segmentation fault. You tried to read in the data segment","danger",null)}else if(stackLimit<=architecture.memory_layout[1].value&&stackLimit>=architecture.memory_layout[0].value){draw.danger.push(executionIndex);executionIndex=-1;throw packExecute(true,"Segmentation fault. You tried to read in the text segment","danger",null)}else{var diff=memory[memory_hash[2]][0].Address-stackLimit;var auxStackLimit=stackLimit;var newRow=0;for(var i=0;i<diff/4;i++){memory[memory_hash[2]].splice(newRow,0,{Address:auxStackLimit,Binary:[],Value:null,DefValue:null,reset:true});for(var z=0;z<4;z++){memory[memory_hash[2]][newRow].Binary.push({Addr:auxStackLimit,DefBin:"00",Bin:"00",Tag:null});auxStackLimit++}newRow++}track_stack_setsp(stackLimit);architecture.memory_layout[4].value=stackLimit}}}function stats_update(type){for(var i=0;i<stats.length;i++){if(type==stats[i].type){stats[i].number_instructions++;stats_value[i]++;totalStats++;if(typeof app!=="undefined"){app._data.totalStats++}}}for(var i=0;i<stats.length;i++){stats[i].percentage=(stats[i].number_instructions/totalStats*100).toFixed(2)}}function stats_reset(){totalStats=0;if(typeof app!=="undefined"){app._data.totalStats=0}for(var i=0;i<stats.length;i++){stats[i].percentage=0;stats[i].number_instructions=0;stats_value[i]=0}}function display_print(info){if(typeof app!=="undefined")app._data.display+=info;else process.stdout.write(info+"\n");display+=info}function kbd_read_char(keystroke,params){var value=keystroke.charCodeAt(0);writeRegister(value,params.indexComp,params.indexElem);return value}function kbd_read_int(keystroke,params){var value=parseInt(keystroke);writeRegister(value,params.indexComp,params.indexElem);return value}function kbd_read_float(keystroke,params){var value=parseFloat(keystroke,10);writeRegister(value,params.indexComp,params.indexElem);return value}function kbd_read_double(keystroke,params){var value=parseFloat(keystroke,10);writeRegister(value,params.indexComp,params.indexElem);return value}function kbd_read_string(keystroke,params){var value="";var neltos=architecture.components[params.indexComp2].elements[params.indexElem2].value;for(var i=0;i<neltos&&i<keystroke.length;i++){value=value+keystroke.charAt(i)}var addr=architecture.components[params.indexComp].elements[params.indexElem].value;crex_read_string_into_memory(keystroke,value,addr,0);return value}function keyboard_read(fn_post_read,fn_post_params){var draw={space:[],info:[],success:[],danger:[],flash:[]};if(typeof app==="undefined"){var readlineSync=require("readline-sync");var keystroke=readlineSync.question(" > ");var value=fn_post_read(keystroke,fn_post_params);keyboard=keyboard+" "+value;return packExecute(false,"The data has been uploaded","danger",null)}mutexRead=true;app._data.enter=false;console_log(mutexRead);if(newExecution==true){app._data.keyboard="";consoleMutex=false;mutexRead=false;app._data.enter=null;show_notification("The data has been uploaded","info");if(runProgram==false){app.executeProgram()}return}if(consoleMutex==false){setTimeout(keyboard_read,1e3,fn_post_read,fn_post_params);return}fn_post_read(app._data.keyboard,fn_post_params);app._data.keyboard="";consoleMutex=false;mutexRead=false;app._data.enter=null;show_notification("The data has been uploaded","info");console_log(mutexRead);if(executionIndex>=instructions.length){for(var i=0;i<instructions.length;i++){draw.space.push(i)}executionIndex=-2;return packExecute(true,"The execution of the program has finished","success",null)}if(runProgram==false){app.executeProgram()}}function execute_binary(index,instructionExecParts,auxDef){console_log("Binary");for(var j=0;j<architecture.instructions[index].fields.length;j++){console_log(instructionExecParts[0]);console_log(architecture.instructions[index].fields.length);if(architecture.instructions[index].fields[j].type=="INT-Reg"||architecture.instructions[index].fields[j].type=="SFP-Reg"||architecture.instructions[index].fields[j].type=="DFP-Reg"||architecture.instructions[index].fields[j].type=="Ctrl-Reg"){console_log(instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit,architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit));for(var z=0;z<architecture.components.length;z++){console_log(architecture.components[z].type);if(architecture.components[z].type=="control"&&architecture.instructions[index].fields[j].type=="Ctrl-Reg"){for(var w=0;w<architecture.components[z].elements.length;w++){var auxLength=architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit-(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit);console_log(auxLength);console_log(w.toString(2).padStart(auxLength,"0"));if(w.toString(2).padStart(auxLength,"0")==instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit,architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit)){}}}if(architecture.components[z].type=="integer"&&architecture.instructions[index].fields[j].type=="INT-Reg"){for(var w=0;w<architecture.components[z].elements.length;w++){var auxLength=architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit-(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit);console_log(auxLength);console_log(w.toString(2).padStart(auxLength,"0"));if(w.toString(2).padStart(auxLength,"0")==instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit,architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit)){var re=new RegExp(architecture.instructions[index].fields[j].name,"g");auxDef=auxDef.replace(re,architecture.components[z].elements[w].name[0])}}}if(architecture.components[z].type=="floating point"&&architecture.components[z].double_precision==false&&architecture.instructions[index].fields[j].type=="SFP-Reg"){for(var w=0;w<architecture.components[z].elements.length;w++){var auxLength=architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit-(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit);console_log(auxLength);console_log(w.toString(2).padStart(auxLength,"0"));if(w.toString(2).padStart(auxLength,"0")==instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit,architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit)){var re=new RegExp(architecture.instructions[index].fields[j].name,"g");auxDef=auxDef.replace(re,architecture.components[z].elements[w].name[0])}}}if(architecture.components[z].type=="floating point"&&architecture.components[z].double_precision==true&&architecture.instructions[index].fields[j].type=="DFP-Reg"){for(var w=0;w<architecture.components[z].elements.length;w++){var auxLength=architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit-(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit);console_log(auxLength);console_log(w.toString(2).padStart(auxLength,"0"));if(w.toString(2).padStart(auxLength,"0")==instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit,architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit)){var re=new RegExp(architecture.instructions[index].fields[j].name,"g");auxDef=auxDef.replace(re,architecture.components[z].elements[w].name[0])}}}}}if(architecture.instructions[index].fields[j].type=="inm-signed"){var value="";if(architecture.instructions[index].separated&&architecture.instructions[index].separated[j]==true){for(var sep_index=0;sep_index<architecture.instructions[index].fields[j].startbit.length;sep_index++){value=value+instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit[sep_index],architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit[sep_index])}}else{value=instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit,architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit)}var valueSign=value.charAt(0);var newValue=value.padStart(32,valueSign);newValue=parseInt(newValue,2);var re=new RegExp(architecture.instructions[index].fields[j].name,"g");auxDef=auxDef.replace(re,newValue>>0)}if(architecture.instructions[index].fields[j].type=="inm-unsigned"){var value="";if(architecture.instructions[index].separated&&architecture.instructions[index].separated[j]==true){for(var sep_index=0;sep_index<architecture.instructions[index].fields[j].startbit.length;sep_index++){value=value+instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit[sep_index],architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit[sep_index])}}else{value=instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit,architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit)}newValue=parseInt(newValue,2);var re=new RegExp(architecture.instructions[index].fields[j].name,"g");auxDef=auxDef.replace(re,newValue>>0)}if(architecture.instructions[index].fields[j].type=="address"){var value="";if(architecture.instructions[index].separated&&architecture.instructions[index].separated[j]==true){for(var sep_index=0;sep_index<architecture.instructions[index].fields[j].startbit.length;sep_index++){value=value+instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit[sep_index],architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit[sep_index])}}else{value=instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit,architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit)}var re=new RegExp(architecture.instructions[index].fields[j].name,"g");auxDef=auxDef.replace(re,parseInt(value,2))}if(architecture.instructions[index].fields[j].type=="offset_words"){var value="";if(architecture.instructions[index].separated&&architecture.instructions[index].separated[j]==true){for(var sep_index=0;sep_index<architecture.instructions[index].fields[j].startbit.length;sep_index++){value=value+instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit[sep_index],architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit[sep_index])}}else{value=instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit,architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit)}var valueSign=value.charAt(0);var newValue=value.padStart(32,valueSign);newValue=parseInt(newValue,2);var re=new RegExp(architecture.instructions[index].fields[j].name,"g");auxDef=auxDef.replace(re,newValue>>0)}if(architecture.instructions[index].fields[j].type=="offset_bytes"){var value="";if(architecture.instructions[index].separated&&architecture.instructions[index].separated[j]==true){for(var sep_index=0;sep_index<architecture.instructions[index].fields[j].startbit.length;sep_index++){value=value+instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit[sep_index],architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit[sep_index])}}else{value=instructionExecParts[0].substring(architecture.instructions[index].nwords*31-architecture.instructions[index].fields[j].startbit,architecture.instructions[index].nwords*32-architecture.instructions[index].fields[j].stopbit)}var valueSign=value.charAt(0);var newValue=value.padStart(32,valueSign);newValue=parseInt(newValue,2);var re=new RegExp(architecture.instructions[index].fields[j].name,"g");auxDef=auxDef.replace(re,newValue>>0)}}return auxDef}var uielto_loading={template:"\t<div>"+'\t\t<div id="spinnerBack" class="spinnerBack" ref="spinnerBack"></div>'+'\t\t<div id="spinner" class="spinner">'+'\t  \t<div class="spinnerBox">'+'\t    \t<b-spinner variant="primary" class="spinnerIcon"></b-spinner>'+"\t  \t</div>"+"\t  \t<div>"+'\t    \t<span class="text-primary"><strong>Loading...</strong></span>'+"\t  \t</div>"+"\t  </div>"+"\t</div>"};Vue.component("spinner-loading",uielto_loading);var uielto_browser={template:"\t<div>"+'\t  <span class="h6">You are using an unsupported browser, please use one of the following:</span>'+"\t  <br>"+"\t  <b-list-group>"+'\t    <b-list-group-item class="d-flex justify-content-between align-items-center">'+"\t      Google Chrome 70+"+'\t      <b-badge pill class="browserBadge">'+'\t      <b-img src="./images/chrome.png" '+'\t             class="shadow broserIcon" '+'\t             rounded="circle" '+'\t             fluid alt="Responsive image">'+"\t      </b-img>"+"\t      </b-badge>"+"\t    </b-list-group-item>"+'\t    <b-list-group-item class="d-flex justify-content-between align-items-center">'+"\t      Mozilla Firefox 60+"+'\t      <b-badge pill class="browserBadge">'+'\t        <b-img src="./images/firefox.png" '+'\t              class="shadow broserIcon" '+'\t              rounded="circle" '+'\t              fluid alt="Responsive image">'+"\t                "+"\t        </b-img>"+"\t      </b-badge>"+"\t    </b-list-group-item>"+'\t    <b-list-group-item class="d-flex justify-content-between align-items-center">'+"\t      Apple Safari 12+"+'\t      <b-badge pill class="browserBadge">'+'\t        <b-img src="./images/safari.png" '+'\t              class="shadow broserIcon" '+'\t              rounded="circle" '+'\t              fluid alt="Responsive image">'+"\t        </b-img>"+"\t      </b-badge>"+"\t    </b-list-group-item>"+"\t  </b-list-group>"+"\t</div>"};Vue.component("supported-browser",uielto_browser);var uielto_navbar={props:{version:{type:String,required:true},architecture_name:{type:String,required:true}},template:'\t<b-navbar toggleable="sm" class="header my-0 mx-1 py-0 px-2">'+'\t  <b-navbar-brand class="p-0 m-0" href=".">'+'\t      <div class="container">'+'\t        <div class="row">'+'\t          <div class="headerText col-auto my-0 py-0 pr-1 text-uppercase">'+'\t\t\t\t      <h1>Creator <b-badge pill variant="secondary">{{version}}</b-badge></h1>'+"\t\t\t      </div>"+'\t          <div class="headerText col-auto my-0 p-0 ml-2">{{architecture_name}}</div>'+'\t          <div class="w-100"></div>'+'\t          <div class="headerName col-auto my-0 py-0 font-weight-bold mx-1">'+"\t            didaCtic and geneRic assEmbly progrAmming simulaTOR"+"\t          </div>"+"\t        </div>"+"\t      </div>"+"\t  </b-navbar-brand>"+"\t"+'\t  <b-navbar-toggle target="nav_collapse" aria-label="Open/Close more information"></b-navbar-toggle>'+"\t"+'\t  <b-collapse is-nav id="nav_collapse">'+'\t    <b-navbar-nav class="ml-auto">'+'\t      <b-nav-item class="mb-0 pb-0 nopadding" target="_blank" href=\'https://www.arcos.inf.uc3m.es/\'>'+'\t      \t<img alt="ARCOS" class="nopadding headerLogo" src="./images/arcos.svg">'+"\t      </b-nav-item>"+"\t"+'\t      <b-nav-item class="mb-0 pb-0 nopadding" target="_blank" href=\'https://www.inf.uc3m.es/\'>'+'\t      \t<img alt="Computer Science and Engineering Departament" '+'\t             class="nopadding headerLogo" '+'\t             src="./images/dptoinf.png">'+"\t      </b-nav-item>"+"\t    </b-navbar-nav>"+"\t  </b-collapse>"+"\t</b-navbar>"};Vue.component("navbar-creator",uielto_navbar);var uielto_configuration={props:{instructions_packed:{type:Number,required:true},autoscroll:{type:Boolean,required:true},notification_time:{type:Number,required:true},dark:{type:Boolean,required:true},c_debug:{type:Boolean,required:true}},methods:{change_execution_speed(value){var prevInstructionPacked=this._props.instructions_packed;if(value){this._props.instructions_packed=this._props.instructions_packed+value;if(this._props.instructions_packed<1){this._props.instructions_packed=1}if(this._props.instructions_packed>101){this._props.instructions_packed=101}}else{this._props.instructions_packed=parseInt(this._props.instructions_packed)}app._data.instructionsPacked=this._props.instructions_packed;localStorage.setItem("instructionsPacked",this._props.instructions_packed);creator_ga("send","event","configuration","configuration.execution_speed","configuration.execution_speed.less_speed_"+(prevInstructionPacked>this._props.instructionsPacked).toString())},change_autoscroll(){this._props.autoscroll=!this._props.autoscroll;localStorage.setItem("autoscroll",this._props.autoscroll);app._data.autoscroll=this._props.autoscroll;creator_ga("send","event","configuration","configuration.autoscroll","configuration.autoscroll."+this._props.autoscroll)},change_notification_time(value){var prevNotificationTime=this._props.notification_time;if(value){this._props.notification_time=this._props.notification_time+value;if(this._props.notification_time<1e3){this._props.notification_time=1e3}if(this._props.notification_time>3500){this._props.notification_time=3500}}else{this._props.notification_time=parseInt(this._props.notification_time)}app._data.notificationTime=this._props.notification_time;localStorage.setItem("notificationTime",this._props.notification_time);creator_ga("send","event","configuration","configuration.notification_time","configuration.notification_time.less_time_"+(prevNotificationTime>this._props.notificationTime).toString())},change_dark_mode(){this._props.dark=!this._props.dark;if(this._props.dark){document.getElementsByTagName("body")[0].style="filter: invert(88%) hue-rotate(160deg) !important; background-color: #111 !important;";localStorage.setItem("dark_mode","filter: invert(88%) hue-rotate(160deg) !important; background-color: #111 !important;")}else{document.getElementsByTagName("body")[0].style="";localStorage.setItem("dark_mode","")}app._data.dark=this._props.dark;creator_ga("send","event","configuration","configuration.dark_mode","configuration.dark_mode."+this._props.dark)}},template:"\t<b-list-group>"+""+'    \t    <b-list-group-item class="d-flex justify-content-between align-items-center m-1">'+'            <label for="range-1">Execution Speed:</label>'+"    \t\t    <b-input-group>"+"    \t        <b-input-group-prepend>"+'    \t          <b-btn variant="outline-secondary" @click="change_execution_speed(-5)">-</b-btn>'+"    \t        </b-input-group-prepend>"+'              <b-form-input id="range-1"'+'                            v-model="instructions_packed" '+'                            @change="change_execution_speed(0)" '+'                            type="range" '+'                            min="1" '+'                            max="101" '+'                            step="5" '+'                            title="Execution Speed">'+"              </b-form-input>"+"    \t        <b-input-group-append>"+'    \t          <b-btn variant="outline-secondary" @click="change_execution_speed(5)">+</b-btn>'+"    \t        </b-input-group-append>"+"    \t\t    </b-input-group>"+"    \t    </b-list-group-item>"+""+'    \t    <b-list-group-item class="d-flex justify-content-between align-items-center m-1">'+'            <label for="range-2">Execution Autoscroll:</label>'+'            <b-form-checkbox id="range-2"'+'                             v-model="autoscroll" '+'                             name="check-button" '+"                             switch "+'                             size="lg" '+'                             @change="change_autoscroll">'+"            </b-form-checkbox>"+"    \t    </b-list-group-item>"+""+'    \t    <b-list-group-item class="d-flex justify-content-between align-items-center m-1">'+'            <label for="range-3">Notification Time:</label>'+"    \t\t    <b-input-group>"+"              <b-input-group-prepend>"+'                <b-btn variant="outline-secondary" @click="change_notification_time(-20)">-</b-btn>'+"              </b-input-group-prepend>"+'              <b-form-input id="range-3"'+'                            v-model="notification_time" '+'                            @change="change_notification_time(0)" '+'                            type="range" '+'                            min="1000" '+'                            max="3500" '+'                            step="10" '+'                            title="Notification Time">'+"              </b-form-input>"+"              <b-input-group-append>"+'                <b-btn variant="outline-secondary" @click="change_notification_time(20)">+</b-btn>'+"              </b-input-group-append>"+"    \t\t    </b-input-group>"+"    \t    </b-list-group-item>"+""+'          \x3c!--<b-list-group-item class="d-flex justify-content-between align-items-center m-1">'+'            <label for="range-4">Font Size:</label>'+"            <b-input-group>"+"              <b-input-group-prepend>"+'                <b-btn variant="outline-secondary" @click="change_font_size(-1)">-</b-btn>'+"              </b-input-group-prepend>"+'              <b-form-input id="range-4"'+'                            v-model="fontSize" '+'                            @change="change_font_size(0)" '+'                            type="range" '+'                            min="8" '+'                            max="48" '+'                            step="1" '+'                            title="Font Size"> '+"              </b-form-input>"+"              <b-input-group-append>"+'                <b-btn variant="outline-secondary" @click="change_font_size(1)">+</b-btn>'+"              </b-input-group-append>"+"            </b-input-group>"+"          </b-list-group-item>--\x3e"+""+'    \t    <b-list-group-item class="d-flex justify-content-between align-items-center m-1">'+'            <label for="range-5">Dark Mode:</label>'+'            <b-form-checkbox id="range-5"'+'                             name="check-button"'+'                             switch size="lg"'+'                             v-model="dark" '+'                             @change="change_dark_mode">'+"            </b-form-checkbox>"+"    \t    </b-list-group-item>"+""+'    \t    <b-list-group-item class="d-flex justify-content-between align-items-center m-1">'+'            <label for="range-6">Debug:</label>'+'            <b-form-checkbox id="range-6" v-model="app._data.c_debug" name="check-button" switch size="lg"></b-form-checkbox>'+"    \t    </b-list-group-item>"+""+"    \t  </b-list-group>"};Vue.component("form-configuration",uielto_configuration);var uielto_info={props:{target:{type:String,required:true},show_instruction_help:{type:Boolean,required:true}},methods:{closePopover(){this.$root.$emit("bv::hide::popover")}},template:'\t<b-popover :target="target" triggers="click blur">'+"\t  <template v-slot:title>"+'\t    <b-button @click="closePopover" class="close" aria-label="Close">'+'\t      <span class="d-inline-block" aria-hidden="true">&times;</span>'+"\t    </b-button>"+"\t    <br>"+"\t  </template>"+"\t"+'\t  <div class="col-lg-12 col-sm-12">'+'\t    <b-button class="btn btn-outline-secondary btn-sm btn-block infoButton" '+"\t            href='https://creatorsim.github.io/' "+'\t            target="_blank" '+"\t            onclick=\"creator_ga('send', 'event', 'help', 'help.general_help', 'help.general_help');\">"+'\t      <span class="fas fa-question-circle" ></span> '+"\t      Help"+"\t    </b-button>"+'\t    <b-button class="btn btn-outline-secondary btn-block btn-sm h-100 infoButton" v-if="show_instruction_help==\'true\'"'+'\t              id="inst_ass" v-b-toggle.sidebar_help'+"\t              onclick=\"creator_ga('send', 'event', 'help', 'help.instruction_help', 'help.instruction_help');\">"+'\t        <span class="fas fa-book"></span>'+"\t        Instruction Help"+"\t    </b-button>"+'\t    <b-button class="btn btn-outline-secondary btn-sm btn-block buttonBackground h-100" '+"\t              v-b-modal.notifications>"+'\t      <span class="fas fa-bell"></span> '+"\t      Show Notifications"+"\t    </b-button>"+'\t    <b-button class="btn btn-outline-secondary btn-sm btn-block buttonBackground h-100"'+"\t              v-b-modal.about>"+'\t      <span class="fas fa-address-card"></span> '+"\t        About us"+"\t    </b-button>"+"\t  </div>"+"\t</b-popover>"};Vue.component("popover-info",uielto_info);var uielto_about={template:"<b-card-group>"+""+"<card-author "+'  author_img="/creator/images/author_fgarcia.png" '+'  author_alt="author_fgarcia" '+'  author_full_name="Félix García Carballeira" '+'  author_href_linked="" '+'  author_href_rgate="https://www.researchgate.net/profile/Felix_Garcia-Carballeira" '+'  author_href_github="" '+"></card-author>"+""+"<card-author "+'  author_img="/creator/images/author_acaldero.png" '+'  author_alt="author_acaldero" '+'  author_full_name="Alejandro Calderón Mateos" '+'  author_href_linked="https://www.linkedin.com/in/alejandro-calderon-mateos/" '+'  author_href_rgate="https://www.researchgate.net/profile/Alejandro_Calderon2" '+'  author_href_github="https://github.com/acaldero/wepsim" '+"></card-author>"+""+"<card-author "+'  author_img="/creator/images/author_dcamarmas.png" '+'  author_alt="author_dcamarmas" '+'  author_full_name="Diego Camarmas Alonso" '+'  author_href_linked="https://www.linkedin.com/in/dcamarmas" '+'  author_href_rgate="https://www.researchgate.net/profile/Diego-Camarmas-Alonso" '+'  author_href_github="https://github.com/dcamarmas" '+"></card-author>"+""+"</b-card-group>"};Vue.component("uielto-about",uielto_about);var uielto_author={props:{author_img:{type:String,required:true},author_alt:{type:String,required:true},author_full_name:{type:String,required:true},author_href_linked:{type:String,required:false},author_href_rgate:{type:String,required:false},author_href_github:{type:String,required:false}},template:'  <b-card :img-src="author_img" '+'          :img-alt="author_alt" img-top>'+"  <b-card-text>"+'\t  <div class="authorName"><span class="h6">{{ author_full_name }}</span></div>'+"\t  <hr>"+'\t  <a aria-label="linkedin" target="_blank" :href="author_href_linked">'+'\t  <span class="fab fa-linkedin"></span>'+" linkedin"+"\t  </a>"+"\t  <hr>"+'\t  <a aria-label="r-gate" target="_blank" :href="author_href_rgate">'+'\t  <span class="fab fa-researchgate"></span>'+" r-gate"+"\t  </a>"+"\t  <hr>"+'\t  <a aria-label="github" target="_blank" :href="author_href_github">'+'\t  <span class="fab fa-github"></span>'+" github"+"\t  </a>"+"  </b-card-text>"+"  </b-card>"};Vue.component("card-author",uielto_author);var uielto_notifications={props:{notifications:{type:Array,required:true}},template:" <div>"+'   <span class="h6" v-if="notifications.length == 0">'+"     There's no notification at the moment"+"   </span>"+'   <b-alert show :variant="item.color" v-for="item in notifications">'+'     <span class="h6">'+'       <span class="fas fa-info-circle" v-if="item.color!=\'danger\'"></span>'+'       <span class="fas fa-exclamation-triangle" v-if="item.color==\'danger\'"></span> '+"         {{item.mess}}"+"       </span>"+'       <span class="h6">{{item.time}}   -   {{item.date}}</span>'+"   </b-alert>"+" </div>"};Vue.component("uielto-notifications",uielto_notifications);var uielto_instruction_help={props:{architecture:{type:Object,required:true},id:{type:String,required:true}},data:function(){return{instHelpFilter:null,insHelpFields:["name"]}},template:'<b-sidebar :id="id" sidebar-class="border-left border-info" title="Instruction Help" right shadow width="33vw">'+'\t<div class="px-3 py-2">'+"\t"+"\t              <b-form-input"+'\t                id="filter-input"'+'\t                v-model="instHelpFilter"'+'\t                type="search"'+'\t                placeholder="Search instruction"'+"\t                size=sm"+"\t              ></b-form-input>"+"\t"+"\t              <br>"+"\t"+'\t              <b-table small :items="architecture.instructions" '+'\t                             :fields="insHelpFields" '+'\t                             class="text-left help-scroll-y"'+'\t                             :filter="instHelpFilter"'+'\t                             thead-class="d-none">'+"\t"+'\t                <template v-slot:cell(name)="row">'+"\t                  <h4>{{row.item.name}}</h4>"+"\t                  <em>{{row.item.signatureRaw}}</em>"+"\t                  <br>"+"\t                  {{row.item.help}}"+"\t                </template>"+"\t"+"\t              </b-table>"+"\t"+"\t            </div>"+"</b-sidebar"};Vue.component("sidebar-instruction-help",uielto_instruction_help);var uielto_backup={props:{date_copy:{type:String,required:true}},methods:{load_copy(){app._data.architecture_name=localStorage.getItem("arch_name");var auxArchitecture=JSON.parse(localStorage.getItem("architecture_copy"));architecture=register_value_deserialize(auxArchitecture);app._data.architecture=architecture;code_assembly=localStorage.getItem("assembly_copy");for(var i=0;i<app._data.arch_available.length;i++){if(app._data.arch_available[i].name===app._data.architecture_name){app.load_examples_available(app._data.arch_available[i].examples[0])}}architecture_hash=[];for(var i=0;i<architecture.components.length;i++){architecture_hash.push({name:architecture.components[i].name,index:i});app._data.architecture_hash=architecture_hash}backup_stack_address=architecture.memory_layout[4].value;backup_data_address=architecture.memory_layout[3].value;app.reset(false);app.change_UI_mode("simulator");app.change_data_view("registers","int");app.$forceUpdate();show_notification("The backup has been loaded correctly","success")},remove_copy(){localStorage.removeItem("architecture_copy");localStorage.removeItem("assembly_copy");localStorage.removeItem("date_copy");app.$refs.copyRef.hide()}},template:" <div>"+'   <span class="h6">A backup is available</span>'+"   <br>"+'   <span class="h6">Date: {{date_copy}}</span>'+'   <div class="col-lg-12 col-sm-12 row nomargin">'+'     <div class="col-lg-6 col-sm-6 pb-1">'+'       <b-button class="btn btn-outline-danger btn-block btn-sm buttonBackground" '+'                 @click="remove_copy">'+"         Discard"+"       </b-button>"+"     </div>"+'     <div class="col-lg-6 col-sm-6 pb-1">'+'       <b-button class="btn btn-outline-primary btn-block btn-sm buttonBackground" '+'                 @click="load_copy">'+"         Load"+"       </b-button>"+"     </div>"+"   </div>"+" </div>"};Vue.component("uielto-backup",uielto_backup);var uielto_examples={props:{example_available:{type:Array,required:true},compile:{type:String,required:true},modal:{type:String,required:true}},methods:{load_example(url,compile){this.$root.$emit("bv::hide::modal",this._props.modal,"#closeExample");$.get(url,(function(data){code_assembly=data;if(compile=="false"){textarea_assembly_editor.setValue(code_assembly)}else{app.assembly_compiler(code_assembly)}show_notification(" The selected example has been loaded correctly","success");creator_ga("send","event","example","example.loading","example.loading."+url)}))}},template:" <div>"+'   <span class="h6" v-if="example_available.length == 0">'+"     There's no examples at the moment"+"   </span>"+"   <b-list-group>"+"     <b-list-group-item button "+'                        v-for="item in example_available" '+'                        @click="load_example(item.url, compile)" '+'                        ref="closeExample">'+"       {{item.name}}:"+'       <span v-html="item.description"></span>'+"     </b-list-group-item>"+"   </b-list-group>"+" </div>"};Vue.component("examples",uielto_examples);var uielto_textarea_assembly={props:{browser:{type:String,required:true}},template:'   <div class="col-lg-12 col-sm-12" id="divAssembly">'+'     <span id="assemblyInfo" class="fas fa-info-circle"></span> <span class="h5">Assembly:</span>'+"   "+'     <popover-shortcuts target="assemblyInfo" :browser="browser"></popover-shortcuts>'+"   "+'     <textarea id="textarea_assembly" rows="14" class="code-scroll-y d-none" title="Asembly Code"></textarea>'+"   </div>"};Vue.component("textarea-assembly",uielto_textarea_assembly);var uielto_library_tags={props:{instructions_tag:{type:Array,required:true}},template:' <div class="col-lg-0 col-sm-0 d-none" id="divTags">'+'   <span class="h5">Library tags:</span>'+"   <b-list-group>"+'     <b-list-group-item v-for="item in instructions_tag" '+'                        v-if="item.globl==true">'+'       <b-badge pill variant="primary">'+"         {{item.tag}}"+"       </b-badge>"+"     </b-list-group-item>"+"   </b-list-group>"+" </div>"};Vue.component("list-libray-tags",uielto_library_tags);var uielto_shortcuts={props:{target:{type:String,required:true},browser:{type:String,required:true}},template:'\t<b-popover :target="target" title="Shortcuts" triggers="hover focus" placement="bottomright">'+"\t\t<b-list-group>"+'\t\t  <b-list-group-item class="d-flex justify-content-between align-items-center">'+"\t\t    Copy &nbsp&nbsp"+'\t\t    <b-badge variant="primary" pill v-if="browser != \'Mac\'"> Ctrl + c</b-badge>'+'\t\t    <b-badge variant="primary" pill v-if="browser == \'Mac\'"> ⌘ + c</b-badge>'+"\t\t  </b-list-group-item>"+"\t"+'\t\t  <b-list-group-item class="d-flex justify-content-between align-items-center">'+"\t\t    Cut&nbsp &nbsp&nbsp"+'\t\t    <b-badge variant="primary" pill v-if="browser != \'Mac\'"> Ctrl + x</b-badge>'+'\t\t    <b-badge variant="primary" pill v-if="browser == \'Mac\'"> ⌘ + x</b-badge>'+"\t\t  </b-list-group-item>"+"\t"+'\t\t  <b-list-group-item class="d-flex justify-content-between align-items-center">'+"\t\t    Paste &nbsp&nbsp"+'\t\t    <b-badge variant="primary" pill v-if="browser != \'Mac\'"> Ctrl + v</b-badge>'+'\t\t    <b-badge variant="primary" pill v-if="browser == \'Mac\'"> ⌘ + v</b-badge>'+"\t\t  </b-list-group-item>"+"\t"+'\t\t  <b-list-group-item class="d-flex justify-content-between align-items-center">'+"\t\t    Select all &nbsp&nbsp"+'\t\t    <b-badge variant="primary" pill v-if="browser != \'Mac\'"> Ctrl + a</b-badge>'+'\t\t    <b-badge variant="primary" pill v-if="browser == \'Mac\'"> ⌘ + a</b-badge>'+"\t\t  </b-list-group-item>"+"\t"+'\t\t  <b-list-group-item class="d-flex justify-content-between align-items-center">'+"\t\t    Undo &nbsp&nbsp"+'\t\t    <b-badge variant="primary" pill v-if="browser != \'Mac\'"> Ctrl + z</b-badge>'+'\t\t    <b-badge variant="primary" pill v-if="browser == \'Mac\'"> ⌘ + z</b-badge>'+"\t\t  </b-list-group-item>"+"\t"+'\t\t  <b-list-group-item class="d-flex justify-content-between align-items-center">'+"\t\t    Redo &nbsp&nbsp"+'\t\t    <b-badge variant="primary" pill v-if="browser != \'Mac\'"> Ctrl + y</b-badge>'+'\t\t    <b-badge variant="primary" pill v-if="browser == \'Mac\'"> ⌘ + y</b-badge>'+"\t\t  </b-list-group-item>"+"\t"+'\t\t  <b-list-group-item class="d-flex justify-content-between align-items-center">'+"\t\t    Block code comment &nbsp&nbsp"+'\t\t    <b-badge variant="primary" pill v-if="browser != \'Mac\'"> Ctrl + m</b-badge>'+'\t\t    <b-badge variant="primary" pill v-if="browser == \'Mac\'"> ⌘ + m</b-badge>'+"\t\t  </b-list-group-item>"+"\t\t</b-list-group>"+"\t</b-popover>"};Vue.component("popover-shortcuts",uielto_shortcuts);var uielto_assembly_error={props:{modal_assembly_error:{type:Object,required:true}},template:" <div>"+'   <span class="h6 font-weight-light">Code fragment:</span>'+'   <div class="errorAssembly">'+'     <span class="h6 text-monospace" label="Code fragment:">'+"          <b-container>"+"          <b-row>"+'          <b-col class="px-0"         >&nbsp;</b-col>'+'          <b-col class="px-2"         >...</b-col>'+'          <b-col class="pl-2" cols="10">&nbsp;</b-col>'+"          </b-row>"+"          <b-row>"+'          <b-col class="px-0"         >&nbsp;</b-col>'+'          <b-col class="px-2"         >{{modal_assembly_error.line1}}</b-col>'+'          <b-col class="pl-2" cols="10">{{modal_assembly_error.code1}}</b-col>'+"          </b-row>"+"          <b-row>"+'          <b-col class="px-0"         >*</b-col>'+'          <b-col class="px-2"         >{{modal_assembly_error.line2}}</b-col>'+'          <b-col class="pl-2" cols="10">{{modal_assembly_error.code2}}</b-col>'+"          </b-row>"+"          <b-row>"+'          <b-col class="px-0"         >&nbsp;</b-col>'+'          <b-col class="px-2"         >{{modal_assembly_error.line3}}</b-col>'+'          <b-col class="pl-2" cols="10">{{modal_assembly_error.code3}}</b-col>'+"          </b-row>"+"          <b-row>"+'          <b-col class="px-0"         >&nbsp;</b-col>'+'          <b-col class="px-2"         >...</b-col>'+'          <b-col class="pl-2" cols="10">&nbsp;</b-col>'+"          </b-row>"+"          </b-container>"+"     </span>"+"   </div>"+"   <br>"+" "+'   <span class="h6 font-weight-light">Error description:</span>'+"   <br>"+'   <span class="h6">{{modal_assembly_error.error}}</span>'+"   <br>"+" </div>"};Vue.component("assembly-error",uielto_assembly_error);var uielto_calculator={data:function(){return{calculator:{bits:32,hexadecimal:"",sign:"",exponent:"",mantissa:"",mantisaDec:0,exponentDec:"",decimal:"",variant32:"primary",variant64:"outline-primary",lengthHexadecimal:8,lengthSign:1,lengthExponent:8,lengthMantissa:23}}},methods:{changeBitsCalculator(index){if(index==0){this.calculator.bits=32;this.calculator.variant32="primary";this.calculator.variant64="outline-primary";this.calculator.lengthHexadecimal=8;this.calculator.lengthSign=1;this.calculator.lengthExponent=8;this.calculator.lengthMantissa=23}if(index==1){this.calculator.bits=64;this.calculator.variant64="primary";this.calculator.variant32="outline-primary";this.calculator.lengthHexadecimal=16;this.calculator.lengthSign=1;this.calculator.lengthExponent=11;this.calculator.lengthMantissa=52}this.calculator.hexadecimal="";this.calculator.sign="";this.calculator.exponent="";this.calculator.mantissa="";this.calculator.decimal="";this.calculator.sign="";this.calculator.exponentDec="";this.calculator.mantissaDec=""},calculatorFunct(index){switch(index){case 0:console_log(this.calculator.hexadecimal.padStart(this.calculator.bits/4,"0"));var hex=this.calculator.hexadecimal.padStart(this.calculator.bits/4,"0");var float;var binary;if(this.calculator.bits==32){var re=/[0-9A-Fa-f]{8}/g;if(!re.test(hex)){show_notification("Character not allowed","danger");this.calculator.sign="";this.calculator.exponent="";this.calculator.mantissa="";this.calculator.exponentDec="";this.calculator.mantissaDec=0;this.calculator.decimal="";return}float=hex2float("0x"+hex);console_log(hex2float("0x"+hex));binary=float2bin(float).padStart(this.calculator.bits,"0");this.calculator.decimal=float;this.calculator.sign=binary.substring(0,1);this.calculator.exponent=binary.substring(1,9);this.calculator.mantissa=binary.substring(9,32);this.calculator.exponentDec=parseInt(bin2hex(this.calculator.exponent),16);this.calculator.mantissaDec=0;var j=0;for(var i=0;i<this.calculator.mantissa.length;i++){j--;this.calculator.mantissaDec=this.calculator.mantissaDec+parseInt(this.calculator.mantissa.charAt(i))*Math.pow(2,j)}creator_ga("send","event","calculator","calculator.32","calculator.32.hex");creator_ga("send","event","calculator","calculator.32","calculator.32.0x"+hex)}if(this.calculator.bits==64){var re=/[0-9A-Fa-f]{16}/g;if(!re.test(hex)){show_notification("Character not allowed","danger");this.calculator.sign="";this.calculator.exponent="";this.calculator.mantissa="";this.calculator.exponentDec="";this.calculator.mantissaDec=0;this.calculator.decimal="";return}float=hex2double("0x"+hex);binary=double2bin(float);this.calculator.decimal=float;this.calculator.sign=binary.substring(0,1);this.calculator.exponent=binary.substring(1,12);this.calculator.mantissa=binary.substring(12,64);this.calculator.exponentDec=parseInt(bin2hex(this.calculator.exponent),16);this.calculator.mantissaDec=0;var j=0;for(var i=0;i<this.calculator.mantissa.length;i++){j--;this.calculator.mantissaDec=this.calculator.mantissaDec+parseInt(this.calculator.mantissa.charAt(i))*Math.pow(2,j)}creator_ga("send","event","calculator","calculator.64","calculator.64.hex");creator_ga("send","event","calculator","calculator.64","calculator.64.0x"+hex)}break;case 1:if(this.calculator.bits==32){this.calculator.sign=this.calculator.sign.padStart(1,"0");this.calculator.exponent=this.calculator.exponent.padStart(8,"0");this.calculator.mantissa=this.calculator.mantissa.padStart(23,"0");var binary=this.calculator.sign+this.calculator.exponent+this.calculator.mantissa;console_log(binary);var re=/[0-1]{32}/g;if(!re.test(binary)){show_notification("Character not allowed","danger");this.calculator.hexadecimal="";this.calculator.decimal="";this.calculator.exponentDec="";this.calculator.mantissaDec=0;return}float=hex2float("0x"+bin2hex(binary));hexadecimal=bin2hex(binary);this.calculator.decimal=float;this.calculator.hexadecimal=hexadecimal.padStart(this.calculator.bits/4,"0");this.calculator.exponentDec=parseInt(bin2hex(this.calculator.exponent),16);this.calculator.mantissaDec=0;var j=0;for(var i=0;i<this.calculator.mantissa.length;i++){j--;this.calculator.mantissaDec=this.calculator.mantissaDec+parseInt(this.calculator.mantissa.charAt(i))*Math.pow(2,j)}creator_ga("send","event","calculator","calculator.32","calculator.32.bin");creator_ga("send","event","calculator","calculator.32","calculator.32."+binary)}if(this.calculator.bits==64){this.calculator.sign=this.calculator.sign.padStart(1,"0");this.calculator.exponent=this.calculator.exponent.padStart(11,"0");this.calculator.mantissa=this.calculator.mantissa.padStart(52,"0");var binary=this.calculator.sign+this.calculator.exponent+this.calculator.mantissa;var re=/[0-1]{64}/g;if(!re.test(binary)){show_notification("Character not allowed","danger");this.calculator.hexadecimal="";this.calculator.decimal="";this.calculator.exponentDec=parseInt(bin2hex(this.calculator.exponent),16);this.calculator.mantissaDec=0;var j=0;for(var i=0;i<this.calculator.mantissa.length;i++){j--;this.calculator.mantissaDec=this.calculator.mantissaDec+parseInt(this.calculator.mantissa.charAt(i))*Math.pow(2,j)}return}double=hex2double("0x"+bin2hex(binary));hexadecimal=bin2hex(binary);this.calculator.decimal=double;this.calculator.hexadecimal=hexadecimal.padStart(this.calculator.bits/4,"0");creator_ga("send","event","calculator","calculator.64","calculator.64.bin");creator_ga("send","event","calculator","calculator.64","calculator.64."+binary)}break;case 2:var float=parseFloat(this.calculator.decimal,10);var binary;var hexadecimal;if(this.calculator.bits==32){hexadecimal=bin2hex(float2bin(float));binary=float2bin(float);console_log(hexadecimal);this.calculator.hexadecimal=hexadecimal.padStart(this.calculator.bits/4,"0");this.calculator.sign=binary.substring(0,1);this.calculator.exponent=binary.substring(1,9);this.calculator.mantissa=binary.substring(9,32);this.calculator.exponentDec=parseInt(bin2hex(this.calculator.exponent),16);this.calculator.mantissaDec=0;var j=0;for(var i=0;i<this.calculator.mantissa.length;i++){j--;this.calculator.mantissaDec=this.calculator.mantissaDec+parseInt(this.calculator.mantissa.charAt(i))*Math.pow(2,j)}creator_ga("send","event","calculator","calculator.32","calculator.32.dec");creator_ga("send","event","calculator","calculator.32","calculator.32."+this.calculator.decimal)}if(this.calculator.bits==64){hexadecimal=bin2hex(double2bin(float));binary=double2bin(float);this.calculator.hexadecimal=hexadecimal.padStart(this.calculator.bits/4,"0");this.calculator.sign=binary.substring(0,1);this.calculator.exponent=binary.substring(1,12);this.calculator.mantissa=binary.substring(12,64);this.calculator.exponentDec=parseInt(bin2hex(this.calculator.exponent),16);this.calculator.mantissaDec=0;var j=0;for(var i=0;i<this.calculator.mantissa.length;i++){j--;this.calculator.mantissaDec=this.calculator.mantissaDec+parseInt(this.calculator.mantissa.charAt(i))*Math.pow(2,j)}creator_ga("send","event","calculator","calculator.64","calculator.64.dec");creator_ga("send","event","calculator","calculator.64","calculator.64."+this.calculator.decimal)}break}},debounce:_.debounce((function(param,e){console_log(param);console_log(e);e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var re=new RegExp("'","g");e=e.replace(re,'"');re=new RegExp("[\f]","g");e=e.replace(re,"\\f");re=new RegExp("[\n]","g");e=e.replace(re,"\\n");re=new RegExp("[\r]","g");e=e.replace(re,"\\r");re=new RegExp("[\t]","g");e=e.replace(re,"\\t");re=new RegExp("[\v]","g");e=e.replace(re,"\\v");if(e==""){this[param]=null;return}console_log("this."+param+"= '"+e+"'");eval("this."+param+"= '"+e+"'");app.$forceUpdate()}),getDebounceTime())},template:"\t<div>"+'\t  <div class="col-lg-12 col-12 row nomargin pb-3">'+'\t    <div class="col-lg-3 col-3"></div>'+'\t    <div class="col-lg-6 col-6">'+'\t      <div class="col-lg-12 col-12 row nomargin nopadding">'+'\t        <div class="col-lg-6 col-6 nopadding">'+'\t          <b-button class="btn btn-block btn-sm h-100" '+'\t                    :variant = "calculator.variant32" '+'\t                    @click="changeBitsCalculator(0)">'+"\t            32 bit"+"\t          </b-button>"+"\t        </div>"+'\t        <div class="col-lg-6 col-6 nopadding">'+'\t          <b-button class="btn btn-block btn-sm h-100" '+'\t                    :variant = "calculator.variant64" '+'\t                    @click="changeBitsCalculator(1)">'+"\t            64 bit"+"\t          </b-button>"+"\t        </div>"+"\t      </div>"+"\t    </div>"+'\t    <div class="col-lg-3 col-3"></div>'+"\t  </div>"+"\t"+'\t  <div class="col-lg-12 col-12 row nomargin pt-3">'+'\t    <div class="col-lg-2 col-2"></div>'+'\t    <div class="col-lg-6 col-8">'+'\t      <b-form-input class="form-control form-control-sm" '+"\t                    v-on:input=\"debounce('calculator.hexadecimal', $event)\" "+'\t                    :value="calculator.hexadecimal" '+'\t                    @change="calculatorFunct(0)" '+'\t                    placeholder="Enter hexadecimal number" '+'\t                    :maxlength="calculator.lengthHexadecimal" '+'\t                    title="Hexadecimal">'+"\t      </b-form-input>"+"\t    </div>"+'\t    <div class="col-lg-4"></div>'+"\t  </div>"+"\t"+'\t  <div class="col-lg-12 col-12 row nomargin nopadding">'+'\t    <div class="col-lg-1 col-0"></div>'+'\t    <div class="col-lg-8 col-12 p-1">'+'\t      <b-img class="calculatorImg" src="./images/calculator.png" fluid alt="calculator"></b-img>'+"\t    </div>"+'\t    <div class="col-lg-3 col-0"></div>'+"\t  </div>"+"\t"+'\t  <div class="col-lg-12 col-12 row nomargin nopadding">'+'\t    <div class="col-lg-1 col-0"></div>'+'\t    <div class="col-lg-8 col-12 nopadding">'+'\t      <div class="col-lg-12 col-12 row nomargin nopadding">'+'\t        <div class="col-lg-2 col-2 p-1">'+'\t          <b-form-input class="form-control form-control-sm" '+"\t                        v-on:input=\"debounce('calculator.sign', $event)\" "+'\t                        :value="calculator.sign" '+'\t                        @change="calculatorFunct(1)" '+'\t                        placeholder="Enter sign" '+'\t                        :maxlength="calculator.lengthSign" '+'\t                        title="Sign">'+"\t          </b-form-input>"+"\t        </div>"+'\t        <div class="col-lg-4 col-4 p-1">'+'\t          <b-form-input class="form-control form-control-sm" '+"\t                        v-on:input=\"debounce('calculator.exponent', $event)\" "+'\t                        :value="calculator.exponent" '+'\t                        @change="calculatorFunct(1)" '+'\t                        placeholder="Enter exponent" '+'\t                        :maxlength="calculator.lengthExponent" '+'\t                        title="Exponent">'+"\t          </b-form-input>"+"\t        </div>"+'\t        <div class="col-lg-6 col-6 p-1">'+'\t          <b-form-input class="form-control form-control-sm" '+"\t                        v-on:input=\"debounce('calculator.mantissa', $event)\" "+'\t                        :value="calculator.mantissa" '+'\t                        @change="calculatorFunct(1)" '+'\t                        placeholder="Enter mantissa" '+'\t                        :maxlength="calculator.lengthMantissa" '+'\t                        title="Mantisa">'+"\t          </b-form-input>"+"\t        </div>"+"\t      </div>"+"\t    </div>"+'\t    <div class="col-lg-3 col-0"></div>'+"\t  </div>"+"\t"+'\t  <div class="col-lg-12 col-12 row nomargin nopadding">'+'\t    <div class="col-lg-1"></div>'+'\t    <div class="col-lg-8 col-12 nopadding">'+'\t      <div class="col-lg-12 col-12 row nomargin nopadding">'+'\t        <div class="col-lg-2 col-2 center p-1">'+'\t          <span class="fas fa-long-arrow-alt-down p-1"></span>'+"\t          <br>"+'\t          <span class="h5">'+"\t            -1<sup>{{calculator.sign}}</sup>   * "+"\t          </span>"+"\t        </div>"+'\t        <div class="col-lg-4 col-4 center p-1">'+'\t          <span class="fas fa-long-arrow-alt-down p-1"></span>'+"\t          <br>"+'\t          <span class="h5" v-if="calculator.bits == 32">'+"\t            2<sup>{{calculator.exponentDec}}-127</sup>   * "+"\t          </span>"+'\t          <span class="h5" v-if="calculator.bits == 64">'+"\t            2<sup>{{calculator.exponentDec}}-1023</sup>   * "+"\t          </span>"+"\t        </div>"+'\t        <div class="col-lg-6 col-6 center p-1">'+'\t          <span class="fas fa-long-arrow-alt-down p-1"></span>'+"\t          <br>"+'\t          <span class="h5">'+"\t          {{calculator.mantissaDec}} = "+"\t        </span>"+"\t        </div>"+"\t      </div>"+"\t    </div>"+'\t    <div class="col-lg-3 pt-3">'+'\t      <b-form-input class="form-control form-control-sm" '+"\t                    v-on:input=\"debounce('calculator.decimal', $event)\" "+'\t                    :value="calculator.decimal" '+'\t                    @change="calculatorFunct(2)" '+'\t                    placeholder="Enter decimal number" '+'\t                    title="Decimal">'+"\t      </b-form-input>"+"\t    </div>"+"\t  </div>"+"\t"+'\t  <div class="col-lg-12 col-12 pt-2">'+'\t    <b-button class="btn btn-sm btn-block" variant="primary">Convert</b-button>'+"\t  </div>"+"\t</div>"};Vue.component("calculator",uielto_calculator);function getDebounceTime(){if(screen.width>768){return 500}else{return 1e3}}var uielto_execution={props:{instructions:{type:Array,required:true},enter:{type:String,required:true}},data:function(){return{archInstructions:["Break","Address","Label","userInstructions","loadedInstructions","tag"]}},methods:{filter(row,filter){if(row.hide==true){return false}else{return true}},breakPoint(record,index){for(var i=0;i<instructions.length;i++){if(instructions[i].Address==record.Address){index=i;break}}if(instructions[index].Break==null){instructions[index].Break=true;app._data.instructions[index].Break=true;creator_ga("send","event","execute","execute.breakpoint","execute.breakpoint")}else if(instructions[index].Break==true){instructions[index].Break=null;app._data.instructions[index].Break=null}}},template:' <div class="col-rt-4 col-xl-7 col-lg-6 col-sm-12 px-0">'+'   <div class="col-lg-12 col-sm-12 px-2">'+" "+'     <b-table id="inst_table" '+"              sticky-header "+"              striped "+"              small "+"              hover "+'              :items="instructions" '+'              :fields="archInstructions" '+'              class="instructions_table responsive" '+'              @row-clicked="breakPoint" '+"              :filter-function=filter "+'              filter=" " '+'              primary-key="Address">'+" "+"       \x3c!-- Change the title of each column --\x3e"+'       <template v-slot:head(userInstructions)="row">'+"         User Instruction"+"       </template>"+" "+'       <template v-slot:head(loadedInstructions)="row">'+"         Loaded Instructions"+"       </template>"+" "+'       <template v-slot:head(tag)="row">'+"         &nbsp;"+"       </template>"+" "+"       \x3c!-- For each instruction --\x3e"+'       <template v-slot:cell(Break)="row">'+'         <div class="break" :id="row.index">'+'           <br v-if="row.item.Break == null">'+'           <b-img alt="Break" '+'                  src="./images/stop_classic.gif" '+'                  class="shadow breakPoint" '+'                  rounded="circle" '+'                  v-if="row.item.Break == true">'+"           </b-img>"+"         </div>"+"       </template>"+" "+'       <template v-slot:cell(Address)="row">'+'         <span class="h6">{{row.item.Address}}</span>'+"       </template>"+" "+'       <template v-slot:cell(Label)="row">'+'         <b-badge pill variant="info">{{row.item.Label}}</b-badge>'+"       </template>"+" "+'       <template v-slot:cell(userInstructions)="row">'+'         <span class="h6" v-if="row.item.visible == true">{{row.item.user}}</span>'+'         <span class="h6" v-if="row.item.visible == false">&lt;&lt;Hidden&gt;&gt;</span>'+"       </template>"+" "+'       <template v-slot:cell(loadedInstructions)="row">'+'         <span class="h6" v-if="row.item.visible == true">{{row.item.loaded}}</span>'+'         <span class="h6" v-if="row.item.visible == false">&lt;&lt;Hidden&gt;&gt;</span>'+"       </template> "+" "+'       <template v-slot:cell(tag)="row">'+'         <b-badge variant="info" '+'                  class="border border-info shadow executionTag" '+"                  v-if=\"row.item._rowVariant=='info' && enter == false\">"+"           Current-Keyboard"+"         </b-badge>"+'         <b-badge variant="success" '+'                  class="border border-success shadow executionTag" '+"                  v-if=\"row.item._rowVariant=='success'\">"+"             Next"+"         </b-badge>"+'         <b-badge variant="info" class="border border-info shadow executionTag" '+"                  v-if=\"row.item._rowVariant=='info' && enter == null\">"+"           Current"+"         </b-badge>"+" "+"       </template> "+" "+'       <template slot-scope="row">'+'         <span class="h6" v-if="row.item.visible == true">{{row.item.loaded}}</span>'+'         <span class="h6" v-if="row.item.visible == false">&lt;&lt;Hidden&gt;&gt;</span>'+"       </template> "+"     </b-table>"+"   </div>"+" </div>"};Vue.component("table-execution",uielto_execution);var uielto_data_view_selector={props:{name_reg:{type:String,required:true},reg_type:{type:String,required:true}},data:function(){return{}},methods:{change_data_view(e,type){app._data.data_mode=e;if(e=="registers"){if(type=="int"){app._data.register_type="integer";app._data.name_tab_Reg="Decimal";app._data.name_reg="INT Registers";app._data.reg_type="int"}else if(type=="fp"){app._data.register_type="floating point";app._data.name_tab_Reg="Real";app._data.name_reg="FP Registers";app._data.reg_type="fp"}}if(e=="memory"){app._data.data_mode=e}creator_ga("send","event","data","data.view","data.view."+app._data.data_mode)}},template:' <div class="col-lg-12 col-sm-12 mb-3 px-0">'+'   <div class="col-lg-12 col-sm-12 buttons row">'+'     <div class="col-lg-4 col-sm-4 buttons">'+"       <b-dropdown split "+"                   right "+'                   :text="name_reg" '+'                   size="sm" '+'                   class="btn btn-block btn-sm nopadding h-100" '+'                   variant="outline-secondary" '+"                   @click=\"change_data_view('registers', reg_type)\">"+"         <b-dropdown-item @click=\"change_data_view('registers', 'int')\">CPU-INT Registers</b-dropdown-item>"+"         <b-dropdown-item @click=\"change_data_view('registers', 'fp')\">CPU-FP Registers</b-dropdown-item>"+"       </b-dropdown>"+"     </div>"+'     <div class="col-lg-4 col-sm-4 buttons">'+'       <b-button class="btn btn-outline-secondary btn-block opcionsGroup btn-sm h-100" '+'                 id="memory_btn" '+"                 @click=\"change_data_view('memory')\">"+'         <span class="fas fa-memory"></span>'+"         Memory "+"       </b-button>"+"     </div>"+'     <div class="col-lg-4 col-sm-4 buttons">'+'       <b-button class="btn btn-outline-secondary btn-block opcionsGroup btn-sm h-100" '+'                 id="stats_btn" '+"                 @click=\"change_data_view('stats')\">"+'         <span class=" fas fa-chart-bar"></span>'+"         Stats"+"       </b-button>"+"     </div>"+"   </div>"+" </div>"};Vue.component("data-view-selector",uielto_data_view_selector);var uielto_register={props:{register:{type:Object,required:true},component:{type:Object,required:true},name_representation:{type:String,required:true},value_representation:{type:String,required:true}},methods:{popover_id(name){return"popoverValueContent"+name[0]},show_value(register){var ret=0;switch(this.value_representation){case"unsigned":ret=parseInt(register.value.toString(10))>>>0;break;case"signed":if(this.component.name=="Control registers"||this.component.name=="Integer registers"){if(register.value.toString(2).padStart(register.nbits,"0").charAt(0)==1)ret=parseInt(register.value.toString(10))-4294967296;if(register.value.toString(2).padStart(register.nbits,"0").charAt(0)==0)ret=register.value.toString(10)}else{ret=parseInt(register.value.toString(),10)>>0}break;case"decimal":if(this.component.name=="Control registers"||this.component.name=="Integer registers"){ret=hex2float("0x"+register.value.toString(16).padStart(register.nbits/4,"0"))}else{ret=register.value}break;case"hex":if(this.component.name=="Control registers"||this.component.name=="Integer registers"){ret=register.value.toString(16).padStart(register.nbits/4,"0").toUpperCase()}else{if(this.component.name=="Simple floating point registers"){ret=bin2hex(float2bin(register.value))}else{ret=bin2hex(double2bin(register.value))}}break}ret=ret.toString();if(ret.length>10){return ret.slice(0,8)+"..."}return ret},reg_name(register){switch(this.name_representation){case"logical":return register.name[0];case"alias":if(typeof register.name[1]==="undefined"){return register.name[0]}return register.name[1];case"all":return register.name.join(" | ")}}},template:' <b-button class="btn btn-outline-secondary btn-block btn-sm registers h-100" '+'           :id="popover_id(register.name)" '+"           onclick=\"creator_ga('data', 'data.view', 'data.view.registers_details');\">"+'   <span class="text-truncate">{{reg_name(register)}}</span> '+'   <b-badge class="regValue registerValue"> '+"     {{show_value(register)}}"+"   </b-badge>"+" </b-button>"+" "+' <popover-register-int :target="popover_id(register.name)" '+'                       :component="component"'+'                       :register="register">'+" </popover-register-int>"};Vue.component("register",uielto_register);var uielto_register_int_popover={props:{target:{type:String,required:true},component:{type:Object,required:true},register:{type:Object,required:true}},data:function(){return{newValue:""}},methods:{closePopover(){this.$root.$emit("bv::hide::popover")},updateReg(comp,elem,type,precision){for(var i=0;i<architecture.components[comp].elements.length;i++){if(type=="integer"||type=="control"){if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^0x/)){var value=this.newValue.split("x");if(value[1].length*4>architecture.components[comp].elements[i].nbits){value[1]=value[1].substring((value[1].length*4-architecture.components[comp].elements[i].nbits)/4,value[1].length)}architecture.components[comp].elements[i].value=bi_intToBigInt(value[1],16)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^(\d)+/)){architecture.components[comp].elements[i].value=bi_intToBigInt(this.newValue,10)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^-/)){architecture.components[comp].elements[i].value=bi_intToBigInt(this.newValue,10)}}else if(type=="floating point"){if(precision==false){if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^0x/)){architecture.components[comp].elements[i].value=hex2float(this.newValue);updateDouble(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^(\d)+/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateDouble(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^-/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateDouble(comp,i)}}else if(precision==true){if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^0x/)){architecture.components[comp].elements[i].value=hex2double(this.newValue);updateSimple(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^(\d)+/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateSimple(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^-/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateSimple(comp,i)}}}}this.newValue="";creator_ga("data","data.change","data.change.register_value");creator_ga("data","data.change","data.change.register_value_"+elem)},debounce:_.debounce((function(param,e){console_log(param);console_log(e);e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var re=new RegExp("'","g");e=e.replace(re,'"');re=new RegExp("[\f]","g");e=e.replace(re,"\\f");re=new RegExp("[\n]","g");e=e.replace(re,"\\n");re=new RegExp("[\r]","g");e=e.replace(re,"\\r");re=new RegExp("[\t]","g");e=e.replace(re,"\\t");re=new RegExp("[\v]","g");e=e.replace(re,"\\v");if(e==""){this[param]=null;return}console_log("this."+param+"= '"+e+"'");eval("this."+param+"= '"+e+"'");app.$forceUpdate()}),getDebounceTime())},template:'<b-popover :target="target" '+'           triggers="click blur" '+'           class="popover">'+"  <template v-slot:title>"+'    <b-button @click="closePopover" class="close" aria-label="Close">'+'      <span class="d-inline-block" aria-hidden="true">&times;</span>'+"    </b-button>"+"    {{register.name.join(' | ')}}"+"  </template>"+""+'  <table class="table table-bordered table-sm popoverText">'+"    <tbody>"+"      <tr>"+"        <td>Hex.</td>"+"        <td>"+'          <b-badge class="registerPopover">'+'            {{"0x"+(((register.value).toString(16)).padStart(register.nbits/4, "0")).toUpperCase()}}'+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>Binary</td>"+"        <td>"+'          <b-badge class="registerPopover">'+'            {{(((register.value).toString(2)).padStart(register.nbits, "0"))}}'+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>Signed</td>"+"        <td>"+'          <b-badge class="registerPopover" '+"                   v-if=\"(((register.value).toString(2)).padStart(register.nbits, '0')).charAt(0) == 1\">"+"            {{parseInt(register.value.toString(10))-0x100000000}}"+"          </b-badge>"+'          <b-badge class="registerPopover"'+"                   v-if=\"(((register.value).toString(2)).padStart(register.nbits, '0')).charAt(0) == 0\">"+"            {{(register.value).toString(10)}}"+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>Unsig.</td>"+"        <td>"+'          <b-badge class="registerPopover">'+"            {{(register.value).toString(10) >>> 0}}"+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>Char</td>"+"        <td>"+'          <b-badge class="registerPopover">'+'            {{hex2char8((((register.value).toString(16)).padStart(register.nbits/4, "0")))}}'+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>IEEE 754</td>"+"        <td>"+'          <b-badge class="registerPopover">'+'            {{hex2float("0x"+(((register.value).toString(16)).padStart(register.nbits/4, "0")))}}'+"          </b-badge>"+"        </td>"+"      </tr>"+"    </tbody>"+"  </table>"+""+'  <div class="col-lg-12 col-sm-12 row mx-0">'+'    <div class="col-lg-6 col-sm-6 popoverFooter">'+"      <b-form-input v-on:input=\"debounce('newValue', $event)\" "+'                    :value="newValue" '+'                    type="text" '+'                    size="sm" '+'                    title="New Register Value" '+'                    placeholder="Enter new value">'+"      </b-form-input>"+"    </div>"+'    <div class="col-lg-6 col-sm-6 popoverFooter">'+'      <b-button class="btn btn-primary btn-block btn-sm" '+'                @click="updateReg(component.index, register.name, architecture.components[component.index].type)">'+"        Update"+"      </b-button>"+"    </div>"+"  </div>"+"</b-popover>"};Vue.component("popover-register-int",uielto_register_int_popover);var uielto_register_float_popover={props:{target:{type:String,required:true},component:{type:Object,required:true},register:{type:Object,required:true}},data:function(){return{newValue:""}},methods:{closePopover(){this.$root.$emit("bv::hide::popover")},updateReg(comp,elem,type,precision){for(var i=0;i<architecture.components[comp].elements.length;i++){if(type=="integer"||type=="control"){if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^0x/)){var value=this.newValue.split("x");if(value[1].length*4>architecture.components[comp].elements[i].nbits){value[1]=value[1].substring((value[1].length*4-architecture.components[comp].elements[i].nbits)/4,value[1].length)}architecture.components[comp].elements[i].value=bi_intToBigInt(value[1],16)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^(\d)+/)){architecture.components[comp].elements[i].value=bi_intToBigInt(this.newValue,10)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^-/)){architecture.components[comp].elements[i].value=bi_intToBigInt(this.newValue,10)}}else if(type=="floating point"){if(precision==false){if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^0x/)){architecture.components[comp].elements[i].value=hex2float(this.newValue);updateDouble(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^(\d)+/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateDouble(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^-/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateDouble(comp,i)}}else if(precision==true){if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^0x/)){architecture.components[comp].elements[i].value=hex2double(this.newValue);updateSimple(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^(\d)+/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateSimple(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^-/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateSimple(comp,i)}}}}this.newValue="";creator_ga("data","data.change","data.change.register_value");creator_ga("data","data.change","data.change.register_value_"+elem)},debounce:_.debounce((function(param,e){console_log(param);console_log(e);e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var re=new RegExp("'","g");e=e.replace(re,'"');re=new RegExp("[\f]","g");e=e.replace(re,"\\f");re=new RegExp("[\n]","g");e=e.replace(re,"\\n");re=new RegExp("[\r]","g");e=e.replace(re,"\\r");re=new RegExp("[\t]","g");e=e.replace(re,"\\t");re=new RegExp("[\v]","g");e=e.replace(re,"\\v");if(e==""){this[param]=null;return}console_log("this."+param+"= '"+e+"'");eval("this."+param+"= '"+e+"'");app.$forceUpdate()}),getDebounceTime())},template:'<b-popover :target="target" '+'           triggers="click blur">'+"  <template v-slot:title>"+'    <b-button @click="closePopover" class="close" aria-label="Close">'+'      <span class="d-inline-block" aria-hidden="true">&times;</span>'+"    </b-button>"+"    {{register.name.join(' | ')}}"+"  </template>"+""+'  <table class="table table-bordered table-sm popoverText">'+"    <tbody>"+"      <tr>"+"        <td>Hex.</td>"+"        <td>"+'          <b-badge class="registerPopover">'+'            {{"0x"+ bin2hex(float2bin(register.value))}}'+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>Binary</td>"+"        <td>"+'          <b-badge class="registerPopover">'+"            {{float2bin(register.value)}}"+"        </b-badge>"+"      </td>"+"      </tr>"+"      <tr>"+"        <td>Signed</td>"+"        <td>"+'          <b-badge class="registerPopover">'+"            {{parseInt(register.value.toString(), 10) >> 0}}"+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>Unsig.</td>"+"        <td>"+'          <b-badge class="registerPopover">'+"            {{parseInt(register.value.toString(), 10) >>> 0}}"+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>IEEE 754</td>"+"        <td>"+'          <b-badge class="registerPopover">'+"            {{register.value}}"+"          </b-badge>"+"        </td>"+"      </tr>"+"    </tbody>"+"  </table>"+""+'  <div class="col-lg-12 col-sm-12 row mx-0">'+'    <div class="col-lg-6 col-sm-6 popoverFooter">'+"      <b-form-input v-on:input=\"debounce('newValue', $event)\" "+'                    :value="newValue" '+'                    type="text" '+'                    size="sm" '+'                    title="New Register Value" '+'                    placeholder="Enter new value">'+"      </b-form-input>"+"    </div>"+'    <div class="col-lg-6 col-sm-6 popoverFooter">'+'      <b-button class="btn btn-primary btn-block btn-sm" '+'                @click="updateReg(component.index, register.name, architecture.components[component.index].type, architecture.components[component.index].double_precision)">'+"        Update"+"      </b-button>"+"    </div>"+"  </div>"+"</b-popover>"};Vue.component("popover-register-float",uielto_register_float_popover);var uielto_register_double_popover={props:{target:{type:String,required:true},component:{type:Object,required:true},register:{type:Object,required:true}},data:function(){return{newValue:""}},methods:{closePopover(){this.$root.$emit("bv::hide::popover")},updateReg(comp,elem,type,precision){for(var i=0;i<architecture.components[comp].elements.length;i++){if(type=="integer"||type=="control"){if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^0x/)){var value=this.newValue.split("x");if(value[1].length*4>architecture.components[comp].elements[i].nbits){value[1]=value[1].substring((value[1].length*4-architecture.components[comp].elements[i].nbits)/4,value[1].length)}architecture.components[comp].elements[i].value=bi_intToBigInt(value[1],16)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^(\d)+/)){architecture.components[comp].elements[i].value=bi_intToBigInt(this.newValue,10)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^-/)){architecture.components[comp].elements[i].value=bi_intToBigInt(this.newValue,10)}}else if(type=="floating point"){if(precision==false){if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^0x/)){architecture.components[comp].elements[i].value=hex2float(this.newValue);updateDouble(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^(\d)+/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateDouble(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^-/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateDouble(comp,i)}}else if(precision==true){if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^0x/)){architecture.components[comp].elements[i].value=hex2double(this.newValue);updateSimple(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^(\d)+/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateSimple(comp,i)}else if(architecture.components[comp].elements[i].name==elem&&this.newValue.match(/^-/)){architecture.components[comp].elements[i].value=parseFloat(this.newValue,10);updateSimple(comp,i)}}}}this.newValue="";creator_ga("data","data.change","data.change.register_value");creator_ga("data","data.change","data.change.register_value_"+elem)},debounce:_.debounce((function(param,e){console_log(param);console_log(e);e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var re=new RegExp("'","g");e=e.replace(re,'"');re=new RegExp("[\f]","g");e=e.replace(re,"\\f");re=new RegExp("[\n]","g");e=e.replace(re,"\\n");re=new RegExp("[\r]","g");e=e.replace(re,"\\r");re=new RegExp("[\t]","g");e=e.replace(re,"\\t");re=new RegExp("[\v]","g");e=e.replace(re,"\\v");if(e==""){this[param]=null;return}console_log("this."+param+"= '"+e+"'");eval("this."+param+"= '"+e+"'");app.$forceUpdate()}),getDebounceTime())},template:'<b-popover :target="target" triggers="click blur">'+"  <template v-slot:title>"+'    <b-button @click="closePopover" class="close" aria-label="Close">'+'      <span class="d-inline-block" aria-hidden="true">&times;</span>'+"    </b-button>"+"    {{register.name.join(' | ')}}"+"  </template>"+""+'  <table class="table table-bordered table-sm popoverText">'+"    <tbody>"+"      <tr>"+"        <td>Hex.</td>"+"        <td>"+'          <b-badge class="registerPopover">'+'            {{"0x"+ bin2hex(double2bin(register.value))}}'+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>Binary</td>"+"        <td>"+'          <b-badge class="registerPopover">'+"            {{double2bin(register.value)}}"+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>Signed</td>"+"        <td>"+'          <b-badge class="registerPopover">'+"            {{parseInt(register.value.toString(), 10) >> 0}}"+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>Unsig.</td>"+"        <td>"+'          <b-badge class="registerPopover">'+"            {{parseInt(register.value.toString(), 10) >>> 0}}"+"          </b-badge>"+"        </td>"+"      </tr>"+"      <tr>"+"        <td>IEEE 754</td>"+"        <td>"+'          <b-badge class="registerPopover">'+"          {{register.value}}"+"        </b-badge>"+"      </td>"+"      </tr>"+"    </tbody>"+"  </table>"+""+'  <div class="col-lg-12 col-sm-12 row mx-0">'+'    <div class="col-lg-6 col-sm-6 popoverFooter">'+"      <b-form-input v-on:input=\"debounce('newValue', $event)\" "+'                    :value="newValue" '+'                    type="text" '+'                    size="sm" '+'                    title="New Register Value" '+'                    placeholder="Enter new value">'+"      </b-form-input>"+"    </div>"+'    <div class="col-lg-6 col-sm-6 popoverFooter">'+'      <b-button class="btn btn-primary btn-block btn-sm" '+'                @click="updateReg(component.index, register.name, architecture.components[component.index].type, architecture.components[component.index].double_precision)">'+"        Update"+"      </b-button>"+"    </div>"+"  </div>"+"</b-popover>"};Vue.component("popover-register-double",uielto_register_double_popover);var uielto_memory={props:{main_memory:{type:Array,required:true},memory_segment:{type:String,required:true},track_stack_names:{type:Array,required:true},callee_subrutine:{type:String,required:true},caller_subrutine:{type:String,required:true}},data:function(){return{memFields:["Tag","Address","Binary","Value"]}},methods:{filter(row,filter){if(this.memory_segment=="instructions_memory"&&(row.addr>=architecture.memory_layout[0].value&&row.addr<=architecture.memory_layout[1].value)){if(row.hide==true){return false}else{return true}}if(this.memory_segment=="data_memory"&&(row.addr>=architecture.memory_layout[2].value&&row.addr<=architecture.memory_layout[3].value)){return true}if(this.memory_segment=="stack_memory"&&row.addr>=architecture.memory_layout[3].value){return Math.abs(row.addr-app._data.end_callee)<40}},select_data_type(record,index){if(this.memory_segment=="instructions_memory"){return}if(this.memory_segment=="data_memory"){if(this.check_tag_null(record.hex)){app._data.row_index=index;app.$refs["space_modal"].show()}}if(this.memory_segment=="stack_memory"){app._data.row_index=index;app.$refs["stack_modal"].show()}},check_tag_null(record){for(var i=0;i<record.length;i++){if(record[i].tag!=null){return true}}return false},get_classes(row){return{"h6Sm                ":row.item.addr>=architecture.memory_layout[0].value&&row.item.addr<=architecture.memory_layout[3].value,"h6Sm text-secondary ":row.item.addr<app._data.end_callee&&Math.abs(row.item.addr-app._data.end_callee)<40,"h6Sm text-success   ":row.item.addr<app._data.begin_callee&&row.item.addr>=app._data.end_callee,"h6Sm text-blue-funny":row.item.addr<app._data.begin_caller&&row.item.addr>=app._data.end_caller,"h6Sm                ":row.item.addr>=app._data.begin_caller}}},computed:{main_memory_items(){return Object.entries(this.main_memory).sort(((a,b)=>a[0]-b[0])).map((a=>a[1]))}},template:'\t<div class="col-lg-12 col-sm-12 px-0">'+""+'<span class="container">'+'  <b-row align-v="start">'+'  <b-col style="min-height:35vh !important;">'+" "+"\t  <b-table sticky-header "+"\t           striped "+"\t           small "+"\t           hover "+'\t           :items="main_memory_items" '+'\t           :fields="memFields" '+"\t           :filter-function=filter "+'\t           filter=" " '+'\t           class="memory_table align-items-start" '+'\t           @row-clicked="select_data_type">'+"\t"+'\t    <template v-slot:head(Tag)="row">'+"\t      &nbsp;"+"\t    </template>"+"\t"+'\t    <template v-slot:cell(Tag)="row">'+'\t      <div v-for="item in architecture_hash">'+'\t        <div v-for="item2 in architecture.components[item.index].elements">'+'\t          <b-badge variant="info" '+'\t                   class="border border-info shadow memoryTag" '+"\t                   v-if=\"item2.properties.includes('pointer') && item2.properties.includes('data') && ((parseInt(item2.value) & 0xFFFFFFFC) == (row.item.addr & 0xFFFFFFFC))\">"+"\t            {{item2.name[0]}}"+"\t          </b-badge>"+'\t          <span class="fas fa-long-arrow-alt-right" '+"\t                v-if=\"item2.properties.includes('pointer') && item2.properties.includes('data') && ((parseInt(item2.value) & 0xFFFFFFFC) == (row.item.addr & 0xFFFFFFFC))\">"+"\t          </span>"+'\t          <b-badge variant="success" '+'\t                   class="border border-success shadow memoryTag" '+"\t                   v-if=\"item2.properties.includes('pointer') && item2.properties.includes('code') && ((parseInt(item2.value) & 0xFFFFFFFC) == (row.item.addr & 0xFFFFFFFC))\">"+"\t            {{item2.name[0]}}"+"\t          </b-badge>"+'\t          <span class="fas fa-long-arrow-alt-right" '+"\t                v-if=\"item2.properties.includes('pointer') && item2.properties.includes('code') && ((parseInt(item2.value) & 0xFFFFFFFC) == (row.item.addr & 0xFFFFFFFC))\">"+"\t          </span>"+'\t          <b-badge variant="info" '+'\t                   class="border border-info shadow memoryTag" '+"\t                   v-if=\"item2.properties.includes('pointer') && (item2.properties.includes('stack') || item2.properties.includes('frame'))&& ((parseInt(item2.value) & 0xFFFFFFFC) == (row.item.addr & 0xFFFFFFFC))\">"+"\t            {{item2.name[0]}}"+"\t          </b-badge>"+'\t          <span class="fas fa-long-arrow-alt-right" '+"\t                v-if=\"item2.properties.includes('pointer') && (item2.properties.includes('stack') || item2.properties.includes('frame') )&& ((parseInt(item2.value) & 0xFFFFFFFC) == (row.item.addr & 0xFFFFFFFC))\">"+"\t          </span>"+"\t"+"\t        </div>"+"\t      </div>"+"\t    </template>"+"\t"+'\t    <template v-slot:cell(Address)="row">'+'             <span class="h6Sm" v-bind:class="get_classes(row)">'+"\t        {{row.item.addr_begin}} - {{row.item.addr_end}}"+"\t      </span>"+"\t    </template>"+"\t"+'\t    <template v-slot:cell(Binary)="row">'+'             <span class="h6Sm" v-bind:class="get_classes(row)">'+' \t\t<span v-for="item in row.item.hex">'+""+'\t        \t<span v-if="item.tag == null">'+"\t          \t{{item.byte.toUpperCase()}}"+"\t        \t</span> "+""+'\t        \t<b-badge pill variant="info" '+'\t          \t       class="border border-info shadow binaryTag" '+'\t            \t       v-if="item.tag != null">'+"\t          \t{{item.tag}}"+"\t        \t</b-badge>"+'\t        \t<br   v-if="item.tag != null">'+'\t        \t<span v-if="item.tag != null" class="memoryBorder">'+"\t          \t{{item.byte.toUpperCase()}}"+"\t        \t</span> "+""+" \t\t</span>"+"\t      </span>"+"\t    </template>"+"\t"+'\t    <template v-slot:cell(Value)="row">'+'             <span class="h6Sm" v-bind:class="get_classes(row)">'+"               {{row.item.value}}"+'\t        <span class="fas fa-eye memoryValue" '+'\t              v-if="row.item.eye && check_tag_null(row.item.hex)">'+"\t        </span>"+"\t    </template>"+"         </b-table>"+""+"  </b-col>"+"  </b-row>"+""+'  <b-row align-v="end">'+"  <b-col>"+""+'  <div class="col-lg-12 col-sm-12 row mx-0 px-2 border" v-if="memory_segment == \'stack_memory\'">'+'  \t<span class="col-lg-12 col-sm-12 my-1">'+"       <span>Stack memory keys:</span>"+"  \t</span>"+""+'  \t<span class="badge badge-white border border-secondary text-secondary mx-1 col">Free <br>stack</span>'+'  \t<span class="badge badge-white border border-secondary text-success mx-1">Callee: <br>{{callee_subrutine}}</span>'+'  \t<span class="badge badge-white border border-secondary text-info mx-1" v-if="track_stack_names.length > 1">Caller: <br>{{caller_subrutine}}</span>'+'  \t<span class="badge badge-white border border-secondary text-dark mx-1" v-if="track_stack_names.length > 2" align-v="center"><b>&bull;&bull;&bull;<br>{{track_stack_names.length - 2}}</b></span>'+'  \t<span class="badge badge-white border border-secondary text-dark mx-1">System <br>stack</span>'+"  </div>"+""+"  </b-col>"+"  </b-row>"+"</span>"+""+" </div>"};Vue.component("table-mem",uielto_memory);var uielto_stats={props:{data_mode:{type:String,required:true},stats:{type:Array,required:true},stats_value:{type:Number,required:true}},template:'\t<div class="col-lg-12 col-sm-12" id="stats" v-if="data_mode == \'stats\'">'+'\t  <div class="col-lg-12 col-sm-12">'+"\t"+'\t    <b-tabs content-class="mt-3">'+'\t      <b-tab title="Graphic" active>'+'\t        <plot-stats :stats_value="stats_value"></plot-stats> '+"\t      </b-tab>"+"\t"+'\t      <b-tab title="Table">'+'\t        <table-stats :stats="stats"></table-stats>'+"\t      </b-tab>"+"\t    </b-tabs>"+"\t  </div>"+"\t</div>"};Vue.component("stats",uielto_stats);var uielto_stats_plot={components:{apexchart:VueApexCharts},props:{stats_value:{type:Number,required:true}},data:function(){return{chartOptions:{colors:["red","blue","yellow","purple","green","orange","gray","pink","teal","black","lime","indigo","cyan"],chart:{id:"graphic",type:"donut"},labels:["Arithmetic integer","Arithmetic floating point","Logic","Transfer between registers","Memory access","Comparison","I/O","Syscall","Control","Function call","Conditional bifurcation","Unconditional bifurcation","Other"],dataLabels:{enabled:true},donut:{labels:{show:true,total:{show:true,showAlways:true,label:"Total"}}},fill:{type:"gradient",gradient:{shade:"dark",type:"horizontal",shadeIntensity:.5,gradientToColors:undefined,inverseColors:true,opacityFrom:1,opacityTo:1,stops:[0,50,100],colorStops:[]},colors:["red","blue","yellow","purple","green","orange","gray","pink","teal","black","lime","indigo","cyan"]},legend:{formatter:function(val,opts){return val+" - "+opts.w.globals.series[opts.seriesIndex]}},plotOptions:{pie:{donut:{labels:{show:true,total:{show:true,showAlways:true,color:"black",formatter:function(w){return w.globals.seriesTotals.reduce(((a,b)=>a+b),0)}}}}}}}}},template:' <div id="chart" class="stats">'+'\t\t<apexchart id="graphic" '+'\t  \t\t       ref="chart" '+'\t             type="donut" '+'\t             :options="chartOptions" '+'\t             :series="stats_value" '+'\t             height="150%" >'+"\t  </apexchart>"+"\t</div>"};Vue.component("plot-stats",uielto_stats_plot);var uielto_stats_table={props:{stats:{type:Array,required:true}},data:function(){return{statsFields:{type:{label:"Type",sortable:true},number_instructions:{label:"Number of instructions",sortable:true},percentage:{label:"Percentage",sortable:true}}}},template:"\t<b-table striped "+"\t small "+"\t hover "+'\t :items="stats" '+'\t :fields="statsFields" '+'\t class="stats text-center">'+"\t<b-table>"};Vue.component("table-stats",uielto_stats_table);var uielto_monitor={props:{display:{type:String,required:true}},template:'\t<div class="col-rt-12 col-lg-6 col-sm-12 my-2 mx-0 nopadding">'+'\t  <div class="row col-lg-12 col-sm-12 mx-0 pl-0 nopadding">'+'\t    <div class="col-lg-1 col-sm-1">'+'\t      <span class="fas fa-desktop fa-2x mb-2 consoleIcon"></span>'+"\t    </div>"+'\t    <div class="col-lg-11 col-sm-11 pr-0">'+'\t      <b-form-textarea id="textarea_display" '+'\t                       v-model="display" '+'\t                       rows="5" '+"\t                       disabled "+"\t                       no-resize "+'\t                       title="Display">'+"\t      </b-form-textarea>"+"\t    </div>"+"\t  </div>"+"\t</div>"};Vue.component("monitor",uielto_monitor);var uielto_keyboard={props:{keyboard:{type:String,required:true},enter:{type:String,required:true}},methods:{consoleClear(){app._data.keyboard="";app._data.display=""},consoleEnter(){if(keyboard!=""){consoleMutex=true}},debounce:_.debounce((function(param,e){console_log(param);console_log(e);e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var re=new RegExp("'","g");e=e.replace(re,'"');re=new RegExp("[\f]","g");e=e.replace(re,"\\f");re=new RegExp("[\n]","g");e=e.replace(re,"\\n");re=new RegExp("[\r]","g");e=e.replace(re,"\\r");re=new RegExp("[\t]","g");e=e.replace(re,"\\t");re=new RegExp("[\v]","g");e=e.replace(re,"\\v");if(e==""){this[param]=null;return}console_log("this."+param+"= '"+e+"'");eval("this."+param+"= '"+e+"'");app.$forceUpdate()}),getDebounceTime())},template:'\t<div class="col-rt-12 col-lg-6 col-sm-12 my-2 mx-0 nopadding">'+'\t  <div class="row col-lg-12 col-sm-12 mx-0 pl-0 nopadding">'+'\t    <div class="col-lg-1 col-sm-1">'+'\t      <span class="fa fa-keyboard fa-2x mb-2 consoleIcon"></span>'+"\t    </div>"+'\t    <div class="col-lg-11 col-sm-11 pr-0">'+'\t      <b-form-textarea id="textarea_keyboard" '+"\t                       v-on:input=\"debounce('keyboard', $event)\" "+'\t                       :value="keyboard" rows="5" '+'\t                       no-resize :state = "enter" '+'\t                       title="Keyboard">'+"\t      </b-form-textarea>"+"\t    </div>"+"\t  </div>"+"\t"+'\t  <div class="col-lg-12 col-sm-12 row nomargin">'+'\t    <div class="col-lg-4 col-sm-4">'+"\t     "+"\t    </div>"+'\t    <div class="col-lg-4 col-sm-4">'+'\t      <b-button class="btn btn-outline-secondary btn-block menuGroup btn-sm keyboardButton"'+'\t                @click="consoleClear">'+'\t        <span class="fas fa-broom"></span> '+"\t        Clear"+"\t      </b-button>"+"\t    </div>"+'\t    <div class="col-lg-4 col-sm-4">'+'\t      <b-button id="enter_keyboard" '+'\t                class="btn btn-outline-secondary btn-block menuGroup btn-sm keyboardButton"'+'\t                @click="consoleEnter">'+'\t        <span class="fas fa-level-down-alt enterIcon"></span> '+"\t        Enter"+"\t      </b-button>"+"\t    </div>"+"\t"+"\t  </div>"+"\t</div>"};Vue.component("keyboard",uielto_keyboard);function getDebounceTime(){if(screen.width>768){return 500}else{return 1e3}}function show_notification(msg,type){app._data.alertMessage=msg;app._data.type=type;app.$bvToast.toast(app._data.alertMessage,{variant:app._data.type,solid:true,toaster:"b-toaster-top-center",autoHideDelay:app._data.notificationTime});var date=new Date;notifications.push({mess:app._data.alertMessage,color:app._data.type,time:date.getHours()+":"+date.getMinutes()+":"+date.getSeconds(),date:date.getDate()+"/"+(date.getMonth()+1)+"/"+date.getFullYear()});return true}function show_loading(){if(toHandler!=null){return}toHandler=setTimeout((function(){$("#loading").show();toHandler=null}),500)}function hide_loading(){if(toHandler!=null){clearTimeout(toHandler);toHandler=null}$("#loading").hide()}function btn_glow(btn_name,post_label){var buttonDec="#popoverValueContent"+btn_name+post_label;var buttonHex="#popoverValueContent"+btn_name;$(buttonDec).attr("style","background-color:#c2c2c2;");$(buttonHex).attr("style","background-color:#c2c2c2;");setTimeout((function(){$(buttonDec).attr("style","background-color:#f5f5f5;");$(buttonHex).attr("style","background-color:#f5f5f5;")}),500)}var toHandler=null;try{window.app=new Vue({el:"#app",data:{version:"",creator_mode:"load_architecture",notificationTime:1500,autoscroll:true,fontSize:15,c_debug:false,dark:false,arch_available:architecture_available,back_card:back_card,date_copy:"",showLoadArch:false,name_arch:"",description_arch:"",load_arch:"",modalDeletArch:{title:"",index:0},architecture_name:"",number_bits:32,architecture:architecture,architecture_hash:architecture_hash,name_arch_save:"",advanced_mode:true,memory_layout:["","","","","",""],modalResetMem:{title:"",element:""},align:false,archFields:["name","ID","nbits","default_value","properties","actions"],componentsTypes:componentsTypes,simple_reg:[],modalResetArch:{title:"",element:""},showNewComponent:false,showEditComponent:false,modalEditComponent:{title:"",element:""},modalDeletComp:{title:"",element:""},showNewElement:false,showEditElement:false,modalNewElement:{title:"",element:"",type:"",double_precision:"",simple1:"",simple2:""},modalEditElement:{title:"",element:"",type:"",double_precision:"",simple1:"",simple2:""},modalDeletElement:{title:"",element:""},formArchitecture:{name:"",id:"",type:"",defValue:"",properties:[],precision:""},instFields:["name","co","cop","nwords","properties","signatureRaw","fields","definition","actions"],instructionsTypes:instructionsTypes,modalViewFields:{title:"",element:"",co:"",cop:""},modalResetInst:{title:"",element:""},showNewInstruction:false,showEditInstruction:false,instructionFormPage:1,instructionFormPageLink:["#Principal","#Fields","#Syntax","#Definition","#Help"],modalEditInst:{title:"",element:"",co:"",cop:""},modalDeletInst:{title:"",element:"",index:0},formInstruction:{name:"",type:"",co:"",cop:"",nwords:1,help:"",properties:[],numfields:"1",numfieldsAux:"1",nameField:[],typeField:[],separated:[],startBitField:[],stopBitField:[],valueField:[],assignedCop:false,signature:"",signatureRaw:"",signature_definition:"",definition:""},pseudoinstFields:["name","nwords","signatureRaw","fields","definition","actions"],modalResetPseudoinst:{title:"",element:""},showNewPseudoinstruction:false,showEditPseudoinstruction:false,modalEditPseudoinst:{title:"",element:"",index:0},modalDeletPseudoinst:{title:"",element:"",index:0},formPseudoinstruction:{name:"",nwords:1,numfields:"0",numfieldsAux:"0",nameField:[],typeField:[],startBitField:[],stopBitField:[],signature:"",signatureRaw:"",signature_definition:"",definition:"",help:""},directivesFields:["name","action","size","actions"],actionTypes:actionTypes,modalResetDir:{title:"",element:""},showNewDirective:false,showEditDirective:false,modalEditDirective:{title:"",element:""},modalDeletDir:{title:"",element:""},formDirective:{name:"",action:"",size:0},fragmentData:["inm-signed","inm-unsigned","address","offset_bytes","offset_words"],example_available:example_available,example_loaded:null,load_assembly:"",save_assembly:"",modalAssemblyError:{code1:"",code2:"",code3:"",error:""},name_binary_load:"",load_binary:false,update_binary:update_binary,name_binary_save:"",assembly_code:"",alertMessage:"",type:"",notifications:notifications,browser:"",instructionsPacked:20,runExecution:false,resetBut:false,instructions:instructions,register_type:"integer",name_tab_Reg:"Decimal",name_reg:"INT Registers",reg_type:"int",register_popover:"",data_mode:"registers",newValue:"",reg_representation:"signed",reg_representation_options:[{text:"Signed",value:"signed"},{text:"Unsigned",value:"unsigned"},{text:"IEEE 754",value:"decimal"},{text:"Hexadecimal",value:"hex"}],reg_name_representation:"logical",reg_name_representation_options:[{text:"Name",value:"logical"},{text:"Alias",value:"alias"},{text:"All",value:"all"}],memory:memory,memory_hash:["data_memory","instructions_memory","stack_memory"],main_memory:{},row_index:null,selected_space_view:null,selected_stack_view:null,track_stack_names:track_stack_names,callee_subrutine:"",caller_subrutine:"",stack_pointer:0,begin_caller:0,end_caller:0,begin_callee:0,end_callee:0,totalStats:totalStats,stats:stats,stats_value:stats_value,display:"",keyboard:"",enter:null},created(){this.load_num_version();this.load_arch_available();this.detectBrowser()},mounted(){this.backupCopyModal();this.verifyBrowser();this.get_configuration();var url_hash=creator_preload_get2hash(window.location);creator_preload_fromHash(this,url_hash)},beforeUpdate(){this.get_dark_mode()},methods:{load_num_version(){$.getJSON("package.json",(function(cfg){creator_information=cfg;app._data.version=cfg.version}))},verifyBrowser(){if(navigator.userAgent.indexOf("OPR")>-1){this.$refs.browser.show()}else if(navigator.userAgent.indexOf("MIE")>-1){this.$refs.browser.show()}else if(navigator.userAgent.indexOf("Edge")>-1){this.$refs.browser.show()}else if(navigator.userAgent.indexOf("Chrome")>-1){return}else if(navigator.userAgent.indexOf("Safari")>-1){return}else if(navigator.userAgent.indexOf("Firefox")>-1){return}else{this.$refs.browser.show()}},get_configuration(){if(localStorage.getItem("instructionsPacked")!=null){this.instructionsPacked=parseInt(localStorage.getItem("instructionsPacked"))}if(localStorage.getItem("autoscroll")!=null){this.autoscroll=localStorage.getItem("autoscroll")==="true"}if(localStorage.getItem("notificationTime")!=null){this.notificationTime=parseInt(localStorage.getItem("notificationTime"))}},get_dark_mode(){if(localStorage.getItem("dark_mode")!=null){document.getElementsByTagName("body")[0].style=localStorage.getItem("dark_mode");if(localStorage.getItem("dark_mode")==""){app._data.dark=false}else{app._data.dark=true}}else{var default_style=window.matchMedia("(prefers-color-scheme: dark)").matches;if(default_style==true){document.getElementsByTagName("body")[0].style="filter: invert(88%) hue-rotate(160deg) !important; background-color: #111 !important;";app._data.dark=true}else{document.getElementsByTagName("body")[0].style="";app._data.dark=false}}},change_UI_mode(e){if(app._data.creator_mode!=e){if(app._data.creator_mode=="architecture"){app._data.advanced_mode=true}if(textarea_assembly_editor!=null&&e!="assembly"){app._data.assembly_code=textarea_assembly_editor.getValue();code_assembly=textarea_assembly_editor.getValue();codemirrorHistory=textarea_assembly_editor.getHistory();textarea_assembly_editor.toTextArea()}app._data.register_popover="";if(e=="architecture"){$(".loading").show();setTimeout((function(){app._data.creator_mode=e;app.$forceUpdate();$(".loading").hide()}),50);return}app._data.creator_mode=e;if(e=="assembly"){setTimeout((function(){codemirrorStart();if(codemirrorHistory!=null){textarea_assembly_editor.setHistory(codemirrorHistory);textarea_assembly_editor.undo()}textarea_assembly_editor.setValue(code_assembly);if(app._data.update_binary!=""){$("#divAssembly").attr("class","col-lg-10 col-sm-12");$("#divTags").attr("class","col-lg-2 col-sm-12");$("#divTags").show()}}),50)}app.$forceUpdate()}},changeToSeparateValue(val,pos){if(val){this.formInstruction.startBitField[pos]=[0];this.formInstruction.stopBitField[pos]=[0];if(this.formInstruction.typeField[pos]=="co")this.formInstruction.co=["0"]}else{this.formInstruction.startBitField[pos]=0;this.formInstruction.stopBitField[pos]=0;if(this.formInstruction.typeField[pos]=="co")this.formInstruction.co="0"}},addMoreFieldsToSeparateValues(event,pos){this.formInstruction.startBitField[pos].push(0);this.formInstruction.stopBitField[pos].push(0);if(this.formInstruction.typeField[pos]=="co")this.formInstruction.co.push("0");app.$forceUpdate()},lessFieldsToSeparateValues(event,pos){this.formInstruction.startBitField[pos].pop();this.formInstruction.stopBitField[pos].pop();if(this.formInstruction.typeField[pos]=="co")this.formInstruction.co.pop();app.$forceUpdate()},load_arch_available(){$.getJSON("architecture/available_arch.json"+"?v="+(new Date).getTime(),(function(cfg){architecture_available=cfg;if(typeof Storage!=="undefined"){if(localStorage.getItem("load_architectures_available")!=null){var auxArch=localStorage.getItem("load_architectures_available");var aux=JSON.parse(auxArch);for(var i=0;i<aux.length;i++){architecture_available.push(aux[i]);load_architectures_available.push(aux[i]);var auxArch2=localStorage.getItem("load_architectures");var aux2=JSON.parse(auxArch2);load_architectures.push(aux2[i])}}}app._data.arch_available=architecture_available;for(var i=0;i<architecture_available.length;i++){back_card.push({name:architecture_available[i].name,background:"default"})}}))},change_background(name,type){if(type==1){for(var i=0;i<back_card.length;i++){if(name==back_card[i].name){back_card[i].background="secondary"}else{back_card[i].background="default"}}}if(type==0){for(var i=0;i<back_card.length;i++){back_card[i].background="default"}}},backupCopyModal(){if(typeof Storage!=="undefined"){if(localStorage.getItem("architecture_copy")!=null&&localStorage.getItem("assembly_copy")!=null&&localStorage.getItem("date_copy")!=null){this.date_copy=localStorage.getItem("date_copy");this.$refs.copyRef.show()}}},load_arch_select_aux(ename,cfg,load_associated_examples,e){var auxArchitecture=cfg;architecture=register_value_deserialize(auxArchitecture);app._data.architecture=architecture;architecture_hash=[];for(i=0;i<architecture.components.length;i++){architecture_hash.push({name:architecture.components[i].name,index:i});app._data.architecture_hash=architecture_hash}backup_stack_address=architecture.memory_layout[4].value;backup_data_address=architecture.memory_layout[3].value;app._data.architecture_name=ename;app.change_UI_mode("simulator");app.change_data_view("registers","int");app.$forceUpdate();if(load_associated_examples&&typeof e.examples!=="undefined"){app.load_examples_available(e.examples[0])}},load_arch_select(e){var i=-1;show_loading();for(i=0;i<load_architectures.length;i++){if(e.name==load_architectures[i].id){var auxArchitecture=JSON.parse(load_architectures[i].architecture);app.load_arch_select_aux(e.name,auxArchitecture,true,e);hide_loading();show_notification("The selected architecture has been loaded correctly","success");creator_ga("architecture","architecture.loading","architectures.loading.customized"+e.name);return}}$.getJSON("architecture/"+e.name+".json"+"?v="+(new Date).getTime(),(function(cfg){app.load_arch_select_aux(e.name,cfg,true,e);hide_loading();show_notification("The selected architecture has been loaded correctly","success");creator_ga("architecture","architecture.loading","architectures.loading.customized")})).fail((function(){hide_loading();show_notification("The selected architecture is not currently available","info")}))},read_arch(e){show_loading();e.preventDefault();if(!this.name_arch||!this.load_arch){hide_loading();show_notification("Please complete all fields","danger");return}this.showLoadArch=false;var file;var reader;var files=document.getElementById("arch_file").files;for(var i=0;i<files.length;i++){file=files[i];reader=new FileReader;reader.onloadend=onFileLoaded;reader.readAsBinaryString(file)}function onFileLoaded(event){architecture_available.push({name:app._data.name_arch,img:"./images/personalized_logo.png",alt:app._data.name_arch+" logo",id:"select_conf"+app._data.name_arch,description:app._data.description_arch});load_architectures_available.push({name:app._data.name_arch,img:"./images/personalized_logo.png",alt:app._data.name_arch+" logo",id:"select_conf"+app._data.name_arch,description:app._data.description_arch});back_card.push({name:architecture_available[architecture_available.length-1].name,background:"default"});load_architectures.push({id:app._data.name_arch,architecture:event.currentTarget.result});if(typeof Storage!=="undefined"){var auxArch=JSON.stringify(load_architectures,null,2);localStorage.setItem("load_architectures",auxArch);auxArch=JSON.stringify(load_architectures_available,null,2);localStorage.setItem("load_architectures_available",auxArch)}show_notification("The selected architecture has been loaded correctly","success");app._data.name_arch="";app._data.description_arch="";app._data.load_arch="";hide_loading()}},new_arch(){app.change_UI_mode("simulator");app.change_data_view("registers","int");app.$forceUpdate();hide_loading()},default_arch(item){for(var i=0;i<load_architectures_available.length;i++){if(load_architectures_available[i].name==item){return true}}return false},modal_remove_cache_arch(index,elem,button){this.modalDeletArch.title="Delete Architecture";this.modalDeletArch.index=index;this.$root.$emit("bv::show::modal","modalDeletArch",button)},remove_cache_arch(index){var id=architecture_available[index].name;for(var i=0;i<load_architectures.length;i++){if(load_architectures[i].id==id){load_architectures.splice(i,1)}}for(var i=0;i<load_architectures_available.length;i++){if(load_architectures_available[i].name==id){load_architectures_available.splice(i,1)}}architecture_available.splice(index,1);var auxArch=JSON.stringify(load_architectures,null,2);localStorage.setItem("load_architectures",auxArch);auxArch=JSON.stringify(load_architectures_available,null,2);localStorage.setItem("load_architectures_available",auxArch);show_notification("Architecture deleted successfully","success")},arch_save(){var auxObject=jQuery.extend(true,{},architecture);var auxArchitecture=register_value_serialize(auxObject);auxArchitecture.components.forEach(((c,i)=>{c.elements.forEach(((e,j)=>{if(e.default_value)e.value=e.default_value;else e.value="0"}))}));var textToWrite=JSON.stringify(auxArchitecture,null,2);var textFileAsBlob=new Blob([textToWrite],{type:"text/json"});var fileNameToSaveAs;if(this.name_arch_save==""){fileNameToSaveAs="architecture.json"}else{fileNameToSaveAs=this.name_arch_save+".json"}var downloadLink=document.createElement("a");downloadLink.download=fileNameToSaveAs;downloadLink.innerHTML="My Hidden Link";window.URL=window.URL||window.webkitURL;downloadLink.href=window.URL.createObjectURL(textFileAsBlob);downloadLink.onclick=destroyClickedElement;downloadLink.style.display="none";document.body.appendChild(downloadLink);downloadLink.click();show_notification("Save architecture","success")},change_mode(){if(app._data.advanced_mode==false){app._data.advanced_mode=true}else{app._data.advanced_mode=false}},resetMemModal(elem,button){this.modalResetMem.title="Reset memory layout";this.modalResetMem.element=elem;this.$root.$emit("bv::show::modal","modalResetMem",button)},resetMemory(arch){show_loading();for(var i=0;i<load_architectures.length;i++){if(arch==load_architectures[i].id){var auxArch=JSON.parse(load_architectures[i].architecture);var auxArchitecture=register_value_deserialize(auxArch);architecture.memory_layout=auxArchitecture.memory_layout;app._data.architecture=architecture;hide_loading();show_notification("The memory layout has been reset correctly","success");return}}$.getJSON("architecture/"+arch+".json",(function(cfg){var auxArchitecture=cfg;var auxArchitecture2=register_value_deserialize(auxArchitecture);architecture.memory_layout=auxArchitecture2.memory_layout;app._data.architecture=architecture;hide_loading();show_notification("The memory layout has been reset correctly","success")}))},changeMemoryLayout(){var auxMemoryLayout=jQuery.extend(true,{},architecture.memory_layout);for(var i=0;i<this.memory_layout.length;i++){if(this.memory_layout[i]!=""&&this.memory_layout[i]!=null){if(!isNaN(parseInt(this.memory_layout[i]))){auxMemoryLayout[i].value=parseInt(this.memory_layout[i]);if(auxMemoryLayout[i].value<0){show_notification("The value can not be negative","danger");return}}else{show_notification("The value must be a number","danger");return}}}for(var i=0;i<6;i++){for(var j=i;j<6;j++){if(auxMemoryLayout[i].value>auxMemoryLayout[j].value){show_notification("The segment can not be overlap","danger");return}}}for(var i=0;i<6;i++){architecture.memory_layout[i].value=auxMemoryLayout[i].value}app._data.architecture=architecture;backup_stack_address=architecture.memory_layout[4].value;backup_data_address=architecture.memory_layout[3].value;for(var i=0;i<6;i++){app._data.memory_layout[i]=""}app.$forceUpdate()},element_id(name,type,double){var id=0;for(var i=0;i<architecture.components.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){if(architecture.components[i].elements[j].name==name){return id}if(architecture.components[i].type==type&&architecture.components[i].double_precision==double){id++}}}},resetArchModal(elem,button){this.modalResetArch.title="Reset "+elem+" registers";this.modalResetArch.element=elem;this.$root.$emit("bv::show::modal","modalResetArch",button)},resetArchitecture(arch){show_loading();for(var i=0;i<load_architectures.length;i++){if(arch==load_architectures[i].id){var auxArch=JSON.parse(load_architectures[i].architecture);var auxArchitecture=register_value_deserialize(auxArch);architecture.components=auxArchitecture.components;app._data.architecture=architecture;architecture_hash=[];for(var i=0;i<architecture.components.length;i++){architecture_hash.push({name:architecture.components[i].name,index:i});app._data.architecture_hash=architecture_hash}hide_loading();show_notification("The registers has been reset correctly","success");return}}$.getJSON("architecture/"+arch+".json",(function(cfg){var auxArchitecture=cfg;var auxArchitecture2=register_value_deserialize(auxArchitecture);architecture.components=auxArchitecture2.components;app._data.architecture=architecture;architecture_hash=[];for(var i=0;i<architecture.components.length;i++){architecture_hash.push({name:architecture.components[i].name,index:i});app._data.architecture_hash=architecture_hash}hide_loading();show_notification("The registers has been reset correctly","success")}))},newComponentVerify(evt){evt.preventDefault();if(!this.formArchitecture.name||!this.formArchitecture.type){show_notification("Please complete all fields","danger")}else{this.newComponent()}},newComponent(){for(var i=0;i<architecture_hash.length;i++){if(this.formArchitecture.name==architecture_hash[i].name){show_notification("The component already exists","danger");return}}this.showNewComponent=false;var precision=false;if(this.formArchitecture.precision=="precision"){precision=true}var newComp={name:this.formArchitecture.name,type:this.formArchitecture.type,double_precision:precision,elements:[]};architecture.components.push(newComp);var newComponentHash={name:this.formArchitecture.name,index:architecture_hash.length};architecture_hash.push(newComponentHash)},editCompModal(comp,index,button){this.modalEditComponent.title="Edit Component";this.modalEditComponent.element=comp;this.formArchitecture.name=comp;this.$root.$emit("bv::show::modal","modalEditComponent",button)},editCompVerify(evt,comp){evt.preventDefault();if(!this.formArchitecture.name){show_notification("Please complete all fields","danger")}else{this.editComponent(comp)}},editComponent(comp){for(var i=0;i<architecture_hash.length;i++){if(this.formArchitecture.name==architecture_hash[i].name&&comp!=this.formArchitecture.name){show_notification("The component already exists","danger");return}}this.showEditComponent=false;for(var i=0;i<architecture_hash.length;i++){if(comp==architecture_hash[i].name){architecture_hash[i].name=this.formArchitecture.name;architecture.components[i].name=this.formArchitecture.name}}this.formArchitecture.name=""},delCompModal(elem,button){this.modalDeletComp.title="Delete Component";this.modalDeletComp.element=elem;this.$root.$emit("bv::show::modal","modalDeletComp",button)},delComponent(comp){for(var i=0;i<architecture_hash.length;i++){if(comp==architecture_hash[i].name){architecture.components.splice(i,1);architecture_hash.splice(i,1);for(var j=0;j<architecture_hash.length;j++){architecture_hash[j].index=j}}}},newElemModal(comp,index,button){this.modalNewElement.title="New element";this.modalNewElement.element=comp;this.modalNewElement.type=architecture.components[index].type;this.modalNewElement.double_precision=architecture.components[index].double_precision;this.$root.$emit("bv::show::modal","modalNewElement",button);app._data.simple_reg=[];for(var i=0;i<architecture_hash.length;i++){for(var j=0;j<architecture.components[i].elements.length&&architecture.components[i].type=="floating point"&&architecture.components[i].double_precision==false;j++){app._data.simple_reg.push({text:architecture.components[i].elements[j].name,value:architecture.components[i].elements[j].name})}}var id=0;for(var i=0;i<architecture.components.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){if(architecture.components[i].name==comp&&architecture.components[i].elements.length-1==j){id++;this.formArchitecture.id=id}if(architecture.components[i].type==architecture.components[index].type&&architecture.components[i].double_precision==architecture.components[index].double_precision){id++}}}},newElementVerify(evt,comp){if(this.formArchitecture.name.length==0||!this.formArchitecture.name){show_notification("Please complete all fields","danger")}else{if(!this.formArchitecture.defValue&&this.formArchitecture.double_precision==false){show_notification("Please complete all fields","danger")}else if(isNaN(this.formArchitecture.defValue)){show_notification("The default value must be a number","danger")}else{this.newElement(comp)}}},newElement(comp){for(var i=0;i<architecture_hash.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){for(var z=0;z<this.formArchitecture.name.length;z++){if(architecture.components[i].elements[j].name.includes(this.formArchitecture.name[z])!=false&&comp!=this.formArchitecture.name){show_notification("The element already exists","danger");return}}}}this.showNewElement=false;for(var i=0;i<architecture_hash.length;i++){if(comp==architecture_hash[i].name&&architecture.components[i].type=="integer"){var newElement={name:this.formArchitecture.name,nbits:this.number_bits,value:bi_intToBigInt(this.formArchitecture.defValue,10),default_value:bi_intToBigInt(this.formArchitecture.defValue,10),properties:this.formArchitecture.properties};architecture.components[i].elements.push(newElement);break}if(comp==architecture_hash[i].name&&architecture.components[i].type=="control"){var newElement={name:this.formArchitecture.name,nbits:this.number_bits,value:bi_intToBigInt(this.formArchitecture.defValue,10),default_value:bi_intToBigInt(this.formArchitecture.defValue,10),properties:["read","write"]};architecture.components[i].elements.push(newElement);break}if(comp==architecture_hash[i].name&&architecture.components[i].type=="floating point"&&architecture.components[i].double_precision==false){var newElement={name:this.formArchitecture.name,nbits:this.number_bits,value:parseFloat(this.formArchitecture.defValue),default_value:parseFloat(this.formArchitecture.defValue),properties:this.formArchitecture.properties};architecture.components[i].elements.push(newElement);break}if(comp==architecture_hash[i].name&&architecture.components[i].type=="floating point"&&architecture.components[i].double_precision==true){var aux_new;var aux_value;var aux_sim1;var aux_sim2;for(var a=0;a<architecture_hash.length;a++){for(var b=0;b<architecture.components[a].elements.length;b++){if(architecture.components[a].elements[b].name==this.formArchitecture.simple1){aux_sim1=this.bin2hex(this.float2bin(architecture.components[a].elements[b].default_value))}if(architecture.components[a].elements[b].name==this.formArchitecture.simple2){aux_sim2=this.bin2hex(this.float2bin(architecture.components[a].elements[b].default_value))}}}aux_value=aux_sim1+aux_sim2;aux_new=this.hex2double("0x"+aux_value);var newElement={name:this.formArchitecture.name,nbits:this.number_bits*2,value:aux_new,properties:this.formArchitecture.properties};architecture.components[i].elements.push(newElement);break}}},editElemModal(elem,comp,button){this.modalEditElement.title="Edit Element";this.modalEditElement.element=elem;this.modalEditElement.type=architecture.components[comp].type;this.modalEditElement.double_precision=architecture.components[comp].double_precision;app._data.simple_reg=[];for(var i=0;i<architecture_hash.length;i++){for(var j=0;j<architecture.components[i].elements.length&&architecture.components[i].type=="floating point"&&architecture.components[i].double_precision==false;j++){app._data.simple_reg.push({text:architecture.components[i].elements[j].name,value:architecture.components[i].elements[j].name})}}for(var j=0;j<architecture.components[comp].elements.length;j++){if(elem==architecture.components[comp].elements[j].name){this.formArchitecture.name=elem;this.formArchitecture.properties=architecture.components[comp].elements[j].properties;if(this.modalEditElement.double_precision==true){this.formArchitecture.simple1=architecture.components[comp].elements[j].simple_reg[0];this.formArchitecture.simple2=architecture.components[comp].elements[j].simple_reg[1]}else{this.formArchitecture.defValue=architecture.components[comp].elements[j].default_value.toString()}}}var id=0;for(var i=0;i<architecture.components.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){if(architecture.components[i].elements[j].name==this.formArchitecture.name){this.formArchitecture.id=id}if(architecture.components[i].type==architecture.components[comp].type&&architecture.components[i].double_precision==architecture.components[comp].double_precision){id++}}}this.$root.$emit("bv::show::modal","modalEditElement",button)},editElementVerify(evt,comp){evt.preventDefault();if(this.formArchitecture.name.length==0||!this.formArchitecture.name||!this.formArchitecture.defValue){show_notification("Please complete all fields","danger")}else if(isNaN(this.formArchitecture.defValue)){show_notification("The default value must be a number","danger")}else{this.editElement(comp)}},editElement(comp){for(var i=0;i<architecture_hash.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){for(var z=0;z<this.formArchitecture.name.length;z++){if(architecture.components[i].elements[j].name.includes(this.formArchitecture.name[z])!=false&&comp!=this.formArchitecture.name){show_notification("The element already exists","danger");return}}}}this.showEditElement=false;for(var i=0;i<architecture_hash.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){if(comp==architecture.components[i].elements[j].name){architecture.components[i].elements[j].name=this.formArchitecture.name;if(architecture.components[i].type=="control"||architecture.components[i].type=="integer"){architecture.components[i].elements[j].default_value=bi_intToBigInt(this.formArchitecture.defValue,10)}else{if(architecture.components[i].double_precision==false){architecture.components[i].elements[j].default_value=parseFloat(this.formArchitecture.defValue,10)}else{var aux_value;var aux_sim1;var aux_sim2;for(var a=0;a<architecture_hash.length;a++){for(var b=0;b<architecture.components[a].elements.length;b++){if(architecture.components[a].elements[b].name==this.formArchitecture.simple1){aux_sim1=this.bin2hex(this.float2bin(architecture.components[a].elements[b].value))}if(architecture.components[a].elements[b].name==this.formArchitecture.simple2){aux_sim2=this.bin2hex(this.float2bin(architecture.components[a].elements[b].value))}}}aux_value=aux_sim1+aux_sim2;architecture.components[i].elements[j].value=this.hex2double("0x"+aux_value);architecture.components[i].elements[j].simple_reg[0]=this.formArchitecture.simple1;architecture.components[i].elements[j].simple_reg[1]=this.formArchitecture.simple2}}architecture.components[i].elements[j].properties=this.formArchitecture.properties}}}},delElemModal(elem,button){this.modalDeletElement.title="Delete Element";this.modalDeletElement.element=elem;this.$root.$emit("bv::show::modal","modalDeletElement",button)},delElement(comp){for(var i=0;i<architecture_hash.length;i++){for(var j=0;j<architecture.components[i].elements.length;j++){if(comp==architecture.components[i].elements[j].name){architecture.components[i].elements.splice(j,1)}}}},emptyFormArch(){this.formArchitecture.name="";this.formArchitecture.id="";this.formArchitecture.type="";this.formArchitecture.defValue="";this.formArchitecture.properties=[];this.formArchitecture.precision=""},resetInstModal(elem,button){this.modalResetInst.title="Reset "+elem+" instructions";this.modalResetInst.element=elem;this.$root.$emit("bv::show::modal","modalResetInst",button)},resetInstructions(arch){show_loading();for(var i=0;i<load_architectures.length;i++){if(arch==load_architectures[i].id){var auxArch=JSON.parse(load_architectures[i].architecture);var auxArchitecture=register_value_deserialize(auxArch);architecture.instructions=auxArchitecture.instructions;app._data.architecture=architecture;hide_loading();show_notification("The instruction set has been reset correctly","success");return}}$.getJSON("architecture/"+arch+".json",(function(cfg){var auxArchitecture=cfg;var auxArchitecture2=register_value_deserialize(auxArchitecture);architecture.instructions=auxArchitecture2.instructions;app._data.architecture=architecture;hide_loading();show_notification("The instruction set has been reset correctly","success")}))},changeNumfield(type){if(type==0){if(this.formInstruction.numfields>this.formInstruction.nwords*32){this.formInstruction.numfieldsAux=this.formInstruction.nwords*32;this.formInstruction.numfields=this.formInstruction.nwords*32}else if(this.formInstruction.numfields<1){this.formInstruction.numfieldsAux=1;this.formInstruction.numfields=1}else{this.formInstruction.numfieldsAux=this.formInstruction.numfields}}if(type==1){if(this.formPseudoinstruction.numfields>this.formPseudoinstruction.nwords*32){this.formPseudoinstruction.numfieldsAux=this.formPseudoinstruction.nwords*32;this.formPseudoinstruction.numfields=this.formPseudoinstruction.nwords*32}else if(this.formPseudoinstruction.numfields<0){this.formPseudoinstruction.numfieldsAux=0;this.formPseudoinstruction.numfields=0}else{this.formPseudoinstruction.numfieldsAux=this.formPseudoinstruction.numfields}}},viewFielsInst(elem,co,cop,button){this.modalViewFields.title="Fields of "+elem;this.modalViewFields.element=elem;for(var i=0;i<architecture.instructions.length;i++){if(elem==architecture.instructions[i].name&&co==architecture.instructions[i].co&&cop==architecture.instructions[i].cop){this.formInstruction.name=architecture.instructions[i].name;this.formInstruction.cop=architecture.instructions[i].cop;this.formInstruction.co=architecture.instructions[i].co;app._data.modalViewFields.co=architecture.instructions[i].co;app._data.modalViewFields.cop=architecture.instructions[i].cop;this.formInstruction.numfields=architecture.instructions[i].fields.length;this.formInstruction.numfieldsAux=architecture.instructions[i].fields.length;for(var j=0;j<architecture.instructions[i].fields.length;j++){this.formInstruction.nameField[j]=architecture.instructions[i].fields[j].name;this.formInstruction.typeField[j]=architecture.instructions[i].fields[j].type;this.formInstruction.startBitField[j]=architecture.instructions[i].fields[j].startbit;this.formInstruction.stopBitField[j]=architecture.instructions[i].fields[j].stopbit;this.formInstruction.valueField[j]=architecture.instructions[i].fields[j].valueField}}}this.$root.$emit("bv::show::modal","modalViewFields",button)},newInstVerify(evt){evt.preventDefault();for(var i=0;i<this.formInstruction.nameField.length;i++){for(var j=i+1;j<this.formInstruction.nameField.length;j++){if(this.formInstruction.nameField[i]==this.formInstruction.nameField[j]){show_notification("Field name repeated","danger");return}}}var empty=0;var auxCop="";for(var z=1;z<this.formInstruction.numfields;z++){if(this.formInstruction.typeField[z]=="cop"){if(!this.formInstruction.valueField[z]){empty=1}else{if(this.formInstruction.valueField[z].length!=this.formInstruction.startBitField[z]-this.formInstruction.stopBitField[z]+1){show_notification("The length of cop should be "+(this.formInstruction.startBitField[z]-this.formInstruction.stopBitField[z]+1)+" binary numbers","danger");return}for(var i=0;i<this.formInstruction.valueField[z].length;i++){if(this.formInstruction.valueField[z].charAt(i)!="0"&&this.formInstruction.valueField[z].charAt(i)!="1"){show_notification("The value of cop must be binary","danger");return}}auxCop=auxCop+this.formInstruction.valueField[z]}}}this.formInstruction.cop=auxCop;if(typeof this.formInstruction.co!="object")for(var i=0;i<this.formInstruction.co.length;i++){if(this.formInstruction.co.charAt(i)!="0"&&this.formInstruction.co.charAt(i)!="1"){show_notification("The value of co must be binary","danger");return}}else{for(let val in this.formInstruction.co)if(!/[01]+/.test(val)){show_notification("The value of co must be binary","danger");return}}for(var i=0;i<this.formInstruction.numfields;i++){if(this.formInstruction.nameField.length<this.formInstruction.numfields||this.formInstruction.typeField.length<this.formInstruction.numfields||this.formInstruction.startBitField.length<this.formInstruction.numfields||this.formInstruction.stopBitField.length<this.formInstruction.numfields){empty=1}}if(!this.formInstruction.name||!this.formInstruction.type||!this.formInstruction.co||!this.formInstruction.nwords||!this.formInstruction.numfields||!this.formInstruction.signature_definition||!this.formInstruction.definition||empty==1){show_notification("Please complete all fields","danger")}else if(typeof this.formInstruction.co!="object"&&isNaN(this.formInstruction.co)){show_notification("The field co must be numbers","danger")}else if(typeof this.formInstruction.co==="object"&&this.formInstruction.co.some((val=>isNaN(val))))show_notification("The field co must be numbers","danger");else if(isNaN(this.formInstruction.cop)){show_notification("The field cop must be numbers","danger")}else if(typeof this.formInstruction.co!="object"&&this.formInstruction.co.length!=this.formInstruction.startBitField[0]-this.formInstruction.stopBitField[0]+1){show_notification("The length of co should be "+(this.formInstruction.startBitField[0]-this.formInstruction.stopBitField[0]+1)+" binary numbers","danger")}else if(typeof this.formInstruction.co==="object"&&this.formInstruction.co.some(((val,ind)=>val.length!==app.formInstruction.startBitField[0][ind]-app.formInstruction.stopBitField[0][ind]+1)))show_notification("The length of co don't match with the desription","danger");else{this.newInstruction()}},newInstruction(){for(var i=0;i<architecture.instructions.length;i++){if(this.formInstruction.co==architecture.instructions[i].co){if(!this.formInstruction.cop){show_notification("The instruction already exists","danger");return}}}let auxcop=(()=>this.formInstruction.co instanceof Array?this.formInstrucion.co.join(""):this.formInstruction.co)()+this.formInstruction.cop;for(var i=0;i<architecture.instructions.length;i++){if(auxcop==architecture.instructions[i].cop&&!auxcop==false){show_notification("The instruction already exists","danger");return}}this.showNewInstruction=false;this.generateSignatureInst();var signature=this.formInstruction.signature;var signatureRaw=this.formInstruction.signatureRaw;var newInstruction={name:this.formInstruction.name,type:this.formInstruction.type,signature_definition:this.formInstruction.signature_definition,signature:signature,signatureRaw:signatureRaw,co:this.formInstruction.co,cop:this.formInstruction.cop,nwords:this.formInstruction.nwords,properties:this.formInstruction.properties,help:this.formInstruction.help,fields:[],definition:this.formInstruction.definition,separated:[]};newInstruction.separated=this.formInstruction.startBitField.map(((e,i)=>this.formInstruction.separated[i]||false));architecture.instructions.push(newInstruction);for(var i=0;i<this.formInstruction.numfields;i++){var newField={name:this.formInstruction.nameField[i],type:this.formInstruction.typeField[i],startbit:!this.formInstruction.separated[i]?parseInt(this.formInstruction.startBitField[i]):this.formInstruction.startBitField[i].map((val=>parseInt(val))),stopbit:!this.formInstruction.separated[i]?parseInt(this.formInstruction.stopBitField[i]):this.formInstruction.stopBitField[i].map((val=>parseInt(val))),valueField:this.formInstruction.valueField[i]};architecture.instructions[architecture.instructions.length-1].fields.push(newField)}},editInstModal(elem,co,cop,button){this.modalEditInst.title="Edit Instruction";this.modalEditInst.element=elem;for(var i=0;i<architecture.instructions.length;i++){if(elem==architecture.instructions[i].name&&co==architecture.instructions[i].co&&cop==architecture.instructions[i].cop){this.formInstruction.name=architecture.instructions[i].name;this.formInstruction.type=architecture.instructions[i].type;this.formInstruction.cop=architecture.instructions[i].cop;this.formInstruction.co=architecture.instructions[i].co;app._data.modalEditInst.co=architecture.instructions[i].co;app._data.modalEditInst.cop=architecture.instructions[i].cop;this.formInstruction.nwords=architecture.instructions[i].nwords;this.formInstruction.numfields=architecture.instructions[i].fields.length;this.formInstruction.numfieldsAux=architecture.instructions[i].fields.length;this.formInstruction.signature_definition=architecture.instructions[i].signature_definition;this.formInstruction.definition=architecture.instructions[i].definition;this.formInstruction.help=architecture.instructions[i].help;this.formInstruction.separated=[];this.formInstruction.properties=architecture.instructions[i].properties;for(var j=0;j<architecture.instructions[i].fields.length;j++){this.formInstruction.nameField[j]=architecture.instructions[i].fields[j].name;this.formInstruction.typeField[j]=architecture.instructions[i].fields[j].type;if(typeof architecture.instructions[i].separated==="undefined"||!architecture.instructions[i].separated[j]){this.formInstruction.startBitField[j]=architecture.instructions[i].fields[j].startbit;this.formInstruction.stopBitField[j]=architecture.instructions[i].fields[j].stopbit;this.formInstruction.separated.push(false)}else{this.formInstruction.startBitField[j]=[...architecture.instructions[i].fields[j].startbit];this.formInstruction.stopBitField[j]=[...architecture.instructions[i].fields[j].stopbit];this.formInstruction.separated.push(true)}this.formInstruction.valueField[j]=architecture.instructions[i].fields[j].valueField}this.generateSignatureInst();break}}this.$root.$emit("bv::show::modal","modalEditInst",button)},editInstVerify(evt,inst,co,cop){evt.preventDefault();for(var i=0;i<this.formInstruction.nameField.length;i++){for(var j=i+1;j<this.formInstruction.nameField.length;j++){if(this.formInstruction.nameField[i]==this.formInstruction.nameField[j]){show_notification("Field name repeated","danger");return}}}var empty=0;var auxCop="";for(var z=1;z<this.formInstruction.numfields;z++){if(this.formInstruction.typeField[z]=="cop"){if(!this.formInstruction.valueField[z]){empty=1}else{if(this.formInstruction.valueField[z].length!=this.formInstruction.startBitField[z]-this.formInstruction.stopBitField[z]+1){show_notification("The length of cop should be "+(this.formInstruction.startBitField[z]-this.formInstruction.stopBitField[z]+1)+" binary numbers","danger");return}for(var i=0;i<this.formInstruction.valueField[z].length;i++){if(this.formInstruction.valueField[z].charAt(i)!="0"&&this.formInstruction.valueField[z].charAt(i)!="1"){show_notification("The value of cop must be binary","danger");return}}}auxCop=auxCop+this.formInstruction.valueField[z]}}this.formInstruction.cop=auxCop;if(typeof this.formInstruction.co!=="object")for(var i=0;i<this.formInstruction.co.length;i++){if(this.formInstruction.co.charAt(i)!="0"&&this.formInstruction.co.charAt(i)!="1"){show_notification("The value of co must be binary","danger");return}}else{for(let val in this.formInstruction.co){if(!/^[01]+$/.test(val)){show_notification("The value of co must be binary","danger");return}}}for(var i=0;i<this.formInstruction.numfields;i++){if(!this.formInstruction.nameField[i]||!this.formInstruction.typeField[i]||!this.formInstruction.startBitField[i]&&this.formInstruction.startBitField[i]!=0||!this.formInstruction.stopBitField[i]&&this.formInstruction.stopBitField[i]!=0){empty=1}}if(!this.formInstruction.name||!this.formInstruction.type||!this.formInstruction.co||!this.formInstruction.nwords||!this.formInstruction.numfields||!this.formInstruction.signature_definition||!this.formInstruction.definition||empty==1){show_notification("Please complete all fields","danger")}if(typeof this.formInstruction.co!="object"&&isNaN(this.formInstruction.co)||typeof this.formInstruction.co==="object"&&this.formInstruction.co.some((val=>isNaN(val))))show_notification("The field co must be numbers","danger");else if(isNaN(this.formInstruction.cop)){show_notification("The field cop must be numbers","danger")}else if(typeof this.formInstruction.co!="object"&&this.formInstruction.co.length!=this.formInstruction.startBitField[0]-this.formInstruction.stopBitField[0]+1){show_notification("The length of co should be "+(this.formInstruction.startBitField[0]-this.formInstruction.stopBitField[0]+1)+" binary numbers","danger")}else if(typeof this.formInstruction.co==="object"&&this.formInstruction.co.some(((val,ind)=>val.length!==app.formInstruction.startBitField[0][ind]-app.formInstruction.stopBitField[0][ind]+1)))show_notification("The length of co don't match with the desription","danger");else{this.editInstruction(inst,co,cop)}},editInstruction(comp,co,cop){var exCop=false;for(var z=1;z<this.formInstruction.numfields;z++){if(this.formInstruction.typeField[z]=="cop"){exCop=true}}for(var i=0;i<architecture.instructions.length;i++){if(this.formInstruction.co==architecture.instructions[i].co&&this.formInstruction.co!=co&&exCop==false){if(!this.formInstruction.cop||exCop!=true){show_notification("The instruction already exists","danger");return}}}let auxcop=(()=>this.formInstruction.co instanceof Array?this.formInstrucion.co.join(""):this.formInstruction.co)()+this.formInstruction.cop;for(var i=0;i<architecture.instructions.length&&exCop==true;i++){if(auxcop==architecture.instructions[i].cop&&!auxcop==false&&auxcop!=cop){show_notification("The instruction already exists","danger");return}}this.showEditInstruction=false;for(var i=0;i<architecture.instructions.length;i++){if(architecture.instructions[i].name==comp&&architecture.instructions[i].co==co&&architecture.instructions[i].cop==cop){architecture.instructions[i].name=this.formInstruction.name;architecture.instructions[i].type=this.formInstruction.type;architecture.instructions[i].co=this.formInstruction.co;architecture.instructions[i].cop=this.formInstruction.cop;architecture.instructions[i].nwords=this.formInstruction.nwords;architecture.instructions[i].help=this.formInstruction.help;architecture.instructions[i].signature_definition=this.formInstruction.signature_definition;architecture.instructions[i].definition=this.formInstruction.definition;architecture.instructions[i].properties=this.formInstruction.properties;if(!architecture.instructions[i].separated)architecture.instructions[i].separated=Array(this.formInstruction.numfields).fill(false);for(var j=0;j<this.formInstruction.numfields;j++){if(j<architecture.instructions[i].fields.length){architecture.instructions[i].fields[j].name=this.formInstruction.nameField[j];architecture.instructions[i].fields[j].type=this.formInstruction.typeField[j];architecture.instructions[i].fields[j].startbit=!this.formInstruction.separated[j]?parseInt(this.formInstruction.startBitField[j]):this.formInstruction.startBitField[j].map((val=>parseInt(val)));architecture.instructions[i].fields[j].stopbit=!this.formInstruction.separated[j]?parseInt(this.formInstruction.stopBitField[j]):this.formInstruction.stopBitField[j].map((val=>parseInt(val)));architecture.instructions[i].fields[j].valueField=this.formInstruction.valueField[j];architecture.instructions[i].separated[j]=this.formInstruction.separated[j]}else{var newField={name:this.formInstruction.nameField[j],type:this.formInstruction.typeField[j],startbit:this.formInstruction.startBitField[j],stopbit:this.formInstruction.stopBitField[j],valueField:this.formInstruction.valueField[j]};architecture.instructions[i].fields.push(newField)}}this.generateSignatureInst();var signature=this.formInstruction.signature;var signatureRaw=this.formInstruction.signatureRaw;if(exCop==false){architecture.instructions[i].cop=""}architecture.instructions[i].signature=signature;architecture.instructions[i].signatureRaw=signatureRaw;if(architecture.instructions[i].fields.length>this.formInstruction.numfields){architecture.instructions[i].fields.splice(this.formInstruction.numfields,architecture.instructions[i].fields.length-this.formInstruction.numfields)}break}}show_notification("The instruction has been modified, please check the definition of the pseudoinstructions","info")},delInstModal(elem,index,button){this.modalDeletInst.title="Delete Instruction";this.modalDeletInst.element=elem;this.modalDeletInst.index=index;this.$root.$emit("bv::show::modal","modalDeletInst",button)},delInstruction(index){architecture.instructions.splice(index,1)},generateSignatureInst(){var signature=this.formInstruction.signature_definition;var re=new RegExp("^ +");this.formInstruction.signature_definition=this.formInstruction.signature_definition.replace(re,"");re=new RegExp(" +","g");this.formInstruction.signature_definition=this.formInstruction.signature_definition.replace(re," ");re=new RegExp("^ +");signature=signature.replace(re,"");re=new RegExp(" +","g");signature=signature.replace(re," ");for(var z=0;z<this.formInstruction.numfields;z++){re=new RegExp("[Ff]"+z,"g");if(z==0){signature=signature.replace(re,this.formInstruction.name)}else{signature=signature.replace(re,this.formInstruction.typeField[z])}}re=new RegExp(" ","g");signature=signature.replace(re,",");var signatureRaw=this.formInstruction.signature_definition;re=new RegExp("^ +");signatureRaw=signatureRaw.replace(re,"");re=new RegExp(" +","g");signatureRaw=signatureRaw.replace(re," ");for(var z=0;z<this.formInstruction.numfields;z++){re=new RegExp("[Ff]"+z,"g");signatureRaw=signatureRaw.replace(re,this.formInstruction.nameField[z])}this.formInstruction.signature=signature;this.formInstruction.signatureRaw=signatureRaw},emptyFormInst(){this.formInstruction.name="";this.formInstruction.type="";this.formInstruction.co="";this.formInstruction.cop="";this.formInstruction.nwords=1;this.formInstruction.numfields="1";this.formInstruction.numfieldsAux="1";this.formInstruction.nameField=[];this.formInstruction.properties=[];this.formInstruction.typeField=[];this.formInstruction.startBitField=[];this.formInstruction.stopBitField=[];this.formInstruction.valueField=[];this.formInstruction.separated=[];this.formInstruction.assignedCop=false;this.formInstruction.signature="";this.formInstruction.signatureRaw="";this.formInstruction.signature_definition="";this.formInstruction.definition="";this.instructionFormPage=1;this.formInstruction.help=""},viewFielsPseudo(elem,index,button){this.modalViewFields.title="Fields of "+elem;this.modalViewFields.element=elem;this.formPseudoinstruction.name=architecture.pseudoinstructions[index].name;this.formPseudoinstruction.numfields=architecture.pseudoinstructions[index].fields.length;this.formPseudoinstruction.numfieldsAux=architecture.pseudoinstructions[index].fields.length;for(var j=0;j<architecture.pseudoinstructions[index].fields.length;j++){this.formPseudoinstruction.nameField[j]=architecture.pseudoinstructions[index].fields[j].name;this.formPseudoinstruction.typeField[j]=architecture.pseudoinstructions[index].fields[j].type;this.formPseudoinstruction.startBitField[j]=architecture.pseudoinstructions[index].fields[j].startbit;this.formPseudoinstruction.stopBitField[j]=architecture.pseudoinstructions[index].fields[j].stopbit}this.$root.$emit("bv::show::modal","modalViewPseudoFields",button)},resetPseudoinstModal(elem,button){this.modalResetPseudoinst.title="Reset "+elem+" pseudoinstructions";this.modalResetPseudoinst.element=elem;this.$root.$emit("bv::show::modal","modalResetPseudoinst",button)},resetPseudoinstructionsModal(arch){show_loading();for(var i=0;i<load_architectures.length;i++){if(arch==load_architectures[i].id){var auxArch=JSON.parse(load_architectures[i].architecture);var auxArchitecture=register_value_deserialize(auxArch);architecture.pseudoinstructions=auxArchitecture.pseudoinstructions;app._data.architecture=architecture;hide_loading();show_notification("The registers has been reset correctly","success");return}}$.getJSON("architecture/"+arch+".json",(function(cfg){var auxArchitecture=cfg;var auxArchitecture2=register_value_deserialize(auxArchitecture);architecture.pseudoinstructions=auxArchitecture2.pseudoinstructions;app._data.architecture=architecture;hide_loading();show_notification("The pseudoinstruction set has been reset correctly","success")}))},newPseudoinstVerify(evt){evt.preventDefault();for(var i=0;i<this.formPseudoinstruction.nameField.length;i++){for(var j=i+1;j<this.formPseudoinstruction.nameField.length;j++){if(this.formPseudoinstruction.nameField[i]==this.formPseudoinstruction.nameField[j]){show_notification("Field name repeated","danger");return}}}var vacio=0;for(var i=0;i<this.formPseudoinstruction.numfields;i++){if(this.formPseudoinstruction.nameField.length<this.formPseudoinstruction.numfields||this.formPseudoinstruction.typeField.length<this.formPseudoinstruction.numfields||this.formPseudoinstruction.startBitField.length<this.formPseudoinstruction.numfields||this.formPseudoinstruction.stopBitField.length<this.formPseudoinstruction.numfields){vacio=1}}var result=this.pseudoDefValidator(this.formPseudoinstruction.name,this.formPseudoinstruction.definition,this.formPseudoinstruction.nameField);if(result==-1){return}if(!this.formPseudoinstruction.name||!this.formPseudoinstruction.nwords||!this.formPseudoinstruction.numfields||!this.formPseudoinstruction.signature_definition||!this.formPseudoinstruction.definition||vacio==1){show_notification("Please complete all fields","danger")}else{this.newPseudoinstruction()}},newPseudoinstruction(){this.showNewPseudoinstruction=false;this.generateSignaturePseudo();var signature=this.formPseudoinstruction.signature;var signatureRaw=this.formPseudoinstruction.signatureRaw;var newPseudoinstruction={name:this.formPseudoinstruction.name,signature_definition:this.formPseudoinstruction.signature_definition,signature:signature,signatureRaw:signatureRaw,nwords:this.formPseudoinstruction.nwords,fields:[],definition:this.formPseudoinstruction.definition,help:this.formPseudoinstruction.help};architecture.pseudoinstructions.push(newPseudoinstruction);for(var i=0;i<this.formPseudoinstruction.numfields;i++){var newField={name:this.formPseudoinstruction.nameField[i],type:this.formPseudoinstruction.typeField[i],startbit:this.formPseudoinstruction.startBitField[i],stopbit:this.formPseudoinstruction.stopBitField[i]};architecture.pseudoinstructions[architecture.pseudoinstructions.length-1].fields.push(newField)}},editPseudoinstModal(elem,index,button){this.modalEditPseudoinst.title="Edit Pseudoinstruction";this.modalEditPseudoinst.element=elem;this.modalEditPseudoinst.index=index;this.formPseudoinstruction.name=architecture.pseudoinstructions[index].name;this.formPseudoinstruction.nwords=architecture.pseudoinstructions[index].nwords;this.formPseudoinstruction.numfields=architecture.pseudoinstructions[index].fields.length;this.formPseudoinstruction.numfieldsAux=architecture.pseudoinstructions[index].fields.length;this.formPseudoinstruction.signature_definition=architecture.pseudoinstructions[index].signature_definition;this.formPseudoinstruction.definition=architecture.pseudoinstructions[index].definition;this.formPseudoinstruction.help=architecture.pseudoinstructions[index].help;for(var j=0;j<architecture.pseudoinstructions[index].fields.length;j++){this.formPseudoinstruction.nameField[j]=architecture.pseudoinstructions[index].fields[j].name;this.formPseudoinstruction.typeField[j]=architecture.pseudoinstructions[index].fields[j].type;this.formPseudoinstruction.startBitField[j]=architecture.pseudoinstructions[index].fields[j].startbit;this.formPseudoinstruction.stopBitField[j]=architecture.pseudoinstructions[index].fields[j].stopbit}this.generateSignaturePseudo();this.$root.$emit("bv::show::modal","modalEditPseudoinst",button)},editPseudoinstVerify(evt,inst,index){evt.preventDefault();for(var i=0;i<this.formPseudoinstruction.nameField.length;i++){for(var j=i+1;j<this.formPseudoinstruction.nameField.length;j++){if(this.formPseudoinstruction.nameField[i]==this.formPseudoinstruction.nameField[j]){show_notification("Field name repeated","danger");return}}}var vacio=0;for(var i=0;i<this.formPseudoinstruction.numfields;i++){if(!this.formPseudoinstruction.nameField[i]||!this.formPseudoinstruction.typeField[i]||!this.formPseudoinstruction.startBitField[i]&&this.formPseudoinstruction.startBitField[i]!=0||!this.formPseudoinstruction.stopBitField[i]&&this.formPseudoinstruction.stopBitField[i]!=0){vacio=1}}var result=this.pseudoDefValidator(inst,this.formPseudoinstruction.definition,this.formPseudoinstruction.nameField);if(result==-1){return}if(!this.formPseudoinstruction.name||!this.formPseudoinstruction.nwords||!this.formPseudoinstruction.numfields||!this.formPseudoinstruction.signature_definition||!this.formPseudoinstruction.definition||vacio==1){show_notification("Please complete all fields","danger")}else{this.editPseudoinstruction(inst,index)}},editPseudoinstruction(comp,index){this.showEditPseudoinstruction=false;architecture.pseudoinstructions[index].name=this.formPseudoinstruction.name;architecture.pseudoinstructions[index].nwords=this.formPseudoinstruction.nwords;architecture.pseudoinstructions[index].definition=this.formPseudoinstruction.definition;architecture.pseudoinstructions[index].signature_definition=this.formPseudoinstruction.signature_definition;architecture.pseudoinstructions[index].help=this.formPseudoinstruction.help;for(var j=0;j<this.formPseudoinstruction.numfields;j++){if(j<architecture.pseudoinstructions[index].fields.length){architecture.pseudoinstructions[index].fields[j].name=this.formPseudoinstruction.nameField[j];architecture.pseudoinstructions[index].fields[j].type=this.formPseudoinstruction.typeField[j];architecture.pseudoinstructions[index].fields[j].startbit=this.formPseudoinstruction.startBitField[j];architecture.pseudoinstructions[index].fields[j].stopbit=this.formPseudoinstruction.stopBitField[j]}else{var newField={name:this.formPseudoinstruction.nameField[j],type:this.formPseudoinstruction.typeField[j],startbit:this.formPseudoinstruction.startBitField[j],stopbit:this.formPseudoinstruction.stopBitField[j]};architecture.pseudoinstructions[index].fields.push(newField)}}this.generateSignaturePseudo();var signature=this.formPseudoinstruction.signature;var signatureRaw=this.formPseudoinstruction.signatureRaw;architecture.pseudoinstructions[index].signature=signature;architecture.pseudoinstructions[index].signatureRaw=signatureRaw;if(architecture.pseudoinstructions[index].fields.length>this.formPseudoinstruction.numfields){architecture.pseudoinstructions[index].fields.splice(this.formPseudoinstruction.numfields,architecture.pseudoinstructions[i].fields.length-this.formPseudoinstruction.numfields)}},delPseudoinstModal(elem,index,button){this.modalDeletPseudoinst.title="Delete Pseudointruction";this.modalDeletPseudoinst.element=elem;this.modalDeletPseudoinst.index=index;this.$root.$emit("bv::show::modal","modalDeletPseudoinst",button)},delPseudoinstruction(index){architecture.pseudoinstructions.splice(index,1)},pseudoDefValidator(name,definition,fields){var re=new RegExp("^\n+");definition=definition.replace(re,"");re=new RegExp("\n+","g");definition=definition.replace(re,"");var newDefinition=definition;re=/{([^}]*)}/g;var code=re.exec(definition);if(code!=null){while(code!=null){console_log(code);var instructions=code[1].split(";");if(instructions.length==1){show_notification('Enter a ";" at the end of each line of code',"danger");return-1}for(var j=0;j<instructions.length-1;j++){var re=new RegExp("^ +");instructions[j]=instructions[j].replace(re,"");re=new RegExp(" +","g");instructions[j]=instructions[j].replace(re," ");var instructionParts=instructions[j].split(" ");var found=false;for(var i=0;i<architecture.instructions.length;i++){if(architecture.instructions[i].name==instructionParts[0]){found=true;var numFields=0;var regId=0;signatureDef=architecture.instructions[i].signature_definition;signatureDef=signatureDef.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");re=new RegExp("[fF][0-9]+","g");signatureDef=signatureDef.replace(re,"(.*?)");console_log(instructions[j]);re=new RegExp(signatureDef+"$");if(instructions[j].search(re)==-1){show_notification("Incorrect signature --\x3e "+architecture.instructions[i].signatureRaw,"danger");return-1}re=new RegExp(signatureDef+"$");var match=re.exec(instructions[j]);var instructionParts=[];for(var z=1;z<match.length;z++){instructionParts.push(match[z])}re=new RegExp(",","g");var signature=architecture.instructions[i].signature.replace(re," ");re=new RegExp(signatureDef+"$");var match=re.exec(signature);var signatureParts=[];for(var j=1;j<match.length;j++){signatureParts.push(match[j])}console_log(instructionParts);console_log(signatureParts);for(var z=1;z<signatureParts.length;z++){if(signatureParts[z]=="INT-Reg"||signatureParts[z]=="SFP-Reg"||signatureParts[z]=="DFP-Reg"||signatureParts[z]=="Ctrl-Reg"){console_log("REG");var found=false;var id=-1;re=new RegExp("R[0-9]+");console_log(z);if(instructionParts[z].search(re)!=-1){re=new RegExp("R(.*?)$");match=re.exec(instructionParts[z]);id=match[1]}for(var a=0;a<architecture.components.length;a++){for(var b=0;b<architecture.components[a].elements.length;b++){if(architecture.components[a].elements[b].name==instructionParts[z]){found=true}if(architecture.components[a].type=="integer"&&regId==id){found=true}if(architecture.components[a].type=="integer"){regId++}}}for(var b=0;b<fields.length;b++){if(fields[b]==instructionParts[z]){found=true}}if(!found){show_notification("Register "+instructionParts[z]+" not found","danger");return-1}}if(signatureParts[z]=="inm-signed"||signatureParts[z]=="inm-unsigned"||signatureParts[z]=="offset_bytes"||signatureParts[z]=="offset_words"){var fieldsLength=architecture.instructions[i].fields[z].startbit-architecture.instructions[i].fields[z].stopbit+1;if(instructionParts[z].match(/^0x/)){var value=instructionParts[z].split("x");if(isNaN(parseInt(instructionParts[z],16))==true){show_notification("Immediate number "+instructionParts[z]+" is not valid","danger");return-1}if(value[1].length*4>fieldsLength){show_notification("Immediate number "+instructionParts[z]+" is too big","danger");return-1}}else if(instructionParts[z].match(/^(\d)+\.(\d)+/)){if(isNaN(parseFloat(instructionParts[z]))==true){show_notification("Immediate number "+instructionParts[z]+" is not valid","danger");return-1}if(this.float2bin(parseFloat(instructionParts[z])).length>fieldsLength){show_notification("Immediate number "+instructionParts[z]+" is too big","danger");return-1}}else if(isNaN(parseInt(instructionParts[z]))){}else{var numAux=parseInt(instructionParts[z],10);if(isNaN(parseInt(instructionParts[z]))==true){show_notification("Immediate number "+instructionParts[z]+" is not valid","danger");return-1}var comNumPos=Math.pow(2,fieldsLength-1);var comNumNeg=comNumPos*-1;comNumPos=comNumPos-1;console_log(comNumPos);console_log(comNumNeg);if(parseInt(instructionParts[z],10)>comNumPos||parseInt(instructionParts[z],10)<comNumNeg){show_notification("Immediate number "+instructionParts[z]+" is too big","danger");return-1}}}if(signatureParts[z]=="address"){var fieldsLength=architecture.instructions[i].fields[z].startbit-architecture.instructions[i].fields[z].stopbit+1;if(instructionParts[z].match(/^0x/)){var value=instructionParts[z].split("x");if(isNaN(parseInt(instructionParts[z],16))==true){show_notification("Address "+instructionParts[z]+" is not valid","danger");return-1}if(value[1].length*4>fieldsLength){show_notification("Address "+instructionParts[z]+" is too big","danger");return-1}}}if(!found){show_notification("Register "+instructionParts[z]+" not found","danger");return-1}}}}if(!found){show_notification("Instruction "+instructions[j]+" do not exists","danger");return-1}}definition=definition.replace(code[0],"");re=/{([^}]*)}/g;code=re.exec(definition)}}else{var instructions=definition.split(";");console_log(instructions.length);if(instructions.length==1){show_notification('Enter a ";" at the end of each line of code',"danger");return-1}for(var j=0;j<instructions.length-1;j++){var re=new RegExp("^ +");instructions[j]=instructions[j].replace(re,"");re=new RegExp(" +","g");instructions[j]=instructions[j].replace(re," ");var instructionParts=instructions[j].split(" ");var found=false;for(var i=0;i<architecture.instructions.length;i++){if(architecture.instructions[i].name==instructionParts[0]){found=true;var numFields=0;var regId=0;signatureDef=architecture.instructions[i].signature_definition;signatureDef=signatureDef.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");re=new RegExp("[fF][0-9]+","g");signatureDef=signatureDef.replace(re,"(.*?)");console_log(instructions[j]);re=new RegExp(signatureDef+"$");if(instructions[j].search(re)==-1){show_notification("Incorrect signature --\x3e "+architecture.instructions[i].signatureRaw,"danger");return-1}re=new RegExp(signatureDef+"$");var match=re.exec(instructions[j]);var instructionParts=[];for(var z=1;z<match.length;z++){instructionParts.push(match[z])}re=new RegExp(",","g");var signature=architecture.instructions[i].signature.replace(re," ");re=new RegExp(signatureDef+"$");var match=re.exec(signature);var signatureParts=[];for(var j=1;j<match.length;j++){signatureParts.push(match[j])}console_log(instructionParts);console_log(signatureParts);for(var z=1;z<signatureParts.length;z++){if(signatureParts[z]=="INT-Reg"||signatureParts[z]=="SFP-Reg"||signatureParts[z]=="DFP-Reg"||signatureParts[z]=="Ctrl-Reg"){console_log("REG");var found=false;var id=-1;re=new RegExp("R[0-9]+");console_log(z);if(instructionParts[z].search(re)!=-1){re=new RegExp("R(.*?)$");match=re.exec(instructionParts[z]);id=match[1]}for(var a=0;a<architecture.components.length;a++){for(var b=0;b<architecture.components[a].elements.length;b++){if(architecture.components[a].elements[b].name==instructionParts[z]){found=true}if(architecture.components[a].type=="integer"&&regId==id){found=true}if(architecture.components[a].type=="integer"){regId++}}}for(var b=0;b<fields.length;b++){if(fields[b]==instructionParts[z]){found=true}}if(!found){show_notification("Register "+instructionParts[z]+" not found","danger");return-1}}if(signatureParts[z]=="inm-signed"||signatureParts[z]=="inm-unsigned"||signatureParts[z]=="offset_bytes"||signatureParts[z]=="offset_words"){var fieldsLength=architecture.instructions[i].fields[z].startbit-architecture.instructions[i].fields[z].stopbit+1;if(instructionParts[z].match(/^0x/)){var value=instructionParts[z].split("x");if(isNaN(parseInt(instructionParts[z],16))==true){show_notification("Immediate number "+instructionParts[z]+" is not valid","danger");return-1}if(value[1].length*4>fieldsLength){show_notification("Immediate number "+instructionParts[z]+" is too big","danger");return-1}}else if(instructionParts[z].match(/^(\d)+\.(\d)+/)){if(isNaN(parseFloat(instructionParts[z]))==true){show_notification("Immediate number "+instructionParts[z]+" is not valid","danger");return-1}if(this.float2bin(parseFloat(instructionParts[z])).length>fieldsLength){show_notification("Immediate number "+instructionParts[z]+" is too big","danger");return-1}}else if(isNaN(parseInt(instructionParts[z]))){}else{var numAux=parseInt(instructionParts[z],10);if(isNaN(parseInt(instructionParts[z]))==true){show_notification("Immediate number "+instructionParts[z]+" is not valid","danger");return-1}var comNumPos=Math.pow(2,fieldsLength-1);var comNumNeg=comNumPos*-1;comNumPos=comNumPos-1;console_log(comNumPos);console_log(comNumNeg);if(parseInt(instructionParts[z],10)>comNumPos||parseInt(instructionParts[z],10)<comNumNeg){show_notification("Immediate number "+instructionParts[z]+" is too big","danger");return-1}}}if(signatureParts[z]=="address"){var fieldsLength=architecture.instructions[i].fields[z].startbit-architecture.instructions[i].fields[z].stopbit+1;if(instructionParts[z].match(/^0x/)){var value=instructionParts[z].split("x");if(isNaN(parseInt(instructionParts[z],16))==true){show_notification("Address "+instructionParts[z]+" is not valid","danger");return-1}if(value[1].length*4>fieldsLength){show_notification("Address "+instructionParts[z]+" is too big","danger");return-1}}}if(!found){show_notification("Register "+instructionParts[z]+" not found","danger");return-1}}}}if(!found){show_notification("Instruction "+instructions[j]+" do not exists","danger");return-1}}}return 0},generateSignaturePseudo(){var signature=this.formPseudoinstruction.signature_definition;var re=new RegExp("^ +");this.formPseudoinstruction.signature_definition=this.formPseudoinstruction.signature_definition.replace(re,"");re=new RegExp(" +","g");this.formPseudoinstruction.signature_definition=this.formPseudoinstruction.signature_definition.replace(re," ");re=new RegExp("^ +");signature=signature.replace(re,"");re=new RegExp(" +","g");signature=signature.replace(re," ");for(var z=0;z<this.formPseudoinstruction.numfields;z++){re=new RegExp("[Ff]"+z,"g");signature=signature.replace(re,this.formPseudoinstruction.typeField[z])}re=new RegExp(" ","g");signature=signature.replace(re,",");var signatureRaw=this.formPseudoinstruction.signature_definition;re=new RegExp("^ +");signatureRaw=signatureRaw.replace(re,"");re=new RegExp(" +","g");signatureRaw=signatureRaw.replace(re," ");for(var z=0;z<this.formPseudoinstruction.numfields;z++){re=new RegExp("[Ff]"+z,"g");signatureRaw=signatureRaw.replace(re,this.formPseudoinstruction.nameField[z])}this.formPseudoinstruction.signature=signature;this.formPseudoinstruction.signatureRaw=signatureRaw},emptyFormPseudo(){this.formPseudoinstruction.name="";this.formPseudoinstruction.nwords=1;this.formPseudoinstruction.numfields="0";this.formPseudoinstruction.numfields="0";this.formPseudoinstruction.nameField=[];this.formPseudoinstruction.typeField=[];this.formPseudoinstruction.startBitField=[];this.formPseudoinstruction.stopBitField=[];this.formPseudoinstruction.signature="";this.formPseudoinstruction.signatureRaw="";this.formPseudoinstruction.signature_definition="";this.formPseudoinstruction.definition="";this.formPseudoinstruction.help="";this.instructionFormPage=1},linkGen(pageNum){return this.instructionFormPageLink[pageNum-1]},pageGen(pageNum){return this.instructionFormPageLink[pageNum-1].slice(1)},resetDirModal(elem,button){this.modalResetDir.title="Reset "+elem+" directives";this.modalResetDir.element=elem;this.$root.$emit("bv::show::modal","modalResetDir",button)},resetDirectives(arch){show_loading();for(var i=0;i<load_architectures.length;i++){if(arch==load_architectures[i].id){var auxArch=JSON.parse(load_architectures[i].architecture);var auxArchitecture=register_value_deserialize(auxArch);architecture.directives=auxArchitecture.directives;app._data.architecture=architecture;hide_loading();show_notification("The directive set has been reset correctly","success");return}}$.getJSON("architecture/"+arch+".json",(function(cfg){var auxArchitecture=cfg;var auxArchitecture2=register_value_deserialize(auxArchitecture);architecture.directives=auxArchitecture2.directives;app._data.architecture=architecture;hide_loading();show_notification("The directive set has been reset correctly","success")}))},newDirVerify(evt){evt.preventDefault();if(!this.formDirective.name||!this.formDirective.action){show_notification("Please complete all fields","danger")}else{if(isNaN(parseInt(this.formDirective.size))&&(this.formDirective.action=="byte"||this.formDirective.action=="half_word"||this.formDirective.action=="word"||this.formDirective.action=="double_word"||this.formDirective.action=="float"||this.formDirective.action=="double"||this.formDirective.action=="space")){show_notification("Please complete all fields","danger")}else{this.newDirective()}}},newDirective(){for(var i=0;i<architecture.directives.length;i++){if(this.formDirective.name==architecture.directives[i].name){show_notification("The directive already exists","danger");return}}this.showNewDirective=false;if(this.formDirective.action!="byte"&&this.formDirective.action!="half_word"&&this.formDirective.action!="word"&&this.formDirective.action!="double_word"&&this.formDirective.action!="float"&&this.formDirective.action!="double"&&this.formDirective.action!="space"){this.formDirective.size=null}var newDir={name:this.formDirective.name,action:this.formDirective.action,size:this.formDirective.size};architecture.directives.push(newDir)},editDirModal(elem,button){this.modalEditDirective.title="Edit "+elem;this.modalEditDirective.element=elem;for(var i=0;i<architecture.directives.length;i++){if(elem==architecture.directives[i].name){this.formDirective.name=architecture.directives[i].name;this.formDirective.action=architecture.directives[i].action;this.formDirective.size=architecture.directives[i].size}}this.$root.$emit("bv::show::modal","modalEditDirective",button)},editDirVerify(evt,name){evt.preventDefault();if(!this.formDirective.name||!this.formDirective.action){show_notification("Please complete all fields","danger")}else{if(isNaN(parseInt(this.formDirective.size))&&(this.formDirective.action=="byte"||this.formDirective.action=="half_word"||this.formDirective.action=="word"||this.formDirective.action=="double_word"||this.formDirective.action=="float"||this.formDirective.action=="double"||this.formDirective.action=="space")){show_notification("Please complete all fields","danger")}else{this.editDirective(name)}}},editDirective(name){for(var i=0;i<architecture.directives.length;i++){if(this.formDirective.name==architecture.directives[i].name&&name!=this.formDirective.name){show_notification("The directive already exists","danger");return}}this.showEditDirective=false;for(var i=0;i<architecture.directives.length;i++){if(name==architecture.directives[i].name){architecture.directives[i].name=this.formDirective.name;architecture.directives[i].action=this.formDirective.action;if(this.formDirective.action=="byte"||this.formDirective.action=="half_word"||this.formDirective.action=="word"||this.formDirective.action=="double_word"||this.formDirective.action=="float"||this.formDirective.action=="double"||this.formDirective.action=="space"){architecture.directives[i].size=this.formDirective.size}else{architecture.directives[i].size=null}return}}},delDirModal(elem,button){this.modalDeletDir.title="Delete "+elem;this.modalDeletDir.element=elem;this.$root.$emit("bv::show::modal","modalDeletDir",button)},delDirective(comp){for(var i=0;i<architecture.directives.length;i++){if(comp==architecture.directives[i].name){architecture.directives.splice(i,1)}}},emptyFormDirective(){this.formDirective.name="";this.formDirective.action="";this.formDirective.size=0},valid(value){if(parseInt(value)!=0){if(!value){return false}else{return true}}else{return true}},assembly_compiler(code){show_loading();promise=new Promise(((resolve,reject)=>{setTimeout((function(){if(typeof code!=="undefined"){code_assembly=code}else{code_assembly=textarea_assembly_editor.getValue()}var ret=assembly_compiler();app._data.totalStats=0;app._data.instructions=instructions;app._data.memory[memory_hash[1]]=memory[memory_hash[1]];app._data.memory[memory_hash[0]]=memory[memory_hash[0]];app._data.memory[memory_hash[2]]=memory[memory_hash[2]];tokenIndex=0;app.reset(true);if(typeof Storage!=="undefined"){var auxObject=jQuery.extend(true,{},architecture);var auxArchitecture=register_value_serialize(auxObject);var auxArch=JSON.stringify(auxArchitecture,null,2);var date=new Date;var auxDate=date.getHours()+":"+date.getMinutes()+":"+date.getSeconds()+" - "+date.getDate()+"/"+(date.getMonth()+1)+"/"+date.getFullYear();console_log(app._data.architecture_name);localStorage.setItem("arch_name",app._data.architecture_name);localStorage.setItem("architecture_copy",auxArch);localStorage.setItem("assembly_copy",code_assembly);localStorage.setItem("date_copy",auxDate)}hide_loading();switch(ret.type){case"error":app.compileError(ret.msg,ret.token,ret.line);break;case"warning":show_notification(ret.token,ret.bgcolor);break;default:show_notification("Compilation completed successfully","success");break}resolve("0")}),25)}))},newAssembly(){textarea_assembly_editor.setValue("")},read_assembly(e){show_loading();var file;var reader;var files=document.getElementById("assembly_file").files;for(var i=0;i<files.length;i++){file=files[i];reader=new FileReader;reader.onloadend=onFileLoaded;reader.readAsBinaryString(file)}function onFileLoaded(event){code_assembly=event.currentTarget.result}hide_loading();creator_ga("assembly","assebly.load","assebly.load")},assembly_update(){if(code_assembly!=""){textarea_assembly_editor.setValue(code_assembly);show_notification(" The selected program has been loaded correctly","success")}else{show_notification("Please select one program","danger")}},assembly_save(){var textToWrite=textarea_assembly_editor.getValue();var textFileAsBlob=new Blob([textToWrite],{type:"text/plain"});var fileNameToSaveAs;if(this.save_assembly==""){fileNameToSaveAs="assembly.s"}else{fileNameToSaveAs=this.save_assembly+".s"}var downloadLink=document.createElement("a");downloadLink.download=fileNameToSaveAs;downloadLink.innerHTML="My Hidden Link";window.URL=window.URL||window.webkitURL;downloadLink.href=window.URL.createObjectURL(textFileAsBlob);downloadLink.onclick=destroyClickedElement;downloadLink.style.display="none";document.body.appendChild(downloadLink);downloadLink.click();creator_ga("assembly","assebly.save","assebly.save")},load_examples_available(set_name){this._data.example_loaded=new Promise((function(resolve,reject){$.getJSON("examples/example_set.json"+"?v="+(new Date).getTime(),(function(set){var current_architecture=app._data.architecture_name.toUpperCase();for(var i=0;i<set.length;i++){if(set[i].id.toUpperCase()==set_name.toUpperCase()){if(current_architecture!=""&&set[i].architecture.toUpperCase()!=current_architecture){continue}if(current_architecture==""){$.getJSON("architecture/"+set[i].architecture+".json",(function(cfg){app.load_arch_select_aux(set[i].architecture,cfg,false,null)}))}$.getJSON(set[i].url,(function(cfg){example_available=cfg;app._data.example_available=example_available;resolve("Example list loaded.")}));return}}reject("Unavailable example list.")}))}))},library_save(){if(assembly_compiler()==-1){return}promise.then((message=>{if(message=="-1"){return}if(memory[memory_hash[0]].length!=0){show_notification("You can not enter data in a library","danger");return}for(var i=0;i<instructions_binary.length;i++){console_log(instructions_binary[i].Label);if(instructions_binary[i].Label=="main_symbol"){show_notification('You can not use the "main" tag in a library',"danger");return}}var aux={instructions_binary:instructions_binary,instructions_tag:instructions_tag};var textToWrite=JSON.stringify(aux,null,2);var textFileAsBlob=new Blob([textToWrite],{type:"text/json"});var fileNameToSaveAs;if(this.name_binary_save==""){fileNameToSaveAs="binary.o"}else{fileNameToSaveAs=this.name_binary_save+".o"}var downloadLink=document.createElement("a");downloadLink.download=fileNameToSaveAs;downloadLink.innerHTML="My Hidden Link";window.URL=window.URL||window.webkitURL;downloadLink.href=window.URL.createObjectURL(textFileAsBlob);downloadLink.onclick=destroyClickedElement;downloadLink.style.display="none";document.body.appendChild(downloadLink);downloadLink.click();show_notification("Save binary","success")}))},library_load(e){var file;var reader;var files=document.getElementById("binary_file").files;for(var i=0;i<files.length;i++){file=files[i];reader=new FileReader;reader.onloadend=onFileLoaded;reader.readAsBinaryString(file)}function onFileLoaded(event){code_binary=event.currentTarget.result}},library_update(){if(code_binary.length!=0){update_binary=JSON.parse(code_binary);this.update_binary=update_binary;$("#divAssembly").attr("class","col-lg-10 col-sm-12");$("#divTags").attr("class","col-lg-2 col-sm-12");$("#divTags").show();this.load_binary=true;show_notification("The selected library has been loaded correctly","success")}else{show_notification("Please select one library","danger")}},removeLibrary(){update_binary="";this.update_binary=update_binary;$("#divAssembly").attr("class","col-lg-12 col-sm-12");$("#divTags").attr("class","col-lg-0 col-sm-0");$("#divTags").hide();this.load_binary=false},compileError(msg,token,line){var code_assembly_segment=code_assembly.split("\n");this.change_UI_mode("assembly");setTimeout((function(){app.$root.$emit("bv::show::modal","modalAssemblyError");app.modalAssemblyError.line1="";app.modalAssemblyError.code1="";if(line>0){app.modalAssemblyError.line1=line;app.modalAssemblyError.code1=code_assembly_segment[line-1]}app.modalAssemblyError.line2=line+1;app.modalAssemblyError.code2=code_assembly_segment[line];app.modalAssemblyError.line3="";app.modalAssemblyError.code3="";if(line<code_assembly_segment.length-1){app.modalAssemblyError.line3=line+2;app.modalAssemblyError.code3=code_assembly_segment[line+1]}app.modalAssemblyError.error=msg}),75)},detectBrowser(){if(navigator.appVersion.indexOf("Mac")!=-1){this.browser="Mac";return}if(navigator.userAgent.search("Chrome")>=0){this.browser="Chrome"}else if(navigator.userAgent.search("Firefox")>=0){this.browser="Firefox"}else if(navigator.userAgent.search("Safari")>=0&&navigator.userAgent.search("Chrome")<0){this.browser="Chrome"}},executeInstruction(){creator_ga("execute","execute.instruction","execute.instruction");var ret=executeInstruction();if(typeof ret==="undefined"){console.log("AQUI hemos llegado y un poema se ha encontrado...")}if(ret.msg!=null){show_notification(ret.msg,ret.type)}if(ret.draw!=null){for(var i=0;i<ret.draw.space.length;i++){instructions[ret.draw.space[i]]._rowVariant=""}for(var i=0;i<ret.draw.success.length;i++){instructions[ret.draw.success[i]]._rowVariant="success"}for(var i=0;i<ret.draw.info.length;i++){instructions[ret.draw.info[i]]._rowVariant="info"}for(var i=0;i<ret.draw.danger.length;i++){instructions[ret.draw.danger[i]]._rowVariant="danger"}if(app._data.autoscroll==true&&runProgram==false){if(executionIndex>=0&&executionIndex+4<instructions.length){var id="#inst_table__row_"+instructions[executionIndex+4].Address;var rowpos=$(id).position();if(rowpos){var pos=rowpos.top-$(".instructions_table").height();$(".instructions_table").animate({scrollTop:pos},200)}}else if(executionIndex>0&&executionIndex+4>=instructions.length){$(".instructions_table").animate({scrollTop:$(".instructions_table").height()},300)}}if(app._data.data_mode=="stats"){ApexCharts.exec("graphic","updateSeries",stats_value)}return}},executeProgram(but){creator_ga("execute","execute.run","execute.run");app._data.runExecution=true;app._data.runExecution=false;runProgram=true;if(instructions.length==0){show_notification("No instructions in memory","danger");runProgram=false;return}if(executionIndex<-1){show_notification("The program has finished","danger");runProgram=false;return}if(executionIndex==-1){show_notification("The program has finished with errors","danger");runProgram=false;return}$("#stopExecution").show();$("#playExecution").hide();this.programExecutionInst(but)},programExecutionInst(but){for(var i=0;i<app._data.instructionsPacked&&executionIndex>=0;i++){if(mutexRead==true){iter1=1;$("#stopExecution").hide();$("#playExecution").show();runProgram=false;return}else if(instructions[executionIndex].Break==true&&iter1==0){iter1=1;$("#stopExecution").hide();$("#playExecution").show();runProgram=false;return}else if(this.runExecution==true){app._data.runExecution=false;iter1=1;$("#stopExecution").hide();$("#playExecution").show();runProgram=false;return}else if(but==true&&i==0){app._data.resetBut=false}else if(this.resetBut==true){app._data.resetBut=false;$("#stopExecution").hide();$("#playExecution").show();runProgram=false;return}else{this.executeInstruction();iter1=0}}if(executionIndex>=0){setTimeout(this.programExecutionInst,15)}else{$("#stopExecution").hide();$("#playExecution").show()}},stopExecution(){app._data.runExecution=true},exception(error){show_notification("There has been an exception. Error description: '"+error,"danger");instructions[executionIndex]._rowVariant="danger";executionIndex=-1;creator_ga("execute","execute.exception","execute.exception."+error);return},reset(reset_graphic){creator_ga("execute","execute.reset","execute.reset");show_loading();setTimeout((function(){app._data.resetBut=true;app._data.keyboard="";app._data.display="";app._data.enter=null;for(var i=0;i<instructions.length;i++){instructions[i]._rowVariant=""}reset(reset_graphic);for(var i=0;i<instructions.length;i++){if(instructions[i].Label=="main"){instructions[i]._rowVariant="success"}}if(executionIndex>=0&&executionIndex+4<instructions.length){var id="#inst_table__row_"+instructions[executionIndex+4].Address;var rowpos=$(id).position();if(rowpos){var pos=rowpos.top-$(".instructions_table").height();$(".instructions_table").animate({scrollTop:pos},200)}}else if(executionIndex>0&&executionIndex+4>=instructions.length){$(".instructions_table").animate({scrollTop:$(".instructions_table").height()},300)}if(reset_graphic==true&&app._data.data_mode=="stats"){ApexCharts.exec("graphic","updateSeries",stats_value)}hide_loading()}),25)},consoleEnter(){if(this.keyboard!=""){consoleMutex=true}},consoleClear(){this.keyboard="";this.display=""},hex2float(hexvalue){var value=hexvalue.split("x");var value_bit="";for(var i=0;i<value[1].length;i++){var aux=value[1].charAt(i);aux=parseInt(aux,16).toString(2).padStart(4,"0");value_bit=value_bit+aux}var buffer=new ArrayBuffer(4);new Uint8Array(buffer).set(value_bit.match(/.{8}/g).map(binaryStringToInt));return new DataView(buffer).getFloat32(0,false)},hex2double(hexvalue){return hex2double(hexvalue)},hex2char8(hexvalue){return hex2char8(hexvalue)},float2bin(number){return float2bin(number)},double2bin(number){return double2bin(number)},bin2hex(s){return bin2hex(s)},popoverId(name){return"popoverValueContent"+name[0]},change_data_view(e,type){app._data.data_mode=e;if(e=="registers"){if(type=="int"){app._data.register_type="integer";app._data.name_tab_Reg="Decimal";app._data.name_reg="INT Registers";app._data.reg_type="int"}else if(type=="fp"){app._data.register_type="floating point";app._data.name_tab_Reg="Real";app._data.name_reg="FP Registers";app._data.reg_type="fp"}}if(e=="memory"){app._data.data_mode=e}app.$forceUpdate();creator_ga("data","data.view","data.view."+app._data.data_mode)},change_space_view(){if(app._data.selected_space_view=="sig_int"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[0]][app._data.row_index].Binary[j].Bin+hex}memory[memory_hash[0]][app._data.row_index].Value=parseInt(hex,16)>>0}else if(app._data.selected_space_view=="unsig_int"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[0]][app._data.row_index].Binary[j].Bin+hex}memory[memory_hash[0]][app._data.row_index].Value=parseInt(hex,16)>>>0}else if(app._data.selected_space_view=="float"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[0]][app._data.row_index].Binary[j].Bin+hex}memory[memory_hash[0]][app._data.row_index].Value=this.hex2float("0x"+hex)}else if(app._data.selected_space_view=="char"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[0]][app._data.row_index].Binary[j].Bin+hex}memory[memory_hash[0]][app._data.row_index].Value=this.hex2char8(hex)}var i=1;while(app._data.row_index+i<memory[memory_hash[0]].length&&memory[memory_hash[0]][app._data.row_index+i].type=="space"&&memory[memory_hash[0]][app._data.row_index+i].Binary[0].Tag==null&&memory[memory_hash[0]][app._data.row_index+i].Binary[1].Tag==null&&memory[memory_hash[0]][app._data.row_index+i].Binary[2].Tag==null&&memory[memory_hash[0]][app._data.row_index+i].Binary[3].Tag==null){if(app._data.selected_space_view=="sig_int"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[0]][app._data.row_index+i].Binary[j].Bin+hex}memory[memory_hash[0]][app._data.row_index+i].Value=parseInt(hex,16)>>0}else if(app._data.selected_space_view=="unsig_int"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[0]][app._data.row_index+i].Binary[j].Bin+hex}memory[memory_hash[0]][app._data.row_index+i].Value=parseInt(hex,16)>>>0}else if(app._data.selected_space_view=="float"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[0]][app._data.row_index+i].Binary[j].Bin+hex}memory[memory_hash[0]][app._data.row_index+i].Value=this.hex2float("0x"+hex)}else if(app._data.selected_space_view=="char"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[0]][app._data.row_index+i].Binary[j].Bin+hex}memory[memory_hash[0]][app._data.row_index+i].Value=this.hex2char8(hex)}i++}app._data.memory=memory},hide_space_modal(){app._data.selected_space_view=null},change_stack_view(){if(app._data.selected_stack_view=="sig_int"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[2]][app._data.row_index].Binary[j].Bin+hex}memory[memory_hash[2]][app._data.row_index].Value=parseInt(hex,16)>>0}else if(app._data.selected_stack_view=="unsig_int"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[2]][app._data.row_index].Binary[j].Bin+hex}memory[memory_hash[2]][app._data.row_index].Value=parseInt(hex,16)>>>0}else if(app._data.selected_stack_view=="float"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[2]][app._data.row_index].Binary[j].Bin+hex}memory[memory_hash[2]][app._data.row_index].Value=this.hex2float("0x"+hex)}else if(app._data.selected_stack_view=="char"){var hex="";for(var j=0;j<4;j++){hex=memory[memory_hash[2]][app._data.row_index].Binary[j].Bin+hex}memory[memory_hash[2]][app._data.row_index].Value=this.hex2char8(hex)}app._data.memory=memory},hide_stack_modal(){app._data.selected_stack_view=null},debounce:_.debounce((function(param,e){console_log(param);console_log(e);e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var re=new RegExp("'","g");e=e.replace(re,'"');re=new RegExp("[\f]","g");e=e.replace(re,"\\f");re=new RegExp("[\n]","g");e=e.replace(re,"\\n");re=new RegExp("[\r]","g");e=e.replace(re,"\\r");re=new RegExp("[\t]","g");e=e.replace(re,"\\t");re=new RegExp("[\v]","g");e=e.replace(re,"\\v");if(e==""){this[param]=null;return}console_log("this."+param+"= '"+e+"'");eval("this."+param+"= '"+e+"'");app.$forceUpdate()}),getDebounceTime())}});Vue.config.errorHandler=function(err,vm,info){show_notification("An error has ocurred, the simulator is going to restart.  \n Error: "+err,"danger");setTimeout((function(){location.reload(true)}),3e3)};window.onbeforeunload=confirmExit;function confirmExit(){return"He's tried to get off this page. Changes may not be saved."}function getDebounceTime(){if(screen.width>768){return 500}else{return 1e3}}function destroyClickedElement(event){document.body.removeChild(event.target)}function console_log(m){if(app._data.c_debug){console.log(m)}}function codemirrorStart(){var editor_cfg={lineNumbers:true,autoRefresh:true};var textarea_assembly_obj=document.getElementById("textarea_assembly");if(textarea_assembly_obj!=null){textarea_assembly_editor=CodeMirror.fromTextArea(textarea_assembly_obj,editor_cfg);textarea_assembly_editor.setOption("keyMap","sublime");textarea_assembly_editor.setValue(app._data.assembly_code);textarea_assembly_editor.setSize("auto","70vh");var map={"Ctrl-M":function(cm){cm.execCommand("toggleComment")}};textarea_assembly_editor.addKeyMap(map)}}function binaryStringToInt(b){return parseInt(b,2)}}catch(e){show_notification("An error has ocurred, the simulator is going to restart.  \n Error: "+e,"danger");creator_ga("creator","creator.exception","creator.exception."+e);setTimeout((function(){location.reload(true)}),3e3)}